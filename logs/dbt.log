[0m14:50:32.814962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C95AC190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C848C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C95A1C10>]}


============================== 14:50:32.821945 | a2860269-bf17-44a0-97ac-d8b243cd64fb ==============================
[0m14:50:32.821945 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:50:32.822942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'log_path': 'c:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:50:33.012946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2860269-bf17-44a0-97ac-d8b243cd64fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C961CC10>]}
[0m14:50:33.014948 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:50:33.018948 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:50:33.021948 [debug] [MainThread]: Command `cli deps` succeeded at 14:50:33.021948 after 0.29 seconds
[0m14:50:33.023947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C95A82D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C960FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C2DB5610>]}
[0m14:50:33.024946 [debug] [MainThread]: Flushing usage events
[0m14:50:50.438630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE705F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE70979D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE705F050>]}


============================== 14:50:50.443631 | e4a0e70a-2087-49d5-9c78-479ff905f402 ==============================
[0m14:50:50.443631 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:50:50.445631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:50.447630 [info ] [MainThread]: dbt version: 1.7.11
[0m14:50:50.448630 [info ] [MainThread]: python version: 3.11.4
[0m14:50:50.450632 [info ] [MainThread]: python path: c:\Users\Use\OneDrive\Development\dbt-course\venv\Scripts\python.exe
[0m14:50:50.451635 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:50:50.643635 [info ] [MainThread]: Using profiles dir at C:\Users\Use\.dbt
[0m14:50:50.644633 [info ] [MainThread]: Using profiles.yml file at C:\Users\Use\.dbt\profiles.yml
[0m14:50:50.646635 [info ] [MainThread]: Using dbt_project.yml file at c:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\dbt_project.yml
[0m14:50:50.649637 [info ] [MainThread]: adapter type: duckdb
[0m14:50:50.650635 [info ] [MainThread]: adapter version: 1.7.3
[0m14:50:50.759638 [info ] [MainThread]: Configuration:
[0m14:50:50.760641 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:50:50.762639 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:50:50.763638 [info ] [MainThread]: Required dependencies:
[0m14:50:50.764637 [debug] [MainThread]: Executing "git --help"
[0m14:50:50.835642 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:50:50.836643 [debug] [MainThread]: STDERR: "b''"
[0m14:50:50.837640 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:50:50.839640 [info ] [MainThread]: Connection:
[0m14:50:50.840647 [info ] [MainThread]:   database: dev
[0m14:50:50.841640 [info ] [MainThread]:   schema: main
[0m14:50:50.843642 [info ] [MainThread]:   path: dev.duckdb
[0m14:50:50.844642 [info ] [MainThread]:   config_options: None
[0m14:50:50.846641 [info ] [MainThread]:   extensions: None
[0m14:50:50.847641 [info ] [MainThread]:   settings: None
[0m14:50:50.849640 [info ] [MainThread]:   external_root: .
[0m14:50:50.850640 [info ] [MainThread]:   use_credential_provider: None
[0m14:50:50.852640 [info ] [MainThread]:   attach: None
[0m14:50:50.853641 [info ] [MainThread]:   filesystems: None
[0m14:50:50.855641 [info ] [MainThread]:   remote: None
[0m14:50:50.857644 [info ] [MainThread]:   plugins: None
[0m14:50:50.858641 [info ] [MainThread]:   disable_transactions: False
[0m14:50:50.861642 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:50:50.863641 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:50:50.864641 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:50:50.865640 [debug] [MainThread]: On debug: select 1 as id
[0m14:50:50.866643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:50.880641 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:50.881642 [debug] [MainThread]: On debug: Close
[0m14:50:50.885643 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:50:50.886642 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:50:50.888640 [debug] [MainThread]: Command `cli debug` succeeded at 14:50:50.888640 after 0.53 seconds
[0m14:50:50.889642 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:50:50.890642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE6CC1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE707BD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE6B68690>]}
[0m14:50:50.892642 [debug] [MainThread]: Flushing usage events
[0m14:52:08.096188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236CC784210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236CC770710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236CC771ED0>]}


============================== 14:52:08.101173 | 2f76073a-cd90-48a6-806d-566f3bfb640e ==============================
[0m14:52:08.101173 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:52:08.103176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:08.104173 [info ] [MainThread]: dbt version: 1.7.11
[0m14:52:08.106173 [info ] [MainThread]: python version: 3.11.4
[0m14:52:08.107172 [info ] [MainThread]: python path: C:\Users\Use\OneDrive\Development\dbt-course\venv\Scripts\python.exe
[0m14:52:08.109175 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:52:08.261175 [info ] [MainThread]: Using profiles dir at C:\Users\Use\.dbt
[0m14:52:08.262176 [info ] [MainThread]: Using profiles.yml file at C:\Users\Use\.dbt\profiles.yml
[0m14:52:08.264177 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\dbt_project.yml
[0m14:52:08.267177 [info ] [MainThread]: adapter type: duckdb
[0m14:52:08.268181 [info ] [MainThread]: adapter version: 1.7.3
[0m14:52:08.364180 [info ] [MainThread]: Configuration:
[0m14:52:08.365179 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:52:08.366198 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:52:08.368178 [info ] [MainThread]: Required dependencies:
[0m14:52:08.369178 [debug] [MainThread]: Executing "git --help"
[0m14:52:08.440179 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:52:08.441179 [debug] [MainThread]: STDERR: "b''"
[0m14:52:08.442178 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:52:08.443178 [info ] [MainThread]: Connection:
[0m14:52:08.445180 [info ] [MainThread]:   database: dev
[0m14:52:08.446179 [info ] [MainThread]:   schema: main
[0m14:52:08.447180 [info ] [MainThread]:   path: dev.duckdb
[0m14:52:08.448180 [info ] [MainThread]:   config_options: None
[0m14:52:08.449192 [info ] [MainThread]:   extensions: None
[0m14:52:08.451195 [info ] [MainThread]:   settings: None
[0m14:52:08.452180 [info ] [MainThread]:   external_root: .
[0m14:52:08.453189 [info ] [MainThread]:   use_credential_provider: None
[0m14:52:08.454179 [info ] [MainThread]:   attach: None
[0m14:52:08.455182 [info ] [MainThread]:   filesystems: None
[0m14:52:08.457188 [info ] [MainThread]:   remote: None
[0m14:52:08.458179 [info ] [MainThread]:   plugins: None
[0m14:52:08.459179 [info ] [MainThread]:   disable_transactions: False
[0m14:52:08.460179 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:52:08.461180 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:52:08.463177 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:52:08.465181 [debug] [MainThread]: On debug: select 1 as id
[0m14:52:08.466179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:08.476179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:52:08.477180 [debug] [MainThread]: On debug: Close
[0m14:52:08.480182 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:52:08.481181 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:52:08.484182 [debug] [MainThread]: Command `dbt debug` succeeded at 14:52:08.484182 after 0.46 seconds
[0m14:52:08.485182 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:52:08.486180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236C5C58250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236CC1F8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236CC98F950>]}
[0m14:52:08.487182 [debug] [MainThread]: Flushing usage events
[0m14:53:27.439764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5440390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E50A5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5443210>]}


============================== 14:53:27.444765 | 08b7e635-02b9-4ea9-8d79-ded9795c70f0 ==============================
[0m14:53:27.444765 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:53:27.446771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:53:27.766381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E54C6110>]}
[0m14:53:27.888369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E555A910>]}
[0m14:53:27.891389 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:53:27.902389 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:53:28.078373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:28.080374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:28.094374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E57DA890>]}
[0m14:53:28.118373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5755C10>]}
[0m14:53:28.120374 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:53:28.123373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E566EAD0>]}
[0m14:53:28.128374 [info ] [MainThread]: 
[0m14:53:28.132375 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:53:28.135374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:53:28.157375 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:53:28.158375 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:53:28.159375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:28.176375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:28.178374 [debug] [ThreadPool]: On list_dev: Close
[0m14:53:28.186374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:53:28.188373 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:53:28.203374 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:53:28.203374 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m14:53:28.205376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:28.216376 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:28.219374 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:53:28.219374 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:53:28.221374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:28.222375 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:53:28.222375 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:53:28.224374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:28.226376 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:53:28.227380 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:53:28.227380 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:53:28.229375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:28.229375 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:53:28.236375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:53:28.243375 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:53:28.244373 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:53:28.245378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:28.255375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:28.256375 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:53:28.257378 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:53:28.296377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:28.298378 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:53:28.300377 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:53:28.300377 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:53:28.304376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E56CEED0>]}
[0m14:53:28.305377 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:28.306387 [debug] [MainThread]: On master: BEGIN
[0m14:53:28.307380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:28.315377 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:28.315377 [debug] [MainThread]: On master: COMMIT
[0m14:53:28.316376 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:28.317376 [debug] [MainThread]: On master: COMMIT
[0m14:53:28.318377 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:28.320377 [debug] [MainThread]: On master: Close
[0m14:53:28.323376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:28.325381 [info ] [MainThread]: 
[0m14:53:28.329378 [debug] [Thread-1 (]: Began running node model.learn_duckdb.average_diamond_price_per_group
[0m14:53:28.330377 [info ] [Thread-1 (]: 1 of 3 START sql view model main.average_diamond_price_per_group ............... [RUN]
[0m14:53:28.333379 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.average_diamond_price_per_group'
[0m14:53:28.334378 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.average_diamond_price_per_group
[0m14:53:28.343378 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.average_diamond_price_per_group"
[0m14:53:28.347378 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.average_diamond_price_per_group (compile): 14:53:28.335378 => 14:53:28.346377
[0m14:53:28.349379 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.average_diamond_price_per_group
[0m14:53:28.389381 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.average_diamond_price_per_group"
[0m14:53:28.393378 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m14:53:28.394379 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: BEGIN
[0m14:53:28.395379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:53:28.404380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.405380 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m14:53:28.406378 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.average_diamond_price_per_group"} */

  
  create view "dev"."main"."average_diamond_price_per_group__dbt_tmp" as (
    SELECT 1 AS Id
  );

[0m14:53:28.407379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.417379 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m14:53:28.418380 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.average_diamond_price_per_group"} */
alter view "dev"."main"."average_diamond_price_per_group__dbt_tmp" rename to "average_diamond_price_per_group"
[0m14:53:28.419381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.437378 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: COMMIT
[0m14:53:28.438379 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m14:53:28.439378 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: COMMIT
[0m14:53:28.443380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.450379 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m14:53:28.451379 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.average_diamond_price_per_group"} */
drop view if exists "dev"."main"."average_diamond_price_per_group__dbt_backup" cascade
[0m14:53:28.453380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.456379 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.average_diamond_price_per_group (execute): 14:53:28.350378 => 14:53:28.455379
[0m14:53:28.456379 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: Close
[0m14:53:28.466379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5905110>]}
[0m14:53:28.468379 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.average_diamond_price_per_group .......... [[32mOK[0m in 0.14s]
[0m14:53:28.470380 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.average_diamond_price_per_group
[0m14:53:28.471378 [debug] [Thread-1 (]: Began running node model.learn_duckdb.my_first_dbt_model
[0m14:53:28.472379 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:53:28.475380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.average_diamond_price_per_group, now model.learn_duckdb.my_first_dbt_model)
[0m14:53:28.476379 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.my_first_dbt_model
[0m14:53:28.482380 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.my_first_dbt_model"
[0m14:53:28.486381 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.my_first_dbt_model (compile): 14:53:28.477380 => 14:53:28.485381
[0m14:53:28.488381 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.my_first_dbt_model
[0m14:53:28.525381 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.my_first_dbt_model"
[0m14:53:28.528380 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m14:53:28.529381 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: BEGIN
[0m14:53:28.530381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:28.547381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.548383 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m14:53:28.549382 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:53:28.551381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.556381 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m14:53:28.557380 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:53:28.559381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.565381 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: COMMIT
[0m14:53:28.567384 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m14:53:28.568384 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: COMMIT
[0m14:53:28.572382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.577380 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m14:53:28.578381 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:53:28.580382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.583383 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.my_first_dbt_model (execute): 14:53:28.489383 => 14:53:28.583383
[0m14:53:28.585383 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: Close
[0m14:53:28.597382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E58F9510>]}
[0m14:53:28.598382 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.12s]
[0m14:53:28.601383 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.my_first_dbt_model
[0m14:53:28.603384 [debug] [Thread-1 (]: Began running node model.learn_duckdb.my_second_dbt_model
[0m14:53:28.604383 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:53:28.607383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.my_first_dbt_model, now model.learn_duckdb.my_second_dbt_model)
[0m14:53:28.608383 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.my_second_dbt_model
[0m14:53:28.614383 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.my_second_dbt_model"
[0m14:53:28.616384 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.my_second_dbt_model (compile): 14:53:28.609383 => 14:53:28.616384
[0m14:53:28.618384 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.my_second_dbt_model
[0m14:53:28.628384 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.my_second_dbt_model"
[0m14:53:28.631383 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_second_dbt_model"
[0m14:53:28.633383 [debug] [Thread-1 (]: On model.learn_duckdb.my_second_dbt_model: BEGIN
[0m14:53:28.635152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:28.649673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.650674 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_second_dbt_model"
[0m14:53:28.652674 [debug] [Thread-1 (]: On model.learn_duckdb.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:53:28.654675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.661671 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_second_dbt_model"
[0m14:53:28.662673 [debug] [Thread-1 (]: On model.learn_duckdb.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:53:28.663674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.668673 [debug] [Thread-1 (]: On model.learn_duckdb.my_second_dbt_model: COMMIT
[0m14:53:28.669674 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_second_dbt_model"
[0m14:53:28.669674 [debug] [Thread-1 (]: On model.learn_duckdb.my_second_dbt_model: COMMIT
[0m14:53:28.673675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.677671 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_second_dbt_model"
[0m14:53:28.677671 [debug] [Thread-1 (]: On model.learn_duckdb.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:53:28.679674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:28.682679 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.my_second_dbt_model (execute): 14:53:28.618384 => 14:53:28.682679
[0m14:53:28.684674 [debug] [Thread-1 (]: On model.learn_duckdb.my_second_dbt_model: Close
[0m14:53:28.691675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08b7e635-02b9-4ea9-8d79-ded9795c70f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E5904690>]}
[0m14:53:28.693671 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m14:53:28.694673 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.my_second_dbt_model
[0m14:53:28.697676 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:28.698674 [debug] [MainThread]: On master: BEGIN
[0m14:53:28.699673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:28.714674 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:28.716674 [debug] [MainThread]: On master: COMMIT
[0m14:53:28.718673 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:28.719676 [debug] [MainThread]: On master: COMMIT
[0m14:53:28.720675 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:28.721674 [debug] [MainThread]: On master: Close
[0m14:53:28.725673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:28.726673 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m14:53:28.727672 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m14:53:28.728675 [debug] [MainThread]: Connection 'model.learn_duckdb.my_second_dbt_model' was properly closed.
[0m14:53:28.729675 [info ] [MainThread]: 
[0m14:53:28.731675 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m14:53:28.733676 [debug] [MainThread]: Command end result
[0m14:53:28.760675 [info ] [MainThread]: 
[0m14:53:28.764676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:28.765678 [info ] [MainThread]: 
[0m14:53:28.768676 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:53:28.771676 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:28.771676 after 1.41 seconds
[0m14:53:28.772676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DE958250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E4F500D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2DEC2E890>]}
[0m14:53:28.774676 [debug] [MainThread]: Flushing usage events
[0m15:59:59.585685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC80CFFB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC80CFFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC80CFF990>]}


============================== 15:59:59.590686 | bac9be31-5eab-41b2-a72d-0328757d3c53 ==============================
[0m15:59:59.590686 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:59:59.592686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:59.594686 [info ] [MainThread]: dbt version: 1.7.11
[0m15:59:59.595687 [info ] [MainThread]: python version: 3.11.4
[0m15:59:59.596686 [info ] [MainThread]: python path: C:\Users\Use\OneDrive\Development\dbt-course\venv\Scripts\python.exe
[0m15:59:59.598688 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:59:59.745700 [info ] [MainThread]: Using profiles dir at C:\Users\Use\.dbt
[0m15:59:59.746688 [info ] [MainThread]: Using profiles.yml file at C:\Users\Use\.dbt\profiles.yml
[0m15:59:59.748684 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\dbt_project.yml
[0m15:59:59.750684 [info ] [MainThread]: adapter type: duckdb
[0m15:59:59.752694 [info ] [MainThread]: adapter version: 1.7.3
[0m15:59:59.843700 [info ] [MainThread]: Configuration:
[0m15:59:59.844689 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:59:59.846685 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:59:59.847686 [info ] [MainThread]: Required dependencies:
[0m15:59:59.848685 [debug] [MainThread]: Executing "git --help"
[0m15:59:59.922684 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:59:59.923700 [debug] [MainThread]: STDERR: "b''"
[0m15:59:59.923700 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:59:59.925685 [info ] [MainThread]: Connection:
[0m15:59:59.927686 [info ] [MainThread]:   database: dev
[0m15:59:59.928686 [info ] [MainThread]:   schema: main
[0m15:59:59.929686 [info ] [MainThread]:   path: dev.duckdb
[0m15:59:59.930687 [info ] [MainThread]:   config_options: None
[0m15:59:59.931685 [info ] [MainThread]:   extensions: None
[0m15:59:59.932686 [info ] [MainThread]:   settings: None
[0m15:59:59.933685 [info ] [MainThread]:   external_root: .
[0m15:59:59.934686 [info ] [MainThread]:   use_credential_provider: None
[0m15:59:59.935686 [info ] [MainThread]:   attach: None
[0m15:59:59.936686 [info ] [MainThread]:   filesystems: None
[0m15:59:59.937685 [info ] [MainThread]:   remote: None
[0m15:59:59.938686 [info ] [MainThread]:   plugins: None
[0m15:59:59.939685 [info ] [MainThread]:   disable_transactions: False
[0m15:59:59.940686 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m15:59:59.941686 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:59:59.942686 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:59:59.943690 [debug] [MainThread]: On debug: select 1 as id
[0m15:59:59.943690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:59.975685 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:59:59.977685 [debug] [MainThread]: On debug: Close
[0m15:59:59.980690 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:59:59.982685 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:59:59.984685 [debug] [MainThread]: Command `dbt debug` succeeded at 15:59:59.984685 after 0.47 seconds
[0m15:59:59.985705 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:59:59.985705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFA3A8AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFA67ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFA67EF50>]}
[0m15:59:59.986685 [debug] [MainThread]: Flushing usage events
[0m21:49:18.944422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E61D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E0D2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E0D1F90>]}


============================== 21:49:18.950443 | e9691ea3-e4db-4ecc-b519-ac9a342e0c8f ==============================
[0m21:49:18.950443 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:49:18.952410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:18.954422 [info ] [MainThread]: dbt version: 1.7.11
[0m21:49:18.955438 [info ] [MainThread]: python version: 3.11.4
[0m21:49:18.956427 [info ] [MainThread]: python path: C:\Users\Use\OneDrive\Development\dbt-course\venv\Scripts\python.exe
[0m21:49:18.957406 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m21:49:19.116412 [info ] [MainThread]: Using profiles dir at C:\Users\Use\.dbt
[0m21:49:19.118407 [info ] [MainThread]: Using profiles.yml file at C:\Users\Use\.dbt\profiles.yml
[0m21:49:19.119407 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\dbt_project.yml
[0m21:49:19.122409 [info ] [MainThread]: adapter type: duckdb
[0m21:49:19.123422 [info ] [MainThread]: adapter version: 1.7.3
[0m21:49:19.219408 [info ] [MainThread]: Configuration:
[0m21:49:19.220416 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:49:19.222406 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:49:19.223406 [info ] [MainThread]: Required dependencies:
[0m21:49:19.223406 [debug] [MainThread]: Executing "git --help"
[0m21:49:19.287422 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:49:19.287422 [debug] [MainThread]: STDERR: "b''"
[0m21:49:19.288423 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:49:19.289411 [info ] [MainThread]: Connection:
[0m21:49:19.290406 [info ] [MainThread]:   database: dev
[0m21:49:19.291409 [info ] [MainThread]:   schema: main
[0m21:49:19.292406 [info ] [MainThread]:   path: dev.duckdb
[0m21:49:19.293408 [info ] [MainThread]:   config_options: None
[0m21:49:19.294422 [info ] [MainThread]:   extensions: None
[0m21:49:19.295405 [info ] [MainThread]:   settings: None
[0m21:49:19.295405 [info ] [MainThread]:   external_root: .
[0m21:49:19.296408 [info ] [MainThread]:   use_credential_provider: None
[0m21:49:19.297409 [info ] [MainThread]:   attach: None
[0m21:49:19.298406 [info ] [MainThread]:   filesystems: None
[0m21:49:19.299409 [info ] [MainThread]:   remote: None
[0m21:49:19.300423 [info ] [MainThread]:   plugins: None
[0m21:49:19.301422 [info ] [MainThread]:   disable_transactions: False
[0m21:49:19.302422 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m21:49:19.303422 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m21:49:19.303422 [debug] [MainThread]: Using duckdb connection "debug"
[0m21:49:19.304416 [debug] [MainThread]: On debug: select 1 as id
[0m21:49:19.305407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:19.341408 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:49:19.342427 [debug] [MainThread]: On debug: Close
[0m21:49:19.346422 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:49:19.346422 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:49:19.349422 [debug] [MainThread]: Command `dbt debug` succeeded at 21:49:19.349422 after 0.49 seconds
[0m21:49:19.350422 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:49:19.350422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF87B839D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF87E65F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF87DD4A90>]}
[0m21:49:19.351422 [debug] [MainThread]: Flushing usage events
[0m21:49:40.743145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001969377F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001969377E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001969377F710>]}


============================== 21:49:40.748145 | d2be057b-94bd-4f25-9e01-a60aa9bd4de5 ==============================
[0m21:49:40.748145 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:49:40.749146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:40.750146 [info ] [MainThread]: dbt version: 1.7.11
[0m21:49:40.751151 [info ] [MainThread]: python version: 3.11.4
[0m21:49:40.752149 [info ] [MainThread]: python path: C:\Users\Use\OneDrive\Development\dbt-course\venv\Scripts\python.exe
[0m21:49:40.753150 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m21:49:40.909145 [info ] [MainThread]: Using profiles dir at C:\Users\Use\.dbt
[0m21:49:40.910145 [info ] [MainThread]: Using profiles.yml file at C:\Users\Use\.dbt\profiles.yml
[0m21:49:40.911150 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\dbt_project.yml
[0m21:49:40.913148 [info ] [MainThread]: adapter type: duckdb
[0m21:49:40.914147 [info ] [MainThread]: adapter version: 1.7.3
[0m21:49:41.002146 [info ] [MainThread]: Configuration:
[0m21:49:41.003147 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:49:41.004146 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:49:41.005147 [info ] [MainThread]: Required dependencies:
[0m21:49:41.006147 [debug] [MainThread]: Executing "git --help"
[0m21:49:41.067167 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:49:41.068167 [debug] [MainThread]: STDERR: "b''"
[0m21:49:41.068167 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:49:41.070148 [info ] [MainThread]: Connection:
[0m21:49:41.071167 [info ] [MainThread]:   database: dev
[0m21:49:41.072151 [info ] [MainThread]:   schema: main
[0m21:49:41.073160 [info ] [MainThread]:   path: dev.duckdb
[0m21:49:41.074156 [info ] [MainThread]:   config_options: None
[0m21:49:41.075167 [info ] [MainThread]:   extensions: None
[0m21:49:41.076151 [info ] [MainThread]:   settings: None
[0m21:49:41.077167 [info ] [MainThread]:   external_root: .
[0m21:49:41.078167 [info ] [MainThread]:   use_credential_provider: None
[0m21:49:41.078167 [info ] [MainThread]:   attach: None
[0m21:49:41.079151 [info ] [MainThread]:   filesystems: None
[0m21:49:41.080150 [info ] [MainThread]:   remote: None
[0m21:49:41.081167 [info ] [MainThread]:   plugins: None
[0m21:49:41.081167 [info ] [MainThread]:   disable_transactions: False
[0m21:49:41.082151 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m21:49:41.083146 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m21:49:41.084151 [debug] [MainThread]: Using duckdb connection "debug"
[0m21:49:41.085152 [debug] [MainThread]: On debug: select 1 as id
[0m21:49:41.085152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:41.098162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:49:41.099162 [debug] [MainThread]: On debug: Close
[0m21:49:41.101151 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:49:41.102151 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:49:41.105147 [debug] [MainThread]: Command `dbt debug` succeeded at 21:49:41.105147 after 0.43 seconds
[0m21:49:41.106148 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:49:41.106148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968CCA39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968CF76B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968CF85C90>]}
[0m21:49:41.107147 [debug] [MainThread]: Flushing usage events
[0m21:50:10.737860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B5C4F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B5B6B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B5B6FD0>]}


============================== 21:50:10.743851 | e6f0288b-4751-48eb-ae1a-f4ecb1134afc ==============================
[0m21:50:10.743851 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:50:10.744854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:11.073865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6f0288b-4751-48eb-ae1a-f4ecb1134afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B6FBB50>]}
[0m21:50:11.169865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6f0288b-4751-48eb-ae1a-f4ecb1134afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B6E3B10>]}
[0m21:50:11.171850 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m21:50:11.182871 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:50:11.234865 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:50:11.235858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6f0288b-4751-48eb-ae1a-f4ecb1134afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B606B90>]}
[0m21:50:12.655870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6f0288b-4751-48eb-ae1a-f4ecb1134afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5BBA4A10>]}
[0m21:50:12.671882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6f0288b-4751-48eb-ae1a-f4ecb1134afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5BA3BF50>]}
[0m21:50:12.672858 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m21:50:12.675867 [info ] [MainThread]: 
[0m21:50:12.677864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:50:12.679865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m21:50:12.693866 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m21:50:12.694866 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m21:50:12.695871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:12.710866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:50:12.713854 [debug] [ThreadPool]: On list_dev: Close
[0m21:50:12.717851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m21:50:12.719878 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m21:50:12.727871 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m21:50:12.728871 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m21:50:12.729849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:12.740852 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:50:12.742870 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m21:50:12.743871 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m21:50:12.744856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:50:12.745855 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m21:50:12.746855 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m21:50:12.747849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:50:12.749855 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m21:50:12.750855 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m21:50:12.750855 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m21:50:12.751856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:50:12.752855 [debug] [ThreadPool]: On create_dev_main: Close
[0m21:50:12.758866 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m21:50:12.765866 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m21:50:12.766866 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m21:50:12.767871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:12.775871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:50:12.776871 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m21:50:12.777854 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m21:50:12.813871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:50:12.820871 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m21:50:12.831853 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m21:50:12.832851 [debug] [ThreadPool]: On list_dev_main: Close
[0m21:50:12.838866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f0288b-4751-48eb-ae1a-f4ecb1134afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B72D910>]}
[0m21:50:12.839866 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:12.839866 [debug] [MainThread]: On master: BEGIN
[0m21:50:12.840865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:12.848866 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:50:12.849865 [debug] [MainThread]: On master: COMMIT
[0m21:50:12.850851 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:12.850851 [debug] [MainThread]: On master: COMMIT
[0m21:50:12.852855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:50:12.853854 [debug] [MainThread]: On master: Close
[0m21:50:12.855855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:12.856853 [info ] [MainThread]: 
[0m21:50:12.861850 [debug] [Thread-1 (]: Began running node model.learn_duckdb.average_diamond_price_per_group
[0m21:50:12.862850 [info ] [Thread-1 (]: 1 of 7 START sql view model main.average_diamond_price_per_group ............... [RUN]
[0m21:50:12.863858 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.average_diamond_price_per_group'
[0m21:50:12.864865 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.average_diamond_price_per_group
[0m21:50:12.872865 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.average_diamond_price_per_group"
[0m21:50:12.874850 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.average_diamond_price_per_group (compile): 21:50:12.865866 => 21:50:12.874850
[0m21:50:12.875851 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.average_diamond_price_per_group
[0m21:50:12.913850 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.average_diamond_price_per_group"
[0m21:50:12.915850 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m21:50:12.916851 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: BEGIN
[0m21:50:12.916851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:12.925851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:12.925851 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m21:50:12.926851 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.average_diamond_price_per_group"} */

  
  create view "dev"."main"."average_diamond_price_per_group__dbt_tmp" as (
    SELECT 1 AS Id
  );

[0m21:50:12.927851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:12.936850 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m21:50:12.937852 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.average_diamond_price_per_group"} */
alter view "dev"."main"."average_diamond_price_per_group" rename to "average_diamond_price_per_group__dbt_backup"
[0m21:50:12.938849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:12.942848 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m21:50:12.943849 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.average_diamond_price_per_group"} */
alter view "dev"."main"."average_diamond_price_per_group__dbt_tmp" rename to "average_diamond_price_per_group"
[0m21:50:12.944849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:12.963850 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: COMMIT
[0m21:50:12.964848 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m21:50:12.965849 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: COMMIT
[0m21:50:12.969855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:12.975849 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.average_diamond_price_per_group"
[0m21:50:12.976848 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.average_diamond_price_per_group"} */
drop view if exists "dev"."main"."average_diamond_price_per_group__dbt_backup" cascade
[0m21:50:12.978851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:12.981850 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.average_diamond_price_per_group (execute): 21:50:12.876851 => 21:50:12.980850
[0m21:50:12.982850 [debug] [Thread-1 (]: On model.learn_duckdb.average_diamond_price_per_group: Close
[0m21:50:12.993870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6f0288b-4751-48eb-ae1a-f4ecb1134afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B9B3C10>]}
[0m21:50:12.994851 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.average_diamond_price_per_group .......... [[32mOK[0m in 0.13s]
[0m21:50:12.995850 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.average_diamond_price_per_group
[0m21:50:12.996850 [debug] [Thread-1 (]: Began running node model.learn_duckdb.my_first_dbt_model
[0m21:50:12.997851 [info ] [Thread-1 (]: 2 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:50:12.999868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.average_diamond_price_per_group, now model.learn_duckdb.my_first_dbt_model)
[0m21:50:12.999868 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.my_first_dbt_model
[0m21:50:13.004866 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.my_first_dbt_model"
[0m21:50:13.006858 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.my_first_dbt_model (compile): 21:50:13.000866 => 21:50:13.006858
[0m21:50:13.007871 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.my_first_dbt_model
[0m21:50:13.036866 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.my_first_dbt_model"
[0m21:50:13.038871 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m21:50:13.039871 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: BEGIN
[0m21:50:13.040850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:13.054870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.054870 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m21:50:13.055870 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:50:13.058852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.063861 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m21:50:13.063861 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:50:13.065862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.071860 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m21:50:13.072860 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:50:13.074861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.080860 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: COMMIT
[0m21:50:13.081860 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m21:50:13.082849 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: COMMIT
[0m21:50:13.087850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.091866 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.my_first_dbt_model"
[0m21:50:13.091866 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:50:13.094851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.098865 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.my_first_dbt_model (execute): 21:50:13.007871 => 21:50:13.097866
[0m21:50:13.099851 [debug] [Thread-1 (]: On model.learn_duckdb.my_first_dbt_model: Close
[0m21:50:13.110854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6f0288b-4751-48eb-ae1a-f4ecb1134afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B6B2710>]}
[0m21:50:13.111853 [info ] [Thread-1 (]: 2 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.11s]
[0m21:50:13.112852 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.my_first_dbt_model
[0m21:50:13.114854 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:13.115871 [info ] [Thread-1 (]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:50:13.116851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.my_first_dbt_model, now test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710)
[0m21:50:13.117850 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:13.131866 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:13.134850 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 21:50:13.117850 => 21:50:13.133851
[0m21:50:13.135851 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:13.154849 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:13.156849 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:13.157849 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m21:50:13.158849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:13.171849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.172849 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:13.173849 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."main"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m21:50:13.175849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.178850 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 21:50:13.136853 => 21:50:13.178850
[0m21:50:13.179849 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m21:50:13.180849 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:50:13.181851 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:50:13.184871 [error] [Thread-1 (]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
[0m21:50:13.185849 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:13.186866 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321
[0m21:50:13.187871 [info ] [Thread-1 (]: 4 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:50:13.189871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.not_null_my_first_dbt_model_id.5fb22c2710, now test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321)
[0m21:50:13.189871 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321
[0m21:50:13.198849 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:13.200851 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321 (compile): 21:50:13.190850 => 21:50:13.200851
[0m21:50:13.201851 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321
[0m21:50:13.206851 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:13.207850 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:13.208851 [debug] [Thread-1 (]: On test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m21:50:13.209850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:13.216850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.217850 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:13.218849 [debug] [Thread-1 (]: On test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:50:13.222850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:50:13.225850 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321 (execute): 21:50:13.202851 => 21:50:13.224850
[0m21:50:13.226851 [debug] [Thread-1 (]: On test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m21:50:13.227850 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321'
[0m21:50:13.228851 [debug] [Thread-1 (]: On test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:50:13.232849 [info ] [Thread-1 (]: 4 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m21:50:13.233860 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321
[0m21:50:13.234850 [debug] [Thread-1 (]: Began running node model.learn_duckdb.my_second_dbt_model
[0m21:50:13.235849 [info ] [Thread-1 (]: 5 of 7 SKIP relation main.my_second_dbt_model .................................. [[33mSKIP[0m]
[0m21:50:13.236853 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.my_second_dbt_model
[0m21:50:13.237850 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_my_second_dbt_model_id.151b76d778
[0m21:50:13.238850 [info ] [Thread-1 (]: 6 of 7 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m21:50:13.239850 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_my_second_dbt_model_id.151b76d778
[0m21:50:13.240852 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_my_second_dbt_model_id.57a0f8c493
[0m21:50:13.241851 [info ] [Thread-1 (]: 7 of 7 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m21:50:13.242855 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_my_second_dbt_model_id.57a0f8c493
[0m21:50:13.244851 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:13.245871 [debug] [MainThread]: On master: BEGIN
[0m21:50:13.246851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:50:13.253872 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:50:13.254870 [debug] [MainThread]: On master: COMMIT
[0m21:50:13.255870 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:13.256870 [debug] [MainThread]: On master: COMMIT
[0m21:50:13.257870 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:50:13.258870 [debug] [MainThread]: On master: Close
[0m21:50:13.260866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:13.261866 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m21:50:13.262866 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m21:50:13.262866 [debug] [MainThread]: Connection 'test.learn_duckdb.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:50:13.263863 [info ] [MainThread]: 
[0m21:50:13.264875 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 tests in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m21:50:13.266852 [debug] [MainThread]: Command end result
[0m21:50:13.280851 [info ] [MainThread]: 
[0m21:50:13.282851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:50:13.283855 [info ] [MainThread]: 
[0m21:50:13.284851 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:50:13.285851 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:50:13.286852 [info ] [MainThread]: 
[0m21:50:13.287852 [info ] [MainThread]:   compiled Code at target\compiled\learn_duckdb\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:50:13.288851 [info ] [MainThread]: 
[0m21:50:13.289851 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=3 TOTAL=7
[0m21:50:13.291851 [debug] [MainThread]: Command `dbt build` failed at 21:50:13.291851 after 2.63 seconds
[0m21:50:13.292851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B5CA690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F54AE39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5B5C6A10>]}
[0m21:50:13.293871 [debug] [MainThread]: Flushing usage events
[0m14:35:52.987608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F4BB4C8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F4DF1E010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F4E402AD0>]}


============================== 14:35:52.993608 | 46761b8b-49ed-4315-bdd6-653b08938f73 ==============================
[0m14:35:52.993608 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:35:52.994595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:52.996594 [info ] [MainThread]: dbt version: 1.7.11
[0m14:35:52.998598 [info ] [MainThread]: python version: 3.11.4
[0m14:35:52.999594 [info ] [MainThread]: python path: C:\Users\Use\OneDrive\Development\dbt-course\venv\Scripts\python.exe
[0m14:35:53.001595 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:35:53.152626 [info ] [MainThread]: Using profiles dir at C:\Users\Use\.dbt
[0m14:35:53.153611 [info ] [MainThread]: Using profiles.yml file at C:\Users\Use\.dbt\profiles.yml
[0m14:35:53.154611 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\dbt_project.yml
[0m14:35:53.157613 [info ] [MainThread]: adapter type: duckdb
[0m14:35:53.158619 [info ] [MainThread]: adapter version: 1.7.3
[0m14:35:53.251626 [info ] [MainThread]: Configuration:
[0m14:35:53.252622 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:35:53.253629 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:35:53.254623 [info ] [MainThread]: Required dependencies:
[0m14:35:53.256626 [debug] [MainThread]: Executing "git --help"
[0m14:35:53.325555 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:35:53.326545 [debug] [MainThread]: STDERR: "b''"
[0m14:35:53.327560 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:35:53.328546 [info ] [MainThread]: Connection:
[0m14:35:53.329545 [info ] [MainThread]:   database: AIRBNB
[0m14:35:53.330544 [info ] [MainThread]:   schema: main
[0m14:35:53.332547 [info ] [MainThread]:   path: AIRBNB.db
[0m14:35:53.333548 [info ] [MainThread]:   config_options: None
[0m14:35:53.334548 [info ] [MainThread]:   extensions: None
[0m14:35:53.335562 [info ] [MainThread]:   settings: None
[0m14:35:53.336547 [info ] [MainThread]:   external_root: .
[0m14:35:53.338548 [info ] [MainThread]:   use_credential_provider: None
[0m14:35:53.340556 [info ] [MainThread]:   attach: None
[0m14:35:53.341548 [info ] [MainThread]:   filesystems: None
[0m14:35:53.342548 [info ] [MainThread]:   remote: None
[0m14:35:53.343551 [info ] [MainThread]:   plugins: None
[0m14:35:53.344552 [info ] [MainThread]:   disable_transactions: False
[0m14:35:53.345548 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:35:53.346549 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:35:53.347549 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:35:53.347549 [debug] [MainThread]: On debug: select 1 as id
[0m14:35:53.348548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:53.378551 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:35:53.380571 [debug] [MainThread]: On debug: Close
[0m14:35:53.384572 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:35:53.385552 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:35:53.388561 [debug] [MainThread]: Command `dbt debug` succeeded at 14:35:53.387567 after 0.47 seconds
[0m14:35:53.388561 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:35:53.389568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F47917CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F4E05EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F4E625B50>]}
[0m14:35:53.391552 [debug] [MainThread]: Flushing usage events
[0m14:36:31.401020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A57AB17350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A57AB01950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A57AB00350>]}


============================== 14:36:31.406020 | cf516827-620e-40e1-9ffb-1222c1933b2f ==============================
[0m14:36:31.406020 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:36:31.407021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:36:31.584056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf516827-620e-40e1-9ffb-1222c1933b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A57AB6AA10>]}
[0m14:36:31.588041 [debug] [MainThread]: Set downloads directory='C:\Users\Use\AppData\Local\Temp\dbt-downloads-3vcgt8iz'
[0m14:36:31.589041 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:36:31.872488 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:36:31.874488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:36:32.112469 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:36:32.124465 [info ] [MainThread]: Updating lock file in file path: C:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb/package-lock.yml
[0m14:36:32.136459 [debug] [MainThread]: Set downloads directory='C:\Users\Use\AppData\Local\Temp\dbt-downloads-mt889_hp'
[0m14:36:32.141459 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:36:35.726660 [info ] [MainThread]: Installed from version 1.1.1
[0m14:36:35.727659 [info ] [MainThread]: Up to date!
[0m14:36:35.729661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cf516827-620e-40e1-9ffb-1222c1933b2f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A57AB440D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A57A56A750>]}
[0m14:36:35.735661 [debug] [MainThread]: Command `dbt deps` succeeded at 14:36:35.734661 after 4.40 seconds
[0m14:36:35.736662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A574067CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A574346210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5742B4D10>]}
[0m14:36:35.737662 [debug] [MainThread]: Flushing usage events
[0m14:38:49.256511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA5431F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA6551B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA6550110>]}


============================== 14:38:49.261517 | 0540f167-9bf8-4a4c-bc0c-70acc90d72e8 ==============================
[0m14:38:49.261517 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:38:49.263518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:49.442533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0540f167-9bf8-4a4c-bc0c-70acc90d72e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA6631E50>]}
[0m14:38:49.624497 [debug] [MainThread]: Set downloads directory='C:\Users\Use\AppData\Local\Temp\dbt-downloads-58956ocg'
[0m14:38:49.626501 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:38:49.876525 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:38:49.879526 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:38:50.111556 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:38:50.126553 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:38:50.966256 [info ] [MainThread]: Installed from version 1.1.1
[0m14:38:50.969258 [info ] [MainThread]: Up to date!
[0m14:38:50.972257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0540f167-9bf8-4a4c-bc0c-70acc90d72e8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA659F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA659F090>]}
[0m14:38:50.980259 [debug] [MainThread]: Command `dbt deps` succeeded at 14:38:50.979258 after 1.79 seconds
[0m14:38:50.982258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BA5FCABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B9FA57CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B9FD35F90>]}
[0m14:38:50.983259 [debug] [MainThread]: Flushing usage events
[0m14:41:55.970888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817B0FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817B0E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817B0C090>]}


============================== 14:41:55.975888 | 6eeeec29-b824-47ab-9182-2b5e1f3b7d2b ==============================
[0m14:41:55.975888 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:41:55.978887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:41:56.365931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817B8F590>]}
[0m14:41:56.466942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817B435D0>]}
[0m14:41:56.469942 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:41:56.486947 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:41:56.751606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m14:41:56.752605 [debug] [MainThread]: Partial parsing: added file: learn_duckdb://tests\generic\positive_value.sql
[0m14:41:56.753605 [debug] [MainThread]: Partial parsing: added file: learn_duckdb://tests\consistent_created_at.sql
[0m14:41:56.754606 [debug] [MainThread]: Partial parsing: added file: learn_duckdb://tests\dim_listings_minimum_nights.sql
[0m14:41:56.755607 [debug] [MainThread]: Partial parsing: added file: learn_duckdb://tests\no_nulls_in_dim_listings.sql
[0m14:41:56.757607 [debug] [MainThread]: Partial parsing: added file: learn_duckdb://snapshots\scd_raw_listings.sql
[0m14:41:57.092646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817E02B90>]}
[0m14:41:57.128650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817CF6ED0>]}
[0m14:41:57.129650 [info ] [MainThread]: Found 8 models, 1 seed, 9 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m14:41:57.136665 [info ] [MainThread]: 
[0m14:41:57.139655 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:41:57.142651 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m14:41:57.162673 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m14:41:57.163668 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m14:41:57.164652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:57.182657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.185656 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:41:57.196655 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m14:41:57.198656 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m14:41:57.199656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:57.212659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.215659 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:41:57.222661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m14:41:57.224661 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m14:41:57.236661 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:41:57.237664 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m14:41:57.239663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:57.250663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.253663 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:41:57.254664 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m14:41:57.256664 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.257664 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:41:57.258664 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m14:41:57.261665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.262666 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m14:41:57.263664 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:41:57.264664 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m14:41:57.266666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.267668 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m14:41:57.273666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_main, now create_AIRBNB_dev)
[0m14:41:57.274665 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m14:41:57.278666 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:41:57.279664 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m14:41:57.280666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:57.294669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.296669 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:41:57.297670 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m14:41:57.299668 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.300668 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:41:57.301669 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m14:41:57.302670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.304669 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m14:41:57.305669 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:41:57.306670 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m14:41:57.310668 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.311671 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m14:41:57.327671 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m14:41:57.336672 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m14:41:57.337671 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m14:41:57.338672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:57.354676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.355675 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m14:41:57.356675 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m14:41:57.401679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.404679 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m14:41:57.418682 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m14:41:57.420683 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m14:41:57.426683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m14:41:57.431684 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m14:41:57.432684 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m14:41:57.434684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:57.447685 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.448685 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m14:41:57.449686 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m14:41:57.518693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:41:57.524694 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m14:41:57.527695 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m14:41:57.529695 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:41:57.536696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E818102850>]}
[0m14:41:57.537696 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:57.539696 [debug] [MainThread]: On master: BEGIN
[0m14:41:57.540696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:57.556699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:41:57.557699 [debug] [MainThread]: On master: COMMIT
[0m14:41:57.558700 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:57.559700 [debug] [MainThread]: On master: COMMIT
[0m14:41:57.560699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:41:57.562700 [debug] [MainThread]: On master: Close
[0m14:41:57.567700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:57.569699 [info ] [MainThread]: 
[0m14:41:57.575702 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m14:41:57.576700 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m14:41:57.578701 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m14:41:57.596941 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m14:41:57.599941 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 14:41:57.579700 => 14:41:57.598941
[0m14:41:57.601941 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m14:41:57.602943 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m14:41:57.605942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m14:41:57.606942 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m14:41:57.615943 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m14:41:57.617943 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 14:41:57.607942 => 14:41:57.617943
[0m14:41:57.621944 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m14:41:57.622945 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m14:41:57.624943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m14:41:57.625945 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m14:41:57.633944 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m14:41:57.637946 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 14:41:57.626944 => 14:41:57.636947
[0m14:41:57.640946 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m14:41:57.643946 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m14:41:57.647947 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m14:41:57.652946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m14:41:57.654948 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m14:41:57.656947 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 14:41:57.655947 => 14:41:57.655947
[0m14:41:57.657947 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m14:41:57.733956 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m14:41:57.735957 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m14:41:57.736957 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:57.752959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:57.753958 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m14:41:57.754960 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m14:41:57.756962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:57.782962 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m14:41:57.783961 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'c:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:41:57.802964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:57.818964 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m14:41:57.856968 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m14:41:57.857970 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m14:41:57.858969 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m14:41:57.862971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:57.865972 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 14:41:57.659948 => 14:41:57.865972
[0m14:41:57.867971 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m14:41:57.880974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E818256710>]}
[0m14:41:57.881974 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file main.seed_full_moon_dates .......................... [[32mINSERT 272[0m in 0.23s]
[0m14:41:57.884973 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m14:41:57.886974 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m14:41:57.888973 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m14:41:57.890974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m14:41:57.892973 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m14:41:57.898975 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 14:41:57.892973 => 14:41:57.897974
[0m14:41:57.899976 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m14:41:57.967982 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m14:41:57.971984 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m14:41:57.975983 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m14:41:57.976983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:58.000986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:58.002987 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m14:41:58.004987 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m14:41:58.051992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:58.057993 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m14:41:58.058993 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m14:41:58.060994 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m14:41:58.106002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:58.111999 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 14:41:57.900977 => 14:41:58.111999
[0m14:41:58.117000 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m14:41:58.225014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8180C8810>]}
[0m14:41:58.227013 [info ] [Thread-1 (]: 2 of 16 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.33s]
[0m14:41:58.230013 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m14:41:58.232014 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m14:41:58.234012 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m14:41:58.237014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m14:41:58.239015 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m14:41:58.258016 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m14:41:58.262020 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 14:41:58.240016 => 14:41:58.261017
[0m14:41:58.263017 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m14:41:58.348025 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m14:41:58.351026 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:41:58.354028 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m14:41:58.356027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:58.378028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:58.380030 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:41:58.381029 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    NVL(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m14:41:58.398032 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 14:41:58.264017 => 14:41:58.397031
[0m14:41:58.399032 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m14:41:58.532047 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m14:41:58.533047 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m14:41:58.546048 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Scalar Function with name nvl does not exist!
  Did you mean "ln"?
  LINE 29:     NVL(
               ^
[0m14:41:58.547048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817EE06D0>]}
[0m14:41:58.549049 [error] [Thread-1 (]: 3 of 16 ERROR creating sql view model main.dim_hosts_cleansed .................. [[31mERROR[0m in 0.31s]
[0m14:41:58.553052 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m14:41:58.555053 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m14:41:58.558050 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m14:41:58.562051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m14:41:58.564051 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m14:41:58.623730 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m14:41:58.639732 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 14:41:58.566052 => 14:41:58.638730
[0m14:41:58.642732 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m14:41:58.661733 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m14:41:58.665733 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m14:41:58.667735 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m14:41:58.670736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:58.684735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:58.686736 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m14:41:58.688736 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str, '$'
    ) :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m14:41:58.692738 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 14:41:58.643735 => 14:41:58.692738
[0m14:41:58.694737 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m14:41:58.701737 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m14:41:58.702738 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m14:41:58.713741 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Binder Error: No function matches the given name and argument types 'replace(VARCHAR, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	replace(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR
  
  LINE 40:     REPLACE(
               ^
[0m14:41:58.714741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E817EFF690>]}
[0m14:41:58.717742 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.16s]
[0m14:41:58.720741 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m14:41:58.722741 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m14:41:58.723741 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m14:41:58.726743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m14:41:58.728743 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m14:41:58.785746 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m14:41:58.791401 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 14:41:58.730741 => 14:41:58.789885
[0m14:41:58.792400 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m14:41:58.862409 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m14:41:58.865408 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m14:41:58.867410 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m14:41:58.868409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:58.879409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:41:58.880411 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m14:41:58.881410 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m14:42:00.116231 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:42:00.119233 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m14:42:00.121233 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m14:42:00.122234 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m14:42:00.460271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:42:00.464271 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 14:41:58.793400 => 14:42:00.463271
[0m14:42:00.465279 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m14:42:00.498275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E818096290>]}
[0m14:42:00.499277 [info ] [Thread-1 (]: 5 of 16 OK created sql incremental model main.fct_reviews ...................... [[32mOK[0m in 1.77s]
[0m14:42:00.501278 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m14:42:00.503276 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:42:00.504277 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m14:42:00.506275 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:42:00.508278 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m14:42:00.509277 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m14:42:00.511282 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m14:42:00.513283 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m14:42:00.514277 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m14:42:00.516279 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m14:42:00.517279 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:42:00.519281 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m14:42:00.521298 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:42:00.522280 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:42:00.524278 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m14:42:00.526283 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:42:00.528280 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:42:00.529285 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m14:42:00.532280 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:42:00.535281 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:42:00.536280 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m14:42:00.538280 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:42:00.540289 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:42:00.541287 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m14:42:00.543282 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:42:00.545281 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m14:42:00.547282 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_fullmoon_reviews ...................... [RUN]
[0m14:42:00.549283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.fct_reviews, now model.learn_duckdb.mart_fullmoon_reviews)
[0m14:42:00.550283 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m14:42:00.558284 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m14:42:00.562283 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 14:42:00.551284 => 14:42:00.561283
[0m14:42:00.564284 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m14:42:00.588888 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m14:42:00.592888 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m14:42:00.594888 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m14:42:00.595888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:00.616889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:42:00.616889 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m14:42:00.618892 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
    );
  
  
[0m14:42:00.628890 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 14:42:00.565283 => 14:42:00.628890
[0m14:42:00.630889 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m14:42:00.635890 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m14:42:00.636894 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m14:42:00.643894 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m14:42:00.644892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eeeec29-b824-47ab-9182-2b5e1f3b7d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E818385190>]}
[0m14:42:00.646892 [error] [Thread-1 (]: 14 of 16 ERROR creating sql table model main.mart_fullmoon_reviews ............. [[31mERROR[0m in 0.10s]
[0m14:42:00.647892 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m14:42:00.649894 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m14:42:00.650893 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m14:42:00.651894 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m14:42:00.653895 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m14:42:00.655895 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m14:42:00.657897 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m14:42:00.660896 [debug] [MainThread]: Using duckdb connection "master"
[0m14:42:00.661897 [debug] [MainThread]: On master: BEGIN
[0m14:42:00.662896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:00.671896 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:42:00.672897 [debug] [MainThread]: On master: COMMIT
[0m14:42:00.674898 [debug] [MainThread]: Using duckdb connection "master"
[0m14:42:00.675898 [debug] [MainThread]: On master: COMMIT
[0m14:42:00.678897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:42:00.679898 [debug] [MainThread]: On master: Close
[0m14:42:00.684897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:00.685897 [debug] [MainThread]: Connection 'create_AIRBNB_dev' was properly closed.
[0m14:42:00.686898 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m14:42:00.687903 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m14:42:00.689899 [info ] [MainThread]: 
[0m14:42:00.691898 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m14:42:00.696898 [debug] [MainThread]: Command end result
[0m14:42:00.868921 [info ] [MainThread]: 
[0m14:42:00.873920 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:42:00.875919 [info ] [MainThread]: 
[0m14:42:00.880924 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Scalar Function with name nvl does not exist!
  Did you mean "ln"?
  LINE 29:     NVL(
               ^
[0m14:42:00.883923 [info ] [MainThread]: 
[0m14:42:00.886924 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Binder Error: No function matches the given name and argument types 'replace(VARCHAR, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	replace(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR
  
  LINE 40:     REPLACE(
               ^
[0m14:42:00.891921 [info ] [MainThread]: 
[0m14:42:00.895922 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m14:42:00.906924 [info ] [MainThread]: 
[0m14:42:00.910924 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=10 TOTAL=16
[0m14:42:00.919927 [debug] [MainThread]: Command `dbt build` failed at 14:42:00.918928 after 5.03 seconds
[0m14:42:00.923928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E811007CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E811255A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8112558D0>]}
[0m14:42:00.926925 [debug] [MainThread]: Flushing usage events
[0m14:55:29.831805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F678C8E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6791AA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6791A81D0>]}


============================== 14:55:29.839807 | 95c570d3-337d-4d60-8cb3-4245d8d02e42 ==============================
[0m14:55:29.839807 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:55:29.842808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:30.255444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95c570d3-337d-4d60-8cb3-4245d8d02e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F679370050>]}
[0m14:55:30.408455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95c570d3-337d-4d60-8cb3-4245d8d02e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6792A6090>]}
[0m14:55:30.411457 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:55:30.433457 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:55:30.658476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:30.660476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:30.668477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95c570d3-337d-4d60-8cb3-4245d8d02e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F679455150>]}
[0m14:55:30.690481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95c570d3-337d-4d60-8cb3-4245d8d02e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6794B3E10>]}
[0m14:55:30.692480 [info ] [MainThread]: Found 8 models, 1 seed, 9 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m14:55:30.695479 [info ] [MainThread]: 
[0m14:55:30.697479 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:30.699479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m14:55:30.714494 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m14:55:30.715494 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m14:55:30.716494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:30.800687 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m14:55:30.801688 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m14:55:30.802689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:30.873707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:30.874708 [debug] [MainThread]: Connection 'list_AIRBNB' was properly closed.
[0m14:55:30.875704 [info ] [MainThread]: 
[0m14:55:30.876705 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:55:30.877707 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Use\.julia\juliaup\julia-1.10.2+0.x64.w64.mingw32\bin\julia.exe (PID 12472)
[0m14:55:30.881725 [debug] [MainThread]: Command `dbt build` failed at 14:55:30.881725 after 1.13 seconds
[0m14:55:30.882708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672657CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6791992D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F679199DD0>]}
[0m14:55:30.883712 [debug] [MainThread]: Flushing usage events
[0m14:55:47.574477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F08EE150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F0E1B210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F0E19510>]}


============================== 14:55:47.580477 | ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373 ==============================
[0m14:55:47.580477 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:55:47.582457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:47.909503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F0F21290>]}
[0m14:55:48.003510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F0F11050>]}
[0m14:55:48.007492 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:55:48.024493 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:55:48.263637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:48.264638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:48.273638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F1220990>]}
[0m14:55:48.294621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F1123C90>]}
[0m14:55:48.296625 [info ] [MainThread]: Found 8 models, 1 seed, 9 tests, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m14:55:48.302641 [info ] [MainThread]: 
[0m14:55:48.304625 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:48.308627 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m14:55:48.323627 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m14:55:48.325624 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m14:55:48.326625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:48.341625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.345630 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:55:48.354625 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m14:55:48.355626 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m14:55:48.357627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:48.367627 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.369627 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:55:48.374627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m14:55:48.376626 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m14:55:48.384631 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:55:48.385632 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m14:55:48.386636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:48.396630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.398628 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:55:48.398628 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m14:55:48.400629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.401630 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:55:48.402629 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m14:55:48.403640 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.404633 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m14:55:48.405632 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:55:48.406630 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m14:55:48.407633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.408634 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m14:55:48.412633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_main, now create_AIRBNB_dev)
[0m14:55:48.413631 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m14:55:48.417634 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:55:48.418634 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m14:55:48.419635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:48.428636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.430636 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:55:48.431636 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m14:55:48.433635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.433635 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:55:48.434636 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m14:55:48.435636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.436637 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m14:55:48.437637 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:55:48.437637 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m14:55:48.438637 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.439633 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m14:55:48.445634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m14:55:48.451633 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m14:55:48.452634 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m14:55:48.453633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:48.462635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.462635 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m14:55:48.463634 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m14:55:48.500658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.502658 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m14:55:48.504638 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m14:55:48.504638 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m14:55:48.509640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m14:55:48.512640 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m14:55:48.513640 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m14:55:48.514640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:48.523659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.524660 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m14:55:48.525639 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m14:55:48.561662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:48.563662 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m14:55:48.564662 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m14:55:48.565663 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:55:48.569663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F0FBD0D0>]}
[0m14:55:48.571647 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:48.572643 [debug] [MainThread]: On master: BEGIN
[0m14:55:48.573642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:48.581644 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:48.582642 [debug] [MainThread]: On master: COMMIT
[0m14:55:48.583643 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:48.584644 [debug] [MainThread]: On master: COMMIT
[0m14:55:48.585643 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:48.586643 [debug] [MainThread]: On master: Close
[0m14:55:48.589643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:48.590644 [info ] [MainThread]: 
[0m14:55:48.595646 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m14:55:48.597645 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m14:55:48.598646 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m14:55:48.607647 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m14:55:48.609648 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 14:55:48.598646 => 14:55:48.608647
[0m14:55:48.612648 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m14:55:48.613647 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m14:55:48.614647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m14:55:48.615647 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m14:55:48.619668 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m14:55:48.621648 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 14:55:48.615647 => 14:55:48.621648
[0m14:55:48.623649 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m14:55:48.624648 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m14:55:48.626649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m14:55:48.626649 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m14:55:48.632650 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m14:55:48.634649 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 14:55:48.627648 => 14:55:48.633650
[0m14:55:48.636650 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m14:55:48.637649 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m14:55:48.638649 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m14:55:48.640649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m14:55:48.641649 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m14:55:48.642650 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 14:55:48.642650 => 14:55:48.642650
[0m14:55:48.643649 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m14:55:48.684652 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m14:55:48.686652 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m14:55:48.687652 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:48.701655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:48.702654 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m14:55:48.703656 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m14:55:48.706655 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 14:55:48.644649 => 14:55:48.706655
[0m14:55:48.707654 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: ROLLBACK
[0m14:55:48.720656 [debug] [Thread-1 (]: Failed to rollback 'seed.learn_duckdb.seed_full_moon_dates'
[0m14:55:48.721656 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m14:55:48.735658 [debug] [Thread-1 (]: Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m14:55:48.737658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F1107210>]}
[0m14:55:48.739657 [error] [Thread-1 (]: 1 of 16 ERROR loading seed file main.seed_full_moon_dates ...................... [[31mERROR[0m in 0.10s]
[0m14:55:48.742657 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m14:55:48.743658 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m14:55:48.744656 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m14:55:48.746657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m14:55:48.748659 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m14:55:48.762661 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 14:55:48.749658 => 14:55:48.761660
[0m14:55:48.763659 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m14:55:48.843665 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m14:55:48.845665 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m14:55:48.847666 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m14:55:48.848667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:48.858671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:48.859670 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m14:55:48.861203 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m14:55:48.865211 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 14:55:48.764660 => 14:55:48.865211
[0m14:55:48.866215 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: ROLLBACK
[0m14:55:48.872214 [debug] [Thread-1 (]: Failed to rollback 'snapshot.learn_duckdb.scd_raw_listings'
[0m14:55:48.873214 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m14:55:48.880212 [debug] [Thread-1 (]: Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m14:55:48.881212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F1058350>]}
[0m14:55:48.883216 [error] [Thread-1 (]: 2 of 16 ERROR snapshotting dev.scd_raw_listings ................................ [[31mERROR[0m in 0.14s]
[0m14:55:48.885217 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m14:55:48.887213 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m14:55:48.888213 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m14:55:48.890212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m14:55:48.892213 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m14:55:48.900217 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m14:55:48.903214 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 14:55:48.892213 => 14:55:48.902216
[0m14:55:48.904215 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m14:55:48.950218 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m14:55:48.952217 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:55:48.954220 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m14:55:48.955219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:48.965218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:48.966221 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:55:48.967219 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m14:55:48.968220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:48.977240 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:55:48.978220 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m14:55:48.980223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:48.997221 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m14:55:48.998221 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:55:48.999221 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m14:55:49.002221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:49.010220 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:55:49.011220 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."main"."dim_hosts_cleansed__dbt_backup" cascade
[0m14:55:49.012225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:49.014223 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 14:55:48.905215 => 14:55:49.014223
[0m14:55:49.015222 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m14:55:49.029224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F24C76D0>]}
[0m14:55:49.030224 [info ] [Thread-1 (]: 3 of 16 OK created sql view model main.dim_hosts_cleansed ...................... [[32mOK[0m in 0.14s]
[0m14:55:49.031223 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m14:55:49.032224 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m14:55:49.033223 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m14:55:49.035226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m14:55:49.036225 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m14:55:49.044224 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m14:55:49.046234 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 14:55:49.036225 => 14:55:49.046234
[0m14:55:49.047225 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m14:55:49.055228 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m14:55:49.058227 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m14:55:49.059227 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m14:55:49.060226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:49.075226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:49.076227 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m14:55:49.077230 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str, '$'
    ) :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m14:55:49.081227 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 14:55:49.048225 => 14:55:49.080230
[0m14:55:49.082228 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m14:55:49.085227 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m14:55:49.086227 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m14:55:49.093228 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Binder Error: No function matches the given name and argument types 'replace(VARCHAR, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	replace(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR
  
  LINE 40:     REPLACE(
               ^
[0m14:55:49.094229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F2507650>]}
[0m14:55:49.095230 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.06s]
[0m14:55:49.097230 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m14:55:49.098231 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m14:55:49.100229 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m14:55:49.102231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m14:55:49.103230 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m14:55:49.133231 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m14:55:49.135232 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 14:55:49.103230 => 14:55:49.134231
[0m14:55:49.137232 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m14:55:49.183238 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m14:55:49.185238 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m14:55:49.188238 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m14:55:49.189239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:49.203238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:49.204238 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m14:55:49.205239 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m14:55:49.208801 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 14:55:49.137232 => 14:55:49.208801
[0m14:55:49.209800 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: ROLLBACK
[0m14:55:49.215798 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.fct_reviews'
[0m14:55:49.216799 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m14:55:49.222801 [debug] [Thread-1 (]: Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m14:55:49.223801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd9cf60-b61b-4e4e-b44b-63ec4f8c5373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F0E7A650>]}
[0m14:55:49.224801 [error] [Thread-1 (]: 5 of 16 ERROR creating sql incremental model main.fct_reviews .................. [[31mERROR[0m in 0.12s]
[0m14:55:49.226806 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m14:55:49.227807 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:55:49.228804 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m14:55:49.230802 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:55:49.231804 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m14:55:49.232805 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m14:55:49.234803 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m14:55:49.236804 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m14:55:49.237805 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m14:55:49.239802 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m14:55:49.240805 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:55:49.241805 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m14:55:49.244807 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:55:49.245804 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:55:49.246804 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m14:55:49.247803 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:55:49.248804 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:55:49.249803 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m14:55:49.250804 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:55:49.251804 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:55:49.252807 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m14:55:49.253805 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:55:49.254806 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:55:49.255807 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m14:55:49.257806 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:55:49.259806 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m14:55:49.261805 [info ] [Thread-1 (]: 14 of 16 SKIP relation main.mart_fullmoon_reviews .............................. [[33mSKIP[0m]
[0m14:55:49.263806 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m14:55:49.264805 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m14:55:49.265804 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m14:55:49.266804 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m14:55:49.267805 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m14:55:49.268804 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m14:55:49.269805 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m14:55:49.272805 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:49.273806 [debug] [MainThread]: On master: BEGIN
[0m14:55:49.274807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:49.283806 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:49.285806 [debug] [MainThread]: On master: COMMIT
[0m14:55:49.285806 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:49.286806 [debug] [MainThread]: On master: COMMIT
[0m14:55:49.287806 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:49.288806 [debug] [MainThread]: On master: Close
[0m14:55:49.292806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:49.293806 [debug] [MainThread]: Connection 'create_AIRBNB_dev' was properly closed.
[0m14:55:49.294807 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m14:55:49.295807 [debug] [MainThread]: Connection 'model.learn_duckdb.fct_reviews' was properly closed.
[0m14:55:49.296811 [info ] [MainThread]: 
[0m14:55:49.297808 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m14:55:49.300808 [debug] [MainThread]: Command end result
[0m14:55:49.318810 [info ] [MainThread]: 
[0m14:55:49.319810 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:55:49.321809 [info ] [MainThread]: 
[0m14:55:49.322809 [error] [MainThread]:   Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m14:55:49.324811 [info ] [MainThread]: 
[0m14:55:49.326813 [error] [MainThread]:   Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m14:55:49.328815 [info ] [MainThread]: 
[0m14:55:49.329811 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Binder Error: No function matches the given name and argument types 'replace(VARCHAR, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	replace(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR
  
  LINE 40:     REPLACE(
               ^
[0m14:55:49.332813 [info ] [MainThread]: 
[0m14:55:49.333813 [error] [MainThread]:   Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m14:55:49.334814 [info ] [MainThread]: 
[0m14:55:49.335812 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=11 TOTAL=16
[0m14:55:49.339811 [debug] [MainThread]: Command `dbt build` failed at 14:55:49.339811 after 1.84 seconds
[0m14:55:49.340814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181EA2A7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181EA4F5A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181EA4F58D0>]}
[0m14:55:49.342811 [debug] [MainThread]: Flushing usage events
[0m14:56:31.585720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FA201410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FA201590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FA2012D0>]}


============================== 14:56:31.590721 | 507e5ad8-81c3-4d65-a7b6-488e85ff3ad2 ==============================
[0m14:56:31.590721 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:56:31.592723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:56:31.772757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '507e5ad8-81c3-4d65-a7b6-488e85ff3ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FA271BD0>]}
[0m14:56:31.980755 [debug] [MainThread]: Command `dbt clean` succeeded at 14:56:31.980755 after 0.46 seconds
[0m14:56:31.981755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F3687CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FA1F3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F3965F90>]}
[0m14:56:31.983755 [debug] [MainThread]: Flushing usage events
[0m14:56:39.299511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC5A63F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC5A63F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC5A9E1190>]}


============================== 14:56:39.304512 | 4475671d-507b-4652-b988-e94e2d9e88a1 ==============================
[0m14:56:39.304512 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:56:39.305506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m14:56:39.632537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4475671d-507b-4652-b988-e94e2d9e88a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC5A9E31D0>]}
[0m14:56:39.725544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4475671d-507b-4652-b988-e94e2d9e88a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC5AB13610>]}
[0m14:56:39.727526 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:56:39.729546 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:56:39.732547 [debug] [MainThread]: Command `dbt build` failed at 14:56:39.731526 after 0.50 seconds
[0m14:56:39.732547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC53F77CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC541C4D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC541C5A50>]}
[0m14:56:39.734527 [debug] [MainThread]: Flushing usage events
[0m14:56:51.471466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EACF1EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EAC9DDF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EACF11890>]}


============================== 14:56:51.476467 | e40134e4-569d-46bf-92bf-1b7b979fcd8f ==============================
[0m14:56:51.476467 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:56:51.478467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:56:51.660501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e40134e4-569d-46bf-92bf-1b7b979fcd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EACF1FF10>]}
[0m14:56:51.667482 [debug] [MainThread]: Set downloads directory='C:\Users\Use\AppData\Local\Temp\dbt-downloads-jtw7wc9i'
[0m14:56:51.667482 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:56:51.995528 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:56:51.997528 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:56:52.580557 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:56:52.587556 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:56:54.893745 [info ] [MainThread]: Installed from version 1.1.1
[0m14:56:54.895745 [info ] [MainThread]: Up to date!
[0m14:56:54.897745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e40134e4-569d-46bf-92bf-1b7b979fcd8f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EACFBCBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EACF18650>]}
[0m14:56:54.904746 [debug] [MainThread]: Command `dbt deps` succeeded at 14:56:54.904746 after 3.51 seconds
[0m14:56:54.905746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EA63B7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EA6695F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EA6604D10>]}
[0m14:56:54.907746 [debug] [MainThread]: Flushing usage events
[0m14:57:02.601413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3A661D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3A58950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3A59490>]}


============================== 14:57:02.606398 | 01e7f661-df6a-45b6-bddc-ff7b14120b00 ==============================
[0m14:57:02.606398 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:57:02.608398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:57:02.938424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3AA8110>]}
[0m14:57:03.033452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3CF4190>]}
[0m14:57:03.036433 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m14:57:03.053454 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:57:03.055435 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:57:03.057436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3CCD750>]}
[0m14:57:05.154833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE42F1210>]}
[0m14:57:05.178858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE54BBAD0>]}
[0m14:57:05.180857 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m14:57:05.184859 [info ] [MainThread]: 
[0m14:57:05.186858 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:57:05.188843 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m14:57:05.203844 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m14:57:05.204840 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m14:57:05.205841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:05.219842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.222845 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:57:05.231843 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m14:57:05.232847 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m14:57:05.233842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:05.245844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.247844 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:57:05.252844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m14:57:05.253844 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m14:57:05.263843 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:57:05.264843 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m14:57:05.265843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:05.275845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.277845 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:57:05.278887 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m14:57:05.280846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.281846 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:57:05.283847 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m14:57:05.284846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.285846 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m14:57:05.286846 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m14:57:05.287846 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m14:57:05.288846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.289846 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m14:57:05.294847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m14:57:05.295847 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m14:57:05.299847 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:57:05.300847 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m14:57:05.301849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:05.311847 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.313848 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:57:05.314848 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m14:57:05.315850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.316850 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:57:05.317849 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m14:57:05.318851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.319851 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m14:57:05.320851 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m14:57:05.321851 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m14:57:05.322855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.323849 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m14:57:05.328849 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m14:57:05.335851 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m14:57:05.336852 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m14:57:05.337853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:05.345850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.346850 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m14:57:05.347851 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m14:57:05.382874 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.384874 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m14:57:05.386869 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m14:57:05.386869 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m14:57:05.392874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m14:57:05.395875 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m14:57:05.396860 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m14:57:05.396860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:05.405872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.406859 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m14:57:05.407860 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m14:57:05.441879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:57:05.444879 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m14:57:05.445864 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m14:57:05.446864 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m14:57:05.450879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE4361990>]}
[0m14:57:05.450879 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:05.451879 [debug] [MainThread]: On master: BEGIN
[0m14:57:05.452864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:05.461881 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:05.462881 [debug] [MainThread]: On master: COMMIT
[0m14:57:05.463881 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:05.464861 [debug] [MainThread]: On master: COMMIT
[0m14:57:05.465863 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:05.466881 [debug] [MainThread]: On master: Close
[0m14:57:05.468864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:05.470882 [info ] [MainThread]: 
[0m14:57:05.474869 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m14:57:05.476862 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m14:57:05.477864 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m14:57:05.488878 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m14:57:05.492864 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 14:57:05.478883 => 14:57:05.491864
[0m14:57:05.495867 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m14:57:05.496869 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m14:57:05.498886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m14:57:05.498886 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m14:57:05.504885 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m14:57:05.506864 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 14:57:05.499864 => 14:57:05.505885
[0m14:57:05.508865 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m14:57:05.509865 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m14:57:05.510865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m14:57:05.511865 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m14:57:05.516886 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m14:57:05.518864 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 14:57:05.512866 => 14:57:05.518864
[0m14:57:05.520865 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m14:57:05.521887 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m14:57:05.522865 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m14:57:05.525865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m14:57:05.526866 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m14:57:05.527866 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 14:57:05.527866 => 14:57:05.527866
[0m14:57:05.528866 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m14:57:05.570890 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m14:57:05.571890 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m14:57:05.572870 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:05.581872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:05.582872 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m14:57:05.583873 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m14:57:05.585872 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 14:57:05.529867 => 14:57:05.585872
[0m14:57:05.586872 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: ROLLBACK
[0m14:57:05.596873 [debug] [Thread-1 (]: Failed to rollback 'seed.learn_duckdb.seed_full_moon_dates'
[0m14:57:05.597873 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m14:57:05.604892 [debug] [Thread-1 (]: Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m14:57:05.605892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3B9CDD0>]}
[0m14:57:05.606872 [error] [Thread-1 (]: 1 of 16 ERROR loading seed file main.seed_full_moon_dates ...................... [[31mERROR[0m in 0.08s]
[0m14:57:05.608873 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m14:57:05.609873 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m14:57:05.610873 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m14:57:05.611878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m14:57:05.612878 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m14:57:05.619876 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 14:57:05.612878 => 14:57:05.618875
[0m14:57:05.620876 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m14:57:05.676878 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m14:57:05.679879 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m14:57:05.681883 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m14:57:05.681883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:05.690880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:05.691881 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m14:57:05.692878 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m14:57:05.696882 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 14:57:05.621875 => 14:57:05.695882
[0m14:57:05.696882 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: ROLLBACK
[0m14:57:05.700880 [debug] [Thread-1 (]: Failed to rollback 'snapshot.learn_duckdb.scd_raw_listings'
[0m14:57:05.701880 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m14:57:05.707882 [debug] [Thread-1 (]: Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m14:57:05.708881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE43DF490>]}
[0m14:57:05.710882 [error] [Thread-1 (]: 2 of 16 ERROR snapshotting dev.scd_raw_listings ................................ [[31mERROR[0m in 0.10s]
[0m14:57:05.711881 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m14:57:05.712881 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m14:57:05.713881 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m14:57:05.714881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m14:57:05.715903 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m14:57:05.723884 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m14:57:05.726881 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 14:57:05.716902 => 14:57:05.726881
[0m14:57:05.728882 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m14:57:05.763885 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m14:57:05.767889 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:57:05.769891 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m14:57:05.771889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:05.781886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:05.782886 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:57:05.783888 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m14:57:05.785889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:05.794889 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m14:57:05.795889 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m14:57:05.798892 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 14:57:05.728882 => 14:57:05.797889
[0m14:57:05.799891 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m14:57:05.818887 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m14:57:05.819888 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m14:57:05.827891 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m14:57:05.828891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE551E110>]}
[0m14:57:05.830891 [error] [Thread-1 (]: 3 of 16 ERROR creating sql view model main.dim_hosts_cleansed .................. [[31mERROR[0m in 0.11s]
[0m14:57:05.831891 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m14:57:05.832892 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m14:57:05.833891 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m14:57:05.835891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m14:57:05.837894 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m14:57:05.850894 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m14:57:05.853893 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 14:57:05.837894 => 14:57:05.852895
[0m14:57:05.854894 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m14:57:05.864895 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m14:57:05.867895 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m14:57:05.869896 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m14:57:05.870895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:05.880895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:05.881895 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m14:57:05.882895 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str, '$'
    ) :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m14:57:05.885896 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 14:57:05.855894 => 14:57:05.885896
[0m14:57:05.886896 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m14:57:05.891896 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m14:57:05.892896 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m14:57:05.898897 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Binder Error: No function matches the given name and argument types 'replace(VARCHAR, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	replace(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR
  
  LINE 40:     REPLACE(
               ^
[0m14:57:05.899897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE56320D0>]}
[0m14:57:05.901898 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.07s]
[0m14:57:05.903897 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m14:57:05.904897 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m14:57:05.905897 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m14:57:05.908898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m14:57:05.909898 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m14:57:05.929899 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m14:57:05.933899 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 14:57:05.910897 => 14:57:05.932899
[0m14:57:05.934899 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m14:57:05.983905 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m14:57:05.986903 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m14:57:05.988903 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m14:57:05.989903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:06.001906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:57:06.002906 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m14:57:06.004904 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m14:57:06.006905 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 14:57:05.935900 => 14:57:06.006905
[0m14:57:06.007909 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: ROLLBACK
[0m14:57:06.012905 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.fct_reviews'
[0m14:57:06.013905 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m14:57:06.018906 [debug] [Thread-1 (]: Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m14:57:06.019906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01e7f661-df6a-45b6-bddc-ff7b14120b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3ACD9D0>]}
[0m14:57:06.021908 [error] [Thread-1 (]: 5 of 16 ERROR creating sql incremental model main.fct_reviews .................. [[31mERROR[0m in 0.11s]
[0m14:57:06.023908 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m14:57:06.024906 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:57:06.025906 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m14:57:06.027910 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:57:06.028907 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m14:57:06.030907 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m14:57:06.031910 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m14:57:06.033908 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m14:57:06.034907 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m14:57:06.035908 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m14:57:06.036908 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:57:06.038908 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m14:57:06.039908 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:57:06.041909 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:57:06.042909 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m14:57:06.044909 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:57:06.046929 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:57:06.047929 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m14:57:06.049911 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:57:06.050929 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:57:06.051908 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m14:57:06.052909 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:57:06.053913 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:57:06.054910 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m14:57:06.056911 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:57:06.058911 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m14:57:06.059913 [info ] [Thread-1 (]: 14 of 16 SKIP relation main.mart_fullmoon_reviews .............................. [[33mSKIP[0m]
[0m14:57:06.061911 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m14:57:06.062911 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m14:57:06.063912 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m14:57:06.066934 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m14:57:06.067910 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m14:57:06.068910 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m14:57:06.069910 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m14:57:06.071911 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:06.072931 [debug] [MainThread]: On master: BEGIN
[0m14:57:06.074911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:06.083931 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:06.084933 [debug] [MainThread]: On master: COMMIT
[0m14:57:06.085932 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:06.086932 [debug] [MainThread]: On master: COMMIT
[0m14:57:06.087932 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:57:06.088933 [debug] [MainThread]: On master: Close
[0m14:57:06.092934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:06.093933 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m14:57:06.094933 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m14:57:06.095933 [debug] [MainThread]: Connection 'model.learn_duckdb.fct_reviews' was properly closed.
[0m14:57:06.097914 [info ] [MainThread]: 
[0m14:57:06.098915 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m14:57:06.101913 [debug] [MainThread]: Command end result
[0m14:57:06.119915 [info ] [MainThread]: 
[0m14:57:06.121917 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m14:57:06.122934 [info ] [MainThread]: 
[0m14:57:06.124916 [error] [MainThread]:   Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m14:57:06.126916 [info ] [MainThread]: 
[0m14:57:06.127916 [error] [MainThread]:   Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m14:57:06.128915 [info ] [MainThread]: 
[0m14:57:06.129919 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m14:57:06.131918 [info ] [MainThread]: 
[0m14:57:06.132918 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Binder Error: No function matches the given name and argument types 'replace(VARCHAR, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	replace(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR
  
  LINE 40:     REPLACE(
               ^
[0m14:57:06.134919 [info ] [MainThread]: 
[0m14:57:06.135917 [error] [MainThread]:   Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m14:57:06.136918 [info ] [MainThread]: 
[0m14:57:06.137916 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=11 TOTAL=16
[0m14:57:06.140916 [debug] [MainThread]: Command `dbt build` failed at 14:57:06.140916 after 3.61 seconds
[0m14:57:06.141922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDCFB7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE15B1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDD205A50>]}
[0m14:57:06.142922 [debug] [MainThread]: Flushing usage events
[0m15:00:48.444598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5B224D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5B82D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5B81F90>]}


============================== 15:00:48.450600 | 3cc817c1-04da-4280-8566-8637031d8396 ==============================
[0m15:00:48.450600 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:00:48.452172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:00:48.763212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cc817c1-04da-4280-8566-8637031d8396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5CD6390>]}
[0m15:00:48.855220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cc817c1-04da-4280-8566-8637031d8396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5C50F10>]}
[0m15:00:48.858204 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m15:00:48.873206 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:00:49.090845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:49.091846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:49.100861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cc817c1-04da-4280-8566-8637031d8396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5BA2A10>]}
[0m15:00:49.121849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cc817c1-04da-4280-8566-8637031d8396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5E63C90>]}
[0m15:00:49.122847 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m15:00:49.125880 [info ] [MainThread]: 
[0m15:00:49.127864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:00:49.129849 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m15:00:49.143851 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m15:00:49.144850 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m15:00:49.145851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:49.228255 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m15:00:49.228255 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m15:00:49.229256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:49.299263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:49.300262 [debug] [MainThread]: Connection 'list_AIRBNB' was properly closed.
[0m15:00:49.302264 [info ] [MainThread]: 
[0m15:00:49.304264 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m15:00:49.306262 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Use\.julia\juliaup\julia-1.10.2+0.x64.w64.mingw32\bin\julia.exe (PID 12472)
[0m15:00:49.309262 [debug] [MainThread]: Command `dbt build` failed at 15:00:49.309262 after 0.93 seconds
[0m15:00:49.311262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCF047CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5F6DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5E12E50>]}
[0m15:00:49.312263 [debug] [MainThread]: Flushing usage events
[0m15:01:10.048600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAD9D6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAD9C7210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAD9C5210>]}


============================== 15:01:10.053600 | 343d60c8-bf6b-468b-a73c-987ea2763025 ==============================
[0m15:01:10.053600 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:01:10.055602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:10.363636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '343d60c8-bf6b-468b-a73c-987ea2763025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EADA01950>]}
[0m15:01:10.454668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '343d60c8-bf6b-468b-a73c-987ea2763025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EADA01A50>]}
[0m15:01:10.457669 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m15:01:10.473655 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:01:10.698692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:10.699688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:10.706688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '343d60c8-bf6b-468b-a73c-987ea2763025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EADA3C7D0>]}
[0m15:01:10.726682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '343d60c8-bf6b-468b-a73c-987ea2763025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EADCC3D50>]}
[0m15:01:10.727683 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m15:01:10.732677 [info ] [MainThread]: 
[0m15:01:10.734678 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:01:10.737677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m15:01:10.753697 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m15:01:10.754682 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m15:01:10.754682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:10.837818 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m15:01:10.838819 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m15:01:10.838819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:10.909172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:10.910187 [debug] [MainThread]: Connection 'list_AIRBNB' was properly closed.
[0m15:01:10.911192 [info ] [MainThread]: 
[0m15:01:10.912172 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m15:01:10.913172 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Use\.julia\juliaup\julia-1.10.2+0.x64.w64.mingw32\bin\julia.exe (PID 12472)
[0m15:01:10.916194 [debug] [MainThread]: Command `dbt build` failed at 15:01:10.916194 after 0.94 seconds
[0m15:01:10.917173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAD9C7210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EA6F47CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EAD9E3690>]}
[0m15:01:10.918193 [debug] [MainThread]: Flushing usage events
[0m15:01:39.341437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05AF2DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05AF61F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05AF62A10>]}


============================== 15:01:39.347456 | 1e9f13cb-7589-497a-a56d-e700da43ad15 ==============================
[0m15:01:39.347456 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:01:39.349438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:01:39.687482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B0B6790>]}
[0m15:01:39.787468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B031490>]}
[0m15:01:39.790471 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m15:01:39.808474 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:01:40.055491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:40.056491 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:40.065492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B2F0FD0>]}
[0m15:01:40.087493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B243DD0>]}
[0m15:01:40.089495 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m15:01:40.093495 [info ] [MainThread]: 
[0m15:01:40.096496 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:01:40.099497 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m15:01:40.123495 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m15:01:40.124494 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m15:01:40.126497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:40.139499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.142499 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:01:40.151499 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m15:01:40.152498 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m15:01:40.153499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:40.165500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.168500 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:01:40.173501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m15:01:40.174499 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m15:01:40.184500 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m15:01:40.185500 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m15:01:40.186502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:40.197507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.199502 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m15:01:40.200504 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m15:01:40.201503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.202503 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m15:01:40.203503 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m15:01:40.204503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.205503 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m15:01:40.206503 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m15:01:40.207503 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m15:01:40.208503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.209503 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m15:01:40.213503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_main, now create_AIRBNB_dev)
[0m15:01:40.214503 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m15:01:40.218504 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m15:01:40.219504 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m15:01:40.219504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:40.229505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.233506 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m15:01:40.234504 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m15:01:40.235505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.236505 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m15:01:40.237506 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m15:01:40.238505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.239506 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m15:01:40.240506 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m15:01:40.241506 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m15:01:40.242506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.243506 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m15:01:40.249508 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m15:01:40.257509 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m15:01:40.257509 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m15:01:40.258508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:40.267509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.267509 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m15:01:40.268510 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m15:01:40.304508 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.306512 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m15:01:40.308512 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m15:01:40.309511 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m15:01:40.314511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m15:01:40.317511 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m15:01:40.318513 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m15:01:40.319512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:40.327513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.328513 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m15:01:40.329513 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m15:01:40.366519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:40.368538 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m15:01:40.369538 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m15:01:40.370517 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m15:01:40.374538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B0D8FD0>]}
[0m15:01:40.375521 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:40.376517 [debug] [MainThread]: On master: BEGIN
[0m15:01:40.376517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:40.384521 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:01:40.385522 [debug] [MainThread]: On master: COMMIT
[0m15:01:40.386518 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:40.387518 [debug] [MainThread]: On master: COMMIT
[0m15:01:40.388520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:01:40.389518 [debug] [MainThread]: On master: Close
[0m15:01:40.392518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:40.394540 [info ] [MainThread]: 
[0m15:01:40.399541 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m15:01:40.400518 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m15:01:40.401518 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m15:01:40.419518 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m15:01:40.422524 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 15:01:40.402519 => 15:01:40.421524
[0m15:01:40.425525 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m15:01:40.427527 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m15:01:40.429527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m15:01:40.430522 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m15:01:40.435521 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m15:01:40.437526 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 15:01:40.430522 => 15:01:40.436521
[0m15:01:40.440523 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m15:01:40.442523 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m15:01:40.444526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m15:01:40.446527 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m15:01:40.454524 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m15:01:40.456523 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 15:01:40.447527 => 15:01:40.456523
[0m15:01:40.460525 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m15:01:40.461524 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m15:01:40.463525 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m15:01:40.465526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m15:01:40.466523 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m15:01:40.467525 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 15:01:40.467525 => 15:01:40.467525
[0m15:01:40.468526 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m15:01:40.523529 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m15:01:40.524530 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m15:01:40.526529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:40.537529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:40.537529 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m15:01:40.539529 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m15:01:40.540529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:40.565533 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m15:01:40.566533 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'C:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:01:40.579533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:40.590533 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m15:01:40.623536 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m15:01:40.624536 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m15:01:40.626539 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m15:01:40.629539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:40.632539 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 15:01:40.468526 => 15:01:40.632539
[0m15:01:40.634539 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m15:01:40.662540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B5947D0>]}
[0m15:01:40.664541 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file main.seed_full_moon_dates .......................... [[32mINSERT 272[0m in 0.20s]
[0m15:01:40.666542 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m15:01:40.667541 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m15:01:40.669540 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m15:01:40.672541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m15:01:40.673543 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m15:01:40.685543 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 15:01:40.675541 => 15:01:40.684542
[0m15:01:40.686543 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m15:01:40.766547 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m15:01:40.768547 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m15:01:40.769550 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m15:01:40.771548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:40.785549 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:40.786547 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m15:01:40.787551 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m15:01:40.814556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:40.817556 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m15:01:40.818555 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m15:01:40.819558 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m15:01:40.858555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:40.860557 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 15:01:40.687543 => 15:01:40.860557
[0m15:01:40.861557 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m15:01:40.941563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B58AD90>]}
[0m15:01:40.942565 [info ] [Thread-1 (]: 2 of 16 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.27s]
[0m15:01:40.944563 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m15:01:40.946562 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m15:01:40.947562 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m15:01:40.949565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m15:01:40.951562 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m15:01:40.961564 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m15:01:40.964566 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 15:01:40.952563 => 15:01:40.963563
[0m15:01:40.965567 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m15:01:41.015566 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m15:01:41.017568 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m15:01:41.018571 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m15:01:41.019568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:41.034571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:41.035572 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m15:01:41.036572 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m15:01:41.038571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:41.046569 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m15:01:41.047570 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m15:01:41.050570 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 15:01:40.966566 => 15:01:41.049571
[0m15:01:41.051569 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m15:01:41.066570 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m15:01:41.067572 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m15:01:41.074571 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m15:01:41.075571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B1F3E50>]}
[0m15:01:41.076575 [error] [Thread-1 (]: 3 of 16 ERROR creating sql view model main.dim_hosts_cleansed .................. [[31mERROR[0m in 0.13s]
[0m15:01:41.078577 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m15:01:41.079576 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m15:01:41.080579 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m15:01:41.082579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m15:01:41.083575 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m15:01:41.100576 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m15:01:41.103576 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 15:01:41.083575 => 15:01:41.102575
[0m15:01:41.105577 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m15:01:41.122578 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m15:01:41.125579 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m15:01:41.127579 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m15:01:41.131580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:41.150581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:41.151581 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m15:01:41.153582 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str, '$'
    ) :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m15:01:41.158582 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 15:01:41.107576 => 15:01:41.157586
[0m15:01:41.160587 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m15:01:41.167584 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m15:01:41.169582 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m15:01:41.179583 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Binder Error: No function matches the given name and argument types 'replace(VARCHAR, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	replace(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR
  
  LINE 40:     REPLACE(
               ^
[0m15:01:41.181583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B5E8F10>]}
[0m15:01:41.183583 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.10s]
[0m15:01:41.186587 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m15:01:41.189585 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m15:01:41.191586 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m15:01:41.194585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m15:01:41.196585 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m15:01:41.284591 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m15:01:41.287592 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 15:01:41.197586 => 15:01:41.287592
[0m15:01:41.289592 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m15:01:41.385599 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m15:01:41.388600 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m15:01:41.390600 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m15:01:41.391600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:41.405601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:41.407602 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m15:01:41.408601 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m15:01:42.662702 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:01:42.667704 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m15:01:42.669706 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m15:01:42.670704 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m15:01:43.046738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:43.048732 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 15:01:41.290592 => 15:01:43.047734
[0m15:01:43.049734 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m15:01:43.086736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05D60F550>]}
[0m15:01:43.087738 [info ] [Thread-1 (]: 5 of 16 OK created sql incremental model main.fct_reviews ...................... [[32mOK[0m in 1.89s]
[0m15:01:43.089736 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m15:01:43.090736 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:01:43.091736 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m15:01:43.093737 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:01:43.094736 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m15:01:43.095738 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m15:01:43.097737 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m15:01:43.099737 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m15:01:43.100739 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m15:01:43.102737 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m15:01:43.104739 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:01:43.106740 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m15:01:43.108739 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:01:43.109741 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:01:43.111739 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m15:01:43.113742 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:01:43.114740 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:01:43.116739 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m15:01:43.118740 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:01:43.119739 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:01:43.121741 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m15:01:43.124740 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:01:43.125741 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:01:43.126740 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m15:01:43.128741 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:01:43.129741 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m15:01:43.130740 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_fullmoon_reviews ...................... [RUN]
[0m15:01:43.133742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.fct_reviews, now model.learn_duckdb.mart_fullmoon_reviews)
[0m15:01:43.134740 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m15:01:43.141742 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m15:01:43.144743 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 15:01:43.135742 => 15:01:43.143741
[0m15:01:43.146742 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m15:01:43.173744 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m15:01:43.177744 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m15:01:43.179745 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m15:01:43.181747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:43.202748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:43.202748 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m15:01:43.204749 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
    );
  
  
[0m15:01:43.215749 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 15:01:43.147742 => 15:01:43.214748
[0m15:01:43.217749 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m15:01:43.225749 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m15:01:43.226750 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m15:01:43.239752 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m15:01:43.240750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9f13cb-7589-497a-a56d-e700da43ad15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B50AAD0>]}
[0m15:01:43.242749 [error] [Thread-1 (]: 14 of 16 ERROR creating sql table model main.mart_fullmoon_reviews ............. [[31mERROR[0m in 0.11s]
[0m15:01:43.245752 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m15:01:43.247756 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m15:01:43.249752 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m15:01:43.251751 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m15:01:43.253752 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m15:01:43.255753 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m15:01:43.257753 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m15:01:43.263753 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:43.265753 [debug] [MainThread]: On master: BEGIN
[0m15:01:43.267752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:43.285753 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:01:43.286755 [debug] [MainThread]: On master: COMMIT
[0m15:01:43.288753 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:43.290754 [debug] [MainThread]: On master: COMMIT
[0m15:01:43.292756 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:01:43.293753 [debug] [MainThread]: On master: Close
[0m15:01:43.301754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:43.303754 [debug] [MainThread]: Connection 'create_AIRBNB_dev' was properly closed.
[0m15:01:43.306754 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m15:01:43.307756 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m15:01:43.309756 [info ] [MainThread]: 
[0m15:01:43.313756 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m15:01:43.320755 [debug] [MainThread]: Command end result
[0m15:01:43.367760 [info ] [MainThread]: 
[0m15:01:43.369760 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:01:43.370762 [info ] [MainThread]: 
[0m15:01:43.372760 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m15:01:43.374762 [info ] [MainThread]: 
[0m15:01:43.375762 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Binder Error: No function matches the given name and argument types 'replace(VARCHAR, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	replace(VARCHAR, VARCHAR, VARCHAR) -> VARCHAR
  
  LINE 40:     REPLACE(
               ^
[0m15:01:43.377760 [info ] [MainThread]: 
[0m15:01:43.381762 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m15:01:43.384762 [info ] [MainThread]: 
[0m15:01:43.389761 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=10 TOTAL=16
[0m15:01:43.399763 [debug] [MainThread]: Command `dbt build` failed at 15:01:43.398763 after 4.13 seconds
[0m15:01:43.403762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0544C7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05AA1E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05B0D9CD0>]}
[0m15:01:43.408764 [debug] [MainThread]: Flushing usage events
[0m15:06:59.105623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E70E3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E712FC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E712E050>]}


============================== 15:06:59.111624 | 95266577-c6d6-4220-b498-61a73568a0df ==============================
[0m15:06:59.111624 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:06:59.112624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:59.554651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E71F7190>]}
[0m15:06:59.659219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E7100450>]}
[0m15:06:59.662219 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m15:06:59.686220 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:06:59.938234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:59.939233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:59.947234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E737DA10>]}
[0m15:06:59.969236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E7413C90>]}
[0m15:06:59.970237 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m15:06:59.975238 [info ] [MainThread]: 
[0m15:06:59.977238 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:06:59.980257 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m15:06:59.995242 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m15:06:59.997239 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m15:06:59.998239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:00.013240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.015260 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:07:00.027240 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m15:07:00.028240 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m15:07:00.030241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:00.042242 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.044241 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:07:00.049242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m15:07:00.051240 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m15:07:00.062242 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m15:07:00.062242 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m15:07:00.064243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:00.081247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.084247 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m15:07:00.085243 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m15:07:00.086245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.088244 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m15:07:00.089244 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m15:07:00.090244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.092244 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m15:07:00.093243 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m15:07:00.094244 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m15:07:00.095244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.096244 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m15:07:00.101244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m15:07:00.103243 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m15:07:00.107244 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m15:07:00.109244 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m15:07:00.110245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:00.120244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.123243 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m15:07:00.124243 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m15:07:00.125245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.126245 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m15:07:00.127246 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m15:07:00.128245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.130245 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m15:07:00.131245 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m15:07:00.132245 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m15:07:00.133246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.134246 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m15:07:00.139245 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m15:07:00.150248 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m15:07:00.152248 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m15:07:00.152248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:00.163248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.164248 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m15:07:00.165249 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m15:07:00.213250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.215250 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m15:07:00.217250 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m15:07:00.217250 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m15:07:00.222250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m15:07:00.225249 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m15:07:00.225249 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m15:07:00.226251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:00.235251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.235251 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m15:07:00.236250 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m15:07:00.274253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:00.276254 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m15:07:00.277254 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m15:07:00.277254 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m15:07:00.281253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E7307410>]}
[0m15:07:00.282254 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:00.283255 [debug] [MainThread]: On master: BEGIN
[0m15:07:00.283255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:00.292254 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:00.293255 [debug] [MainThread]: On master: COMMIT
[0m15:07:00.294259 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:00.295263 [debug] [MainThread]: On master: COMMIT
[0m15:07:00.296255 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:00.296255 [debug] [MainThread]: On master: Close
[0m15:07:00.299254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:00.300264 [info ] [MainThread]: 
[0m15:07:00.305264 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m15:07:00.307255 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m15:07:00.308255 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m15:07:00.318257 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m15:07:00.320256 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 15:07:00.309264 => 15:07:00.320256
[0m15:07:00.322260 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m15:07:00.323257 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m15:07:00.324257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m15:07:00.325257 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m15:07:00.332255 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m15:07:00.333255 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 15:07:00.326259 => 15:07:00.333255
[0m15:07:00.335259 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m15:07:00.336258 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m15:07:00.338258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m15:07:00.339257 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m15:07:00.343256 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m15:07:00.346260 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 15:07:00.340258 => 15:07:00.345260
[0m15:07:00.347260 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m15:07:00.348260 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m15:07:00.349260 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m15:07:00.351258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m15:07:00.352259 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m15:07:00.353259 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 15:07:00.352259 => 15:07:00.352259
[0m15:07:00.353259 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m15:07:00.393260 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m15:07:00.394281 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m15:07:00.394281 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:00.403276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:00.404277 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m15:07:00.405262 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m15:07:00.407261 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 15:07:00.354259 => 15:07:00.407261
[0m15:07:00.408275 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: ROLLBACK
[0m15:07:00.419278 [debug] [Thread-1 (]: Failed to rollback 'seed.learn_duckdb.seed_full_moon_dates'
[0m15:07:00.420278 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m15:07:00.427278 [debug] [Thread-1 (]: Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m15:07:00.428278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E7505610>]}
[0m15:07:00.429263 [error] [Thread-1 (]: 1 of 16 ERROR loading seed file main.seed_full_moon_dates ...................... [[31mERROR[0m in 0.08s]
[0m15:07:00.432283 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m15:07:00.432283 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m15:07:00.433278 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m15:07:00.435264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m15:07:00.436279 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m15:07:00.443278 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 15:07:00.437264 => 15:07:00.443278
[0m15:07:00.444264 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m15:07:00.500268 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m15:07:00.502267 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m15:07:00.503267 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m15:07:00.504269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:00.515270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:00.516269 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m15:07:00.517269 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m15:07:00.520270 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 15:07:00.444264 => 15:07:00.520270
[0m15:07:00.521269 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: ROLLBACK
[0m15:07:00.526270 [debug] [Thread-1 (]: Failed to rollback 'snapshot.learn_duckdb.scd_raw_listings'
[0m15:07:00.527268 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m15:07:00.533267 [debug] [Thread-1 (]: Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m15:07:00.535269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E6D3F290>]}
[0m15:07:00.536271 [error] [Thread-1 (]: 2 of 16 ERROR snapshotting dev.scd_raw_listings ................................ [[31mERROR[0m in 0.10s]
[0m15:07:00.537269 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m15:07:00.538269 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m15:07:00.540269 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m15:07:00.541270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m15:07:00.543272 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m15:07:00.558272 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m15:07:00.560271 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 15:07:00.544270 => 15:07:00.559270
[0m15:07:00.562272 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m15:07:00.622275 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m15:07:00.624273 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m15:07:00.626276 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m15:07:00.627275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:00.635274 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:00.636274 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m15:07:00.637273 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m15:07:00.639277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:00.649275 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m15:07:00.650276 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m15:07:00.653824 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 15:07:00.563272 => 15:07:00.653318
[0m15:07:00.654831 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m15:07:00.662833 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m15:07:00.663833 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m15:07:00.671831 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m15:07:00.672831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E712E250>]}
[0m15:07:00.673831 [error] [Thread-1 (]: 3 of 16 ERROR creating sql view model main.dim_hosts_cleansed .................. [[31mERROR[0m in 0.13s]
[0m15:07:00.675831 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m15:07:00.676832 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m15:07:00.677832 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m15:07:00.679833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m15:07:00.680833 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m15:07:00.691833 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m15:07:00.694833 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 15:07:00.681833 => 15:07:00.693835
[0m15:07:00.697834 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m15:07:00.707835 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m15:07:00.709835 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m15:07:00.710835 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m15:07:00.711835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:00.722836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:00.723837 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m15:07:00.725835 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(
        REPLACE(
            price_str, '$'
        ),
        DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m15:07:00.728834 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 15:07:00.698836 => 15:07:00.727834
[0m15:07:00.729836 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m15:07:00.733836 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m15:07:00.733836 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m15:07:00.740836 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m15:07:00.741834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E744DD10>]}
[0m15:07:00.743836 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.06s]
[0m15:07:00.744837 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m15:07:00.745836 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m15:07:00.746837 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m15:07:00.748837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m15:07:00.750836 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m15:07:00.783836 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m15:07:00.785838 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 15:07:00.751837 => 15:07:00.784836
[0m15:07:00.785838 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m15:07:00.825839 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m15:07:00.827851 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m15:07:00.828842 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m15:07:00.828842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:00.837842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:00.838851 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m15:07:00.839842 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m15:07:00.843863 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 15:07:00.786839 => 15:07:00.843863
[0m15:07:00.844861 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: ROLLBACK
[0m15:07:00.850863 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.fct_reviews'
[0m15:07:00.851863 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m15:07:00.857863 [debug] [Thread-1 (]: Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m15:07:00.858863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95266577-c6d6-4220-b498-61a73568a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E7312590>]}
[0m15:07:00.859863 [error] [Thread-1 (]: 5 of 16 ERROR creating sql incremental model main.fct_reviews .................. [[31mERROR[0m in 0.11s]
[0m15:07:00.861843 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m15:07:00.862865 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:07:00.863848 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m15:07:00.864847 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:07:00.865847 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m15:07:00.866847 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m15:07:00.867849 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m15:07:00.868844 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m15:07:00.869844 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m15:07:00.870845 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m15:07:00.871844 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:07:00.872844 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m15:07:00.874854 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:07:00.875846 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:07:00.877854 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m15:07:00.878845 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:07:00.879866 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:07:00.880865 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m15:07:00.881845 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:07:00.882865 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:07:00.883865 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m15:07:00.884844 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:07:00.885844 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:07:00.886845 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m15:07:00.887848 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:07:00.888845 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m15:07:00.889846 [info ] [Thread-1 (]: 14 of 16 SKIP relation main.mart_fullmoon_reviews .............................. [[33mSKIP[0m]
[0m15:07:00.891851 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m15:07:00.892850 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m15:07:00.893848 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m15:07:00.894847 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m15:07:00.895848 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m15:07:00.896847 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m15:07:00.898852 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m15:07:00.901851 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:00.902852 [debug] [MainThread]: On master: BEGIN
[0m15:07:00.902852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:00.915848 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:00.916853 [debug] [MainThread]: On master: COMMIT
[0m15:07:00.917847 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:00.918848 [debug] [MainThread]: On master: COMMIT
[0m15:07:00.920846 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:00.920846 [debug] [MainThread]: On master: Close
[0m15:07:00.925868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:00.925868 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m15:07:00.926868 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m15:07:00.927848 [debug] [MainThread]: Connection 'model.learn_duckdb.fct_reviews' was properly closed.
[0m15:07:00.928847 [info ] [MainThread]: 
[0m15:07:00.929846 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m15:07:00.932847 [debug] [MainThread]: Command end result
[0m15:07:00.952848 [info ] [MainThread]: 
[0m15:07:00.953848 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m15:07:00.954850 [info ] [MainThread]: 
[0m15:07:00.957849 [error] [MainThread]:   Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m15:07:00.958851 [info ] [MainThread]: 
[0m15:07:00.960869 [error] [MainThread]:   Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m15:07:00.962849 [info ] [MainThread]: 
[0m15:07:00.963853 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m15:07:00.965851 [info ] [MainThread]: 
[0m15:07:00.966850 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m15:07:00.968853 [info ] [MainThread]: 
[0m15:07:00.969850 [error] [MainThread]:   Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m15:07:00.970850 [info ] [MainThread]: 
[0m15:07:00.972852 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=11 TOTAL=16
[0m15:07:00.976855 [debug] [MainThread]: Command `dbt build` failed at 15:07:00.975854 after 1.94 seconds
[0m15:07:00.976855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E05E7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E0834D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264E0835A50>]}
[0m15:07:00.978851 [debug] [MainThread]: Flushing usage events
[0m18:10:13.702850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F0C229D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F073DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F088F290>]}


============================== 18:10:13.709835 | 33d88e95-5271-4ea4-9b5d-14cd219bff3e ==============================
[0m18:10:13.709835 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:10:13.711835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:14.112396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F0C22610>]}
[0m18:10:14.216396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F0C30A90>]}
[0m18:10:14.220400 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:10:14.249398 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:10:14.497399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:14.498398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:14.506399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F10123D0>]}
[0m18:10:14.542399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F0F73E90>]}
[0m18:10:14.543400 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:10:14.548399 [info ] [MainThread]: 
[0m18:10:14.550400 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:14.554401 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:10:14.570402 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:10:14.572399 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:10:14.573399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:14.592399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.595421 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:10:14.603419 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:10:14.604399 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:10:14.605399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:14.615401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.617401 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:10:14.622399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m18:10:14.623420 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m18:10:14.632406 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:10:14.633399 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:10:14.634420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:14.644398 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.646420 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:10:14.647420 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m18:10:14.649400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.650400 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:10:14.651404 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m18:10:14.652403 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.653404 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:10:14.654404 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:10:14.655404 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:10:14.656399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.656399 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m18:10:14.661399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_main, now create_AIRBNB_dev)
[0m18:10:14.662420 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m18:10:14.667404 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:10:14.667404 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:10:14.668404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:14.678399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.681400 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:10:14.683401 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m18:10:14.684400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.686401 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:10:14.687402 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m18:10:14.689402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.691400 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:10:14.692402 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:10:14.693398 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:10:14.694402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.695403 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m18:10:14.704401 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m18:10:14.714401 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:10:14.716402 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m18:10:14.717400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:14.726399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.728401 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:10:14.729400 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m18:10:14.770399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.772399 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m18:10:14.783399 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m18:10:14.784402 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m18:10:14.789401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m18:10:14.793401 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:10:14.794400 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m18:10:14.795401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:14.804399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.804399 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:10:14.805398 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m18:10:14.841956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:14.843959 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m18:10:14.844959 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m18:10:14.845959 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:10:14.849959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F107EE90>]}
[0m18:10:14.850959 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:14.850959 [debug] [MainThread]: On master: BEGIN
[0m18:10:14.851959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:14.859958 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:10:14.860959 [debug] [MainThread]: On master: COMMIT
[0m18:10:14.861959 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:14.862959 [debug] [MainThread]: On master: COMMIT
[0m18:10:14.862959 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:10:14.863959 [info ] [MainThread]: 
[0m18:10:14.864959 [info ] [MainThread]: Running 1 on-run-start hook
[0m18:10:14.886960 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m18:10:14.893960 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m18:10:14.896961 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m18:10:14.897960 [info ] [MainThread]: 
[0m18:10:14.898959 [debug] [MainThread]: On master: Close
[0m18:10:14.902959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:14.903959 [info ] [MainThread]: 
[0m18:10:14.908959 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m18:10:14.909957 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m18:10:14.911959 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m18:10:14.916959 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m18:10:14.918959 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 18:10:14.912960 => 18:10:14.918959
[0m18:10:14.920960 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m18:10:14.921960 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m18:10:14.922961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m18:10:14.923961 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m18:10:14.928961 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m18:10:14.930962 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 18:10:14.924961 => 18:10:14.930962
[0m18:10:14.934963 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m18:10:14.936963 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m18:10:14.938961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m18:10:14.940960 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m18:10:14.946970 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m18:10:14.949960 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 18:10:14.940960 => 18:10:14.948960
[0m18:10:14.951960 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m18:10:14.952960 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m18:10:14.954960 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m18:10:14.956960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m18:10:14.958960 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m18:10:14.960960 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 18:10:14.960960 => 18:10:14.960960
[0m18:10:14.961962 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m18:10:15.009958 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:10:15.011961 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m18:10:15.012960 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:15.022959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.023960 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:10:15.024960 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m18:10:15.025960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.059959 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:10:15.060960 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'c:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:10:15.071961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.081961 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m18:10:15.124962 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:10:15.126961 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:10:15.128960 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:10:15.136961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.138961 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 18:10:14.962960 => 18:10:15.138961
[0m18:10:15.139961 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m18:10:15.154960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F12AE810>]}
[0m18:10:15.156959 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file main.seed_full_moon_dates .......................... [[32mCREATE 272[0m in 0.20s]
[0m18:10:15.158961 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m18:10:15.159962 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m18:10:15.161960 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m18:10:15.164961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m18:10:15.166961 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m18:10:15.177960 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 18:10:15.167961 => 18:10:15.176960
[0m18:10:15.178960 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m18:10:15.242960 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m18:10:15.244960 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:10:15.246961 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m18:10:15.247961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:15.261960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.262960 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:10:15.263961 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m18:10:15.292960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.295960 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:10:15.296960 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:10:15.297960 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:10:15.329962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.332961 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 18:10:15.179960 => 18:10:15.331959
[0m18:10:15.333962 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m18:10:15.398960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F12CB090>]}
[0m18:10:15.400960 [info ] [Thread-1 (]: 2 of 16 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.24s]
[0m18:10:15.402962 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m18:10:15.403960 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m18:10:15.405963 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m18:10:15.408961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m18:10:15.409960 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m18:10:15.425962 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:15.428964 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 18:10:15.410962 => 18:10:15.427961
[0m18:10:15.431961 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m18:10:15.487964 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:15.490962 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:15.491962 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m18:10:15.493960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:15.508961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.509960 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:15.511961 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m18:10:15.513960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.525959 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:15.526960 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:10:15.529963 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 18:10:15.433961 => 18:10:15.529963
[0m18:10:15.530961 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m18:10:15.636960 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m18:10:15.638961 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m18:10:15.649960 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m18:10:15.651965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F1087D90>]}
[0m18:10:15.653962 [error] [Thread-1 (]: 3 of 16 ERROR creating sql view model main.dim_hosts_cleansed .................. [[31mERROR[0m in 0.25s]
[0m18:10:15.656962 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m18:10:15.658963 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m18:10:15.660966 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m18:10:15.665961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m18:10:15.666963 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m18:10:15.700961 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:10:15.705961 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 18:10:15.670965 => 18:10:15.704962
[0m18:10:15.709962 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m18:10:15.735962 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:10:15.739961 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:10:15.741965 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m18:10:15.742963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:15.759962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.760962 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:10:15.763961 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(
        REPLACE(
            price_str, '$'
        ),
        DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m18:10:15.766963 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 18:10:15.710961 => 18:10:15.765963
[0m18:10:15.767964 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m18:10:15.775960 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m18:10:15.778964 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m18:10:15.790962 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:10:15.792961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F331E1D0>]}
[0m18:10:15.795962 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.13s]
[0m18:10:15.798962 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m18:10:15.801961 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m18:10:15.803962 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m18:10:15.806960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m18:10:15.808963 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m18:10:15.866435 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m18:10:15.870435 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 18:10:15.809962 => 18:10:15.868438
[0m18:10:15.873436 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m18:10:15.941438 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m18:10:15.944438 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:10:15.945441 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m18:10:15.947437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:15.963439 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:15.964438 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:10:15.966438 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m18:10:17.065008 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m18:10:17.067006 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:10:17.069008 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:10:17.070007 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:10:17.296007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:17.299009 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 18:10:15.874436 => 18:10:17.298007
[0m18:10:17.300006 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m18:10:17.335008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F0D53E10>]}
[0m18:10:17.336008 [info ] [Thread-1 (]: 5 of 16 OK created sql incremental model main.fct_reviews ...................... [[32mOK[0m in 1.53s]
[0m18:10:17.338008 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m18:10:17.340008 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:10:17.341009 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m18:10:17.343007 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:10:17.345007 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:10:17.347007 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m18:10:17.349008 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:10:17.351008 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:10:17.352008 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m18:10:17.354007 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:10:17.356006 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:10:17.357007 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m18:10:17.359007 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:10:17.361014 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:10:17.362011 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m18:10:17.364009 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:10:17.365009 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:10:17.367009 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m18:10:17.368009 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:10:17.369010 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:10:17.370009 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m18:10:17.372009 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:10:17.373009 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:10:17.374008 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m18:10:17.376008 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:10:17.377007 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:10:17.378007 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_fullmoon_reviews ...................... [RUN]
[0m18:10:17.379007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.fct_reviews, now model.learn_duckdb.mart_fullmoon_reviews)
[0m18:10:17.381007 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m18:10:17.387005 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:10:17.389006 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 18:10:17.382007 => 18:10:17.389006
[0m18:10:17.391008 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m18:10:17.408008 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:10:17.410007 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:10:17.411007 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m18:10:17.412009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:17.427005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:17.428006 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:10:17.429007 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
    );
  
  
[0m18:10:17.436010 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 18:10:17.392007 => 18:10:17.436010
[0m18:10:17.437009 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m18:10:17.441005 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m18:10:17.442005 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m18:10:17.449007 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m18:10:17.450005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d88e95-5271-4ea4-9b5d-14cd219bff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F124EED0>]}
[0m18:10:17.451007 [error] [Thread-1 (]: 14 of 16 ERROR creating sql table model main.mart_fullmoon_reviews ............. [[31mERROR[0m in 0.07s]
[0m18:10:17.453008 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:10:17.454007 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m18:10:17.455007 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m18:10:17.456007 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m18:10:17.457007 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m18:10:17.458007 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m18:10:17.459011 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m18:10:17.462007 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:17.464009 [debug] [MainThread]: On master: BEGIN
[0m18:10:17.465008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:17.474007 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:10:17.475007 [debug] [MainThread]: On master: COMMIT
[0m18:10:17.476007 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:17.477007 [debug] [MainThread]: On master: COMMIT
[0m18:10:17.478007 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:10:17.479007 [debug] [MainThread]: On master: Close
[0m18:10:17.482009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:17.483010 [debug] [MainThread]: Connection 'create_AIRBNB_dev' was properly closed.
[0m18:10:17.484006 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m18:10:17.485009 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m18:10:17.486009 [info ] [MainThread]: 
[0m18:10:17.488007 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models, 1 hook in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m18:10:17.491009 [debug] [MainThread]: Command end result
[0m18:10:17.510008 [info ] [MainThread]: 
[0m18:10:17.512009 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:10:17.513008 [info ] [MainThread]: 
[0m18:10:17.514009 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m18:10:17.516008 [info ] [MainThread]: 
[0m18:10:17.517009 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:10:17.519009 [info ] [MainThread]: 
[0m18:10:17.520009 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m18:10:17.522008 [info ] [MainThread]: 
[0m18:10:17.523009 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=10 TOTAL=16
[0m18:10:17.526009 [debug] [MainThread]: Command `dbt build` failed at 18:10:17.526009 after 3.91 seconds
[0m18:10:17.527009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EA177E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F0C30590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F0C30C10>]}
[0m18:10:17.528009 [debug] [MainThread]: Flushing usage events
[0m18:10:25.586296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151277833D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151277E3E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151277829D0>]}


============================== 18:10:25.591296 | 6a2baad3-48d2-4c08-8cee-488bae4230d0 ==============================
[0m18:10:25.591296 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:10:25.593296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:10:25.913845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151277D80D0>]}
[0m18:10:26.014847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001512778FED0>]}
[0m18:10:26.017850 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:10:26.034849 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:10:26.252846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:26.253846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:26.260845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151277C4C90>]}
[0m18:10:26.281846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015127ABFF50>]}
[0m18:10:26.282847 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:10:26.286846 [info ] [MainThread]: 
[0m18:10:26.287846 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:26.289848 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:10:26.304847 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:10:26.306849 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:10:26.307848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:26.324849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.326847 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:10:26.334844 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:10:26.335845 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:10:26.336846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:26.346847 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.349846 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:10:26.353847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m18:10:26.355847 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m18:10:26.366847 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:10:26.368846 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:10:26.369848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:26.379847 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.381844 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:10:26.382846 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m18:10:26.383848 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.384847 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:10:26.384847 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m18:10:26.385847 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.387846 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:10:26.387846 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:10:26.388846 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:10:26.389846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.390846 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m18:10:26.394846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m18:10:26.395846 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m18:10:26.398846 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:10:26.399846 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:10:26.400845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:26.409850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.411848 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:10:26.412846 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m18:10:26.413847 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.413847 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:10:26.414846 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m18:10:26.415846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.416846 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:10:26.417846 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:10:26.417846 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:10:26.418846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.419846 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m18:10:26.424846 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m18:10:26.434844 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:10:26.435846 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m18:10:26.436846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:26.446844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.447845 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:10:26.449846 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m18:10:26.486845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.488847 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m18:10:26.490846 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m18:10:26.491846 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:10:26.495846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m18:10:26.498846 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:10:26.499846 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m18:10:26.500847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:26.509846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.510846 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:10:26.511847 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m18:10:26.547846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:10:26.549866 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m18:10:26.550846 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m18:10:26.551846 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m18:10:26.555868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015127A0D990>]}
[0m18:10:26.556847 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:26.557848 [debug] [MainThread]: On master: BEGIN
[0m18:10:26.558853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:26.567866 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:10:26.568866 [debug] [MainThread]: On master: COMMIT
[0m18:10:26.569848 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:26.570847 [debug] [MainThread]: On master: COMMIT
[0m18:10:26.571847 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:10:26.572846 [info ] [MainThread]: 
[0m18:10:26.573847 [info ] [MainThread]: Running 1 on-run-start hook
[0m18:10:26.596850 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m18:10:26.604848 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m18:10:26.606847 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m18:10:26.608853 [info ] [MainThread]: 
[0m18:10:26.609848 [debug] [MainThread]: On master: Close
[0m18:10:26.612847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:26.614870 [info ] [MainThread]: 
[0m18:10:26.619847 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m18:10:26.620847 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m18:10:26.622848 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m18:10:26.627847 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m18:10:26.630847 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 18:10:26.623847 => 18:10:26.629847
[0m18:10:26.631847 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m18:10:26.633849 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m18:10:26.634850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m18:10:26.635846 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m18:10:26.640867 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m18:10:26.643848 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 18:10:26.636847 => 18:10:26.642866
[0m18:10:26.645848 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m18:10:26.646849 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m18:10:26.647847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m18:10:26.648846 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m18:10:26.652845 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m18:10:26.654847 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 18:10:26.649847 => 18:10:26.653845
[0m18:10:26.656849 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m18:10:26.658853 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m18:10:26.659847 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m18:10:26.661848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m18:10:26.662847 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m18:10:26.663848 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 18:10:26.662847 => 18:10:26.662847
[0m18:10:26.664847 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m18:10:26.709847 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:10:26.710849 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m18:10:26.711849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:26.721847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:26.722849 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:10:26.723848 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m18:10:26.725847 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 18:10:26.664847 => 18:10:26.725847
[0m18:10:26.726849 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: ROLLBACK
[0m18:10:26.739848 [debug] [Thread-1 (]: Failed to rollback 'seed.learn_duckdb.seed_full_moon_dates'
[0m18:10:26.740848 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m18:10:26.753847 [debug] [Thread-1 (]: Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m18:10:26.754848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015127E1BB10>]}
[0m18:10:26.755848 [error] [Thread-1 (]: 1 of 16 ERROR loading seed file main.seed_full_moon_dates ...................... [[31mERROR[0m in 0.09s]
[0m18:10:26.758849 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m18:10:26.759848 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m18:10:26.761847 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m18:10:26.763849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m18:10:26.764848 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m18:10:26.771848 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 18:10:26.765847 => 18:10:26.771848
[0m18:10:26.773848 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m18:10:26.869846 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m18:10:26.873848 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:10:26.875847 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m18:10:26.876848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:26.889848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:26.890849 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:10:26.891849 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m18:10:26.897847 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 18:10:26.774850 => 18:10:26.896848
[0m18:10:26.898847 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: ROLLBACK
[0m18:10:26.907849 [debug] [Thread-1 (]: Failed to rollback 'snapshot.learn_duckdb.scd_raw_listings'
[0m18:10:26.908849 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m18:10:26.964848 [debug] [Thread-1 (]: Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m18:10:26.966848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015127AA6790>]}
[0m18:10:26.968849 [error] [Thread-1 (]: 2 of 16 ERROR snapshotting dev.scd_raw_listings ................................ [[31mERROR[0m in 0.20s]
[0m18:10:26.970848 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m18:10:26.971847 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m18:10:26.973849 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m18:10:26.976850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m18:10:26.978849 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m18:10:26.993846 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:26.995847 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 18:10:26.980849 => 18:10:26.994845
[0m18:10:26.996849 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m18:10:27.033847 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:27.034847 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:27.035848 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m18:10:27.036847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:27.045847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:27.045847 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:27.046847 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m18:10:27.048848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:27.056847 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:10:27.057847 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:10:27.058848 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 18:10:26.997848 => 18:10:27.058848
[0m18:10:27.059848 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m18:10:27.064846 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m18:10:27.065846 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m18:10:27.072845 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m18:10:27.073847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015127DB3B90>]}
[0m18:10:27.074847 [error] [Thread-1 (]: 3 of 16 ERROR creating sql view model main.dim_hosts_cleansed .................. [[31mERROR[0m in 0.10s]
[0m18:10:27.075848 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m18:10:27.076848 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m18:10:27.077848 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m18:10:27.079848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m18:10:27.080848 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m18:10:27.089846 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:10:27.091847 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 18:10:27.080848 => 18:10:27.090846
[0m18:10:27.092848 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m18:10:27.099849 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:10:27.101850 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:10:27.102850 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m18:10:27.103848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:27.115848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:27.116848 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:10:27.118848 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(
        REPLACE(
            price_str, '$'
        ),
        DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m18:10:27.119848 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 18:10:27.093849 => 18:10:27.119848
[0m18:10:27.120848 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m18:10:27.125849 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m18:10:27.126848 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m18:10:27.132846 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:10:27.133846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015127E245D0>]}
[0m18:10:27.134846 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.05s]
[0m18:10:27.136848 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m18:10:27.137848 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m18:10:27.138847 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m18:10:27.141849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m18:10:27.142849 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m18:10:27.186847 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m18:10:27.189849 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 18:10:27.143851 => 18:10:27.188848
[0m18:10:27.190849 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m18:10:27.230846 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m18:10:27.232849 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:10:27.233848 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m18:10:27.234848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:27.242847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:10:27.243848 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:10:27.244846 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m18:10:27.248848 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 18:10:27.191849 => 18:10:27.247848
[0m18:10:27.249846 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: ROLLBACK
[0m18:10:27.253846 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.fct_reviews'
[0m18:10:27.254846 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m18:10:27.260846 [debug] [Thread-1 (]: Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m18:10:27.261846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2baad3-48d2-4c08-8cee-488bae4230d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015127BE5110>]}
[0m18:10:27.262846 [error] [Thread-1 (]: 5 of 16 ERROR creating sql incremental model main.fct_reviews .................. [[31mERROR[0m in 0.12s]
[0m18:10:27.264848 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m18:10:27.265850 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:10:27.266850 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m18:10:27.268848 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:10:27.269849 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:10:27.270847 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m18:10:27.271848 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:10:27.272850 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:10:27.273849 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m18:10:27.275849 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:10:27.276850 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:10:27.277849 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m18:10:27.279849 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:10:27.280849 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:10:27.281851 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m18:10:27.282849 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:10:27.283848 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:10:27.284848 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m18:10:27.285848 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:10:27.287849 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:10:27.287849 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m18:10:27.289849 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:10:27.290852 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:10:27.291852 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m18:10:27.293849 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:10:27.294849 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:10:27.295849 [info ] [Thread-1 (]: 14 of 16 SKIP relation main.mart_fullmoon_reviews .............................. [[33mSKIP[0m]
[0m18:10:27.296849 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:10:27.297849 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m18:10:27.298848 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m18:10:27.299850 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m18:10:27.300850 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m18:10:27.301849 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m18:10:27.302850 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m18:10:27.304848 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:27.305848 [debug] [MainThread]: On master: BEGIN
[0m18:10:27.306850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:27.317848 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:10:27.318848 [debug] [MainThread]: On master: COMMIT
[0m18:10:27.319849 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:27.320851 [debug] [MainThread]: On master: COMMIT
[0m18:10:27.321850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:10:27.322849 [debug] [MainThread]: On master: Close
[0m18:10:27.327849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:27.329849 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m18:10:27.330850 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m18:10:27.331849 [debug] [MainThread]: Connection 'model.learn_duckdb.fct_reviews' was properly closed.
[0m18:10:27.333849 [info ] [MainThread]: 
[0m18:10:27.335849 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models, 1 hook in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m18:10:27.340850 [debug] [MainThread]: Command end result
[0m18:10:27.365850 [info ] [MainThread]: 
[0m18:10:27.366849 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m18:10:27.368851 [info ] [MainThread]: 
[0m18:10:27.370850 [error] [MainThread]:   Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m18:10:27.372849 [info ] [MainThread]: 
[0m18:10:27.374850 [error] [MainThread]:   Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m18:10:27.377851 [info ] [MainThread]: 
[0m18:10:27.379851 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m18:10:27.381849 [info ] [MainThread]: 
[0m18:10:27.383849 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:10:27.386850 [info ] [MainThread]: 
[0m18:10:27.387850 [error] [MainThread]:   Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m18:10:27.390850 [info ] [MainThread]: 
[0m18:10:27.393850 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=11 TOTAL=16
[0m18:10:27.398851 [debug] [MainThread]: Command `dbt build` failed at 18:10:27.397850 after 1.88 seconds
[0m18:10:27.399851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015120CE7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015127973750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015124F3DC10>]}
[0m18:10:27.401850 [debug] [MainThread]: Flushing usage events
[0m18:18:51.747886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270419178D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041301250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704194E790>]}


============================== 18:18:51.752887 | 974abbe2-44b7-4a0b-b3aa-af291c12c4c3 ==============================
[0m18:18:51.752887 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:18:51.754887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:18:52.072885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704198A390>]}
[0m18:18:52.165903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041A68D50>]}
[0m18:18:52.168887 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:18:52.183887 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:18:52.402902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:18:52.403903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:18:52.410903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041CE16D0>]}
[0m18:18:52.430889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041C33E50>]}
[0m18:18:52.431888 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:18:52.433888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041B02050>]}
[0m18:18:52.436907 [info ] [MainThread]: 
[0m18:18:52.437887 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:18:52.439888 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:18:52.453887 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:18:52.455890 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:18:52.456890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:52.474890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.476887 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:18:52.480889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m18:18:52.482888 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m18:18:52.492889 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:18:52.493890 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:18:52.494889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:52.504889 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.506886 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:18:52.507887 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m18:18:52.508888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.509888 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:18:52.509888 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m18:18:52.510888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.511887 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:18:52.512888 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:18:52.513887 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:18:52.514888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.514888 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m18:18:52.520909 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m18:18:52.527888 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:18:52.528888 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m18:18:52.529888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:52.537887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.538888 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:18:52.539888 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m18:18:52.574885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.576886 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m18:18:52.578888 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m18:18:52.578888 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:18:52.582888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m18:18:52.585886 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:18:52.586886 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m18:18:52.587888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:52.595887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.596887 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:18:52.597891 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m18:18:52.630902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:18:52.631904 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m18:18:52.632903 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m18:18:52.633908 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m18:18:52.638667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041AF1110>]}
[0m18:18:52.639693 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:52.639693 [debug] [MainThread]: On master: BEGIN
[0m18:18:52.640677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:52.649688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:18:52.649688 [debug] [MainThread]: On master: COMMIT
[0m18:18:52.650692 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:52.651677 [debug] [MainThread]: On master: COMMIT
[0m18:18:52.652687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:18:52.652687 [info ] [MainThread]: 
[0m18:18:52.653677 [info ] [MainThread]: Running 1 on-run-start hook
[0m18:18:52.676693 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m18:18:52.681677 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m18:18:52.683678 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m18:18:52.684680 [info ] [MainThread]: 
[0m18:18:52.685677 [debug] [MainThread]: On master: Close
[0m18:18:52.689694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:52.691678 [info ] [MainThread]: 
[0m18:18:52.696692 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m18:18:52.697688 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m18:18:52.698688 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m18:18:52.702692 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m18:18:52.704677 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 18:18:52.699677 => 18:18:52.703693
[0m18:18:52.707679 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m18:18:52.709678 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m18:18:52.710678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m18:18:52.711682 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m18:18:52.718696 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m18:18:52.719697 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 18:18:52.712678 => 18:18:52.719697
[0m18:18:52.721677 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m18:18:52.723681 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m18:18:52.725697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m18:18:52.726681 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m18:18:52.730677 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m18:18:52.732677 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 18:18:52.726681 => 18:18:52.732677
[0m18:18:52.734678 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m18:18:52.735686 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m18:18:52.736682 [info ] [Thread-1 (]: 1 of 5 START sql view model main.dim_hosts_cleansed ............................ [RUN]
[0m18:18:52.738680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now model.learn_duckdb.dim_hosts_cleansed)
[0m18:18:52.739677 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m18:18:52.748697 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:18:52.749677 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 18:18:52.741697 => 18:18:52.749677
[0m18:18:52.750677 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m18:18:52.789697 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:18:52.791679 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:18:52.792676 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m18:18:52.793696 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:18:52.802696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:18:52.802696 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:18:52.803696 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m18:18:52.806697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:18:52.816677 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:18:52.817677 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:18:52.819697 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 18:18:52.751679 => 18:18:52.819697
[0m18:18:52.820697 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m18:18:52.831691 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m18:18:52.831691 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m18:18:52.839686 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m18:18:52.839686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041B5FD10>]}
[0m18:18:52.841697 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.dim_hosts_cleansed ................... [[31mERROR[0m in 0.10s]
[0m18:18:52.842680 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m18:18:52.843692 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m18:18:52.844676 [info ] [Thread-1 (]: 2 of 5 START sql view model main.dim_listings_cleansed ......................... [RUN]
[0m18:18:52.845681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m18:18:52.846692 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m18:18:52.857688 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:18:52.859676 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 18:18:52.847676 => 18:18:52.858687
[0m18:18:52.860677 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m18:18:52.865692 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:18:52.867678 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:18:52.868677 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m18:18:52.869678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:52.917679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:18:52.918678 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:18:52.920677 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(
        REPLACE(
            price_str, '$'
        ),
        DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m18:18:52.923680 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 18:18:52.860677 => 18:18:52.922681
[0m18:18:52.924686 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m18:18:52.931679 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m18:18:52.933678 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m18:18:52.945680 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:18:52.946678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041F0E1D0>]}
[0m18:18:52.948679 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model main.dim_listings_cleansed ................ [[31mERROR[0m in 0.10s]
[0m18:18:52.950678 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m18:18:52.951677 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m18:18:52.952677 [info ] [Thread-1 (]: 3 of 5 START sql incremental model main.fct_reviews ............................ [RUN]
[0m18:18:52.954677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m18:18:52.954677 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m18:18:52.985676 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m18:18:52.988677 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 18:18:52.955678 => 18:18:52.987675
[0m18:18:52.990678 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m18:18:53.046677 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m18:18:53.048677 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:18:53.049677 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m18:18:53.050676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:53.060679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:18:53.061678 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:18:53.063677 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m18:18:53.068678 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 18:18:52.991680 => 18:18:53.068678
[0m18:18:53.070680 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: ROLLBACK
[0m18:18:53.076679 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.fct_reviews'
[0m18:18:53.077679 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m18:18:53.085680 [debug] [Thread-1 (]: Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m18:18:53.086679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '974abbe2-44b7-4a0b-b3aa-af291c12c4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027041F7BF10>]}
[0m18:18:53.087679 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model main.fct_reviews ................... [[31mERROR[0m in 0.13s]
[0m18:18:53.090718 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m18:18:53.092679 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m18:18:53.094679 [info ] [Thread-1 (]: 4 of 5 SKIP relation main.dim_listings_w_hosts ................................. [[33mSKIP[0m]
[0m18:18:53.095678 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m18:18:53.096679 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:18:53.097678 [info ] [Thread-1 (]: 5 of 5 SKIP relation main.mart_fullmoon_reviews ................................ [[33mSKIP[0m]
[0m18:18:53.099678 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:18:53.102677 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:53.103678 [debug] [MainThread]: On master: BEGIN
[0m18:18:53.104678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:53.114679 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:18:53.115680 [debug] [MainThread]: On master: COMMIT
[0m18:18:53.116678 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:53.116678 [debug] [MainThread]: On master: COMMIT
[0m18:18:53.117678 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:18:53.118679 [debug] [MainThread]: On master: Close
[0m18:18:53.121678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:53.123678 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m18:18:53.124678 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m18:18:53.126677 [debug] [MainThread]: Connection 'model.learn_duckdb.fct_reviews' was properly closed.
[0m18:18:53.127678 [info ] [MainThread]: 
[0m18:18:53.128677 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models, 1 hook in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m18:18:53.131678 [debug] [MainThread]: Command end result
[0m18:18:53.151678 [info ] [MainThread]: 
[0m18:18:53.152678 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:18:53.154677 [info ] [MainThread]: 
[0m18:18:53.155678 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m18:18:53.158678 [info ] [MainThread]: 
[0m18:18:53.159679 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:18:53.161679 [info ] [MainThread]: 
[0m18:18:53.162679 [error] [MainThread]:   Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m18:18:53.164678 [info ] [MainThread]: 
[0m18:18:53.165678 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m18:18:53.169678 [debug] [MainThread]: Command `dbt run` failed at 18:18:53.169678 after 1.49 seconds
[0m18:18:53.170678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703AE57CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703B0A5A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703B136210>]}
[0m18:18:53.171677 [debug] [MainThread]: Flushing usage events
[0m18:27:20.651813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3341F6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A34373AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A343BEED0>]}


============================== 18:27:20.658064 | 7d40787e-6581-4364-af00-2377eedf1a24 ==============================
[0m18:27:20.658064 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:27:20.659069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:27:20.971064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A33BB0DD0>]}
[0m18:27:21.064079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A343B8F90>]}
[0m18:27:21.066084 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:27:21.081064 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:27:21.311064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:27:21.312064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:27:21.320084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A34769250>]}
[0m18:27:21.344098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3469F810>]}
[0m18:27:21.346098 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:27:21.349098 [info ] [MainThread]: 
[0m18:27:21.351098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:27:21.354100 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:27:21.369117 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:27:21.370117 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:27:21.372096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:21.385097 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.388098 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:27:21.399096 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:27:21.400097 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:27:21.401097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:21.412100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.414095 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:27:21.420098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m18:27:21.421118 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m18:27:21.430097 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:27:21.431096 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:27:21.432096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:21.441118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.443119 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:27:21.444119 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m18:27:21.445098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.446118 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:27:21.447098 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m18:27:21.448098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.449097 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:27:21.450100 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:27:21.451097 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:27:21.452098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.452098 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m18:27:21.457097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m18:27:21.458097 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m18:27:21.463119 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:27:21.463119 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:27:21.464119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:21.475099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.477112 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:27:21.477112 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m18:27:21.479099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.479099 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:27:21.480097 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m18:27:21.481097 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.483097 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:27:21.483097 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:27:21.484098 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:27:21.485100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.486096 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m18:27:21.491098 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m18:27:21.498098 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:27:21.499098 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m18:27:21.500098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:21.508097 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.509098 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:27:21.510098 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m18:27:21.545096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.547098 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m18:27:21.549097 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m18:27:21.550098 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:27:21.554097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m18:27:21.557097 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:27:21.557097 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m18:27:21.558098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:21.566098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.567098 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:27:21.568096 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m18:27:21.601095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:21.603097 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m18:27:21.604099 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m18:27:21.605099 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m18:27:21.609098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3452CF50>]}
[0m18:27:21.610098 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:21.611097 [debug] [MainThread]: On master: BEGIN
[0m18:27:21.611097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:21.620100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:27:21.621097 [debug] [MainThread]: On master: COMMIT
[0m18:27:21.621097 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:21.622106 [debug] [MainThread]: On master: COMMIT
[0m18:27:21.623097 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:27:21.623097 [info ] [MainThread]: 
[0m18:27:21.625099 [info ] [MainThread]: Running 1 on-run-start hook
[0m18:27:21.647099 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m18:27:21.652098 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m18:27:21.654098 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m18:27:21.656099 [info ] [MainThread]: 
[0m18:27:21.657097 [debug] [MainThread]: On master: Close
[0m18:27:21.660099 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:21.661120 [info ] [MainThread]: 
[0m18:27:21.666102 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m18:27:21.668118 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m18:27:21.669099 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m18:27:21.674101 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m18:27:21.677101 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 18:27:21.669099 => 18:27:21.676101
[0m18:27:21.679109 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m18:27:21.680099 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m18:27:21.682101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m18:27:21.683110 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m18:27:21.687101 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m18:27:21.689098 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 18:27:21.683110 => 18:27:21.688099
[0m18:27:21.692100 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m18:27:21.693099 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m18:27:21.695103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m18:27:21.696103 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m18:27:21.700100 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m18:27:21.702098 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 18:27:21.696103 => 18:27:21.701097
[0m18:27:21.704098 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m18:27:21.704098 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m18:27:21.705099 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m18:27:21.707098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m18:27:21.709101 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m18:27:21.711100 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 18:27:21.710099 => 18:27:21.710099
[0m18:27:21.712099 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m18:27:21.752118 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:27:21.753118 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m18:27:21.754118 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:21.763119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:21.764119 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:27:21.765118 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m18:27:21.766102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:21.781098 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:27:21.782099 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'c:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:27:21.794098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:21.802096 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m18:27:21.825096 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:27:21.826096 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:27:21.827098 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:27:21.834099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:21.836097 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 18:27:21.712099 => 18:27:21.836097
[0m18:27:21.837097 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m18:27:21.850098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A349F0810>]}
[0m18:27:21.852098 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file main.seed_full_moon_dates .......................... [[32mINSERT 272[0m in 0.14s]
[0m18:27:21.854099 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m18:27:21.856099 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m18:27:21.858099 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m18:27:21.861100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m18:27:21.862098 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m18:27:21.869099 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 18:27:21.863099 => 18:27:21.869099
[0m18:27:21.870100 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m18:27:21.933099 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m18:27:21.935098 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:27:21.936100 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m18:27:21.937100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:21.959099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:21.960099 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:27:21.962099 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m18:27:21.996098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:21.998096 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:27:21.999096 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:27:22.000098 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:27:22.045100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:22.047098 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 18:27:21.871102 => 18:27:22.047098
[0m18:27:22.048098 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m18:27:22.102100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A349F0550>]}
[0m18:27:22.103098 [info ] [Thread-1 (]: 2 of 16 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.24s]
[0m18:27:22.105098 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m18:27:22.106100 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m18:27:22.106100 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m18:27:22.108099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m18:27:22.109099 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m18:27:22.116098 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:27:22.118099 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 18:27:22.109099 => 18:27:22.117099
[0m18:27:22.119099 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m18:27:22.153099 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:27:22.155099 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:27:22.156100 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m18:27:22.156100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:22.170098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:22.171098 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:27:22.172098 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m18:27:22.174099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:22.183118 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:27:22.183118 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:27:22.185099 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 18:27:22.119099 => 18:27:22.185099
[0m18:27:22.186099 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m18:27:22.196099 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m18:27:22.197099 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m18:27:22.204118 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m18:27:22.205118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A34970E10>]}
[0m18:27:22.206098 [error] [Thread-1 (]: 3 of 16 ERROR creating sql view model main.dim_hosts_cleansed .................. [[31mERROR[0m in 0.10s]
[0m18:27:22.207099 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m18:27:22.208100 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m18:27:22.209119 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m18:27:22.211099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m18:27:22.212100 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m18:27:22.221118 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:27:22.223098 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 18:27:22.212100 => 18:27:22.222118
[0m18:27:22.224099 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m18:27:22.235103 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:27:22.238099 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:27:22.239097 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m18:27:22.240099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:22.251100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:22.253099 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:27:22.254099 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(
        REPLACE(
            price_str, '$'
        ),
        DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m18:27:22.256100 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 18:27:22.224099 => 18:27:22.256100
[0m18:27:22.258100 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m18:27:22.265100 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m18:27:22.266100 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m18:27:22.277100 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:27:22.279100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A34785450>]}
[0m18:27:22.281099 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.07s]
[0m18:27:22.284099 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m18:27:22.285100 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m18:27:22.287100 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m18:27:22.290100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m18:27:22.291105 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m18:27:22.346100 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m18:27:22.349101 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 18:27:22.292101 => 18:27:22.348100
[0m18:27:22.351100 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m18:27:22.426100 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m18:27:22.429100 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:27:22.430100 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m18:27:22.432102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:22.448105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:22.450102 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:27:22.452100 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m18:27:23.603102 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m18:27:23.608101 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:27:23.610103 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:27:23.611107 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:27:23.943103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:23.945101 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 18:27:22.352105 => 18:27:23.945101
[0m18:27:23.946101 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m18:27:23.978099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A347A0890>]}
[0m18:27:23.979099 [info ] [Thread-1 (]: 5 of 16 OK created sql incremental model main.fct_reviews ...................... [[32mOK[0m in 1.69s]
[0m18:27:23.981103 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m18:27:23.982102 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:27:23.983101 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m18:27:23.985102 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:27:23.987102 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:27:23.988103 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m18:27:23.989103 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:27:23.991103 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:27:23.992104 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m18:27:23.994102 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:27:23.995102 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:27:23.996103 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m18:27:23.997101 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:27:23.998103 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:27:23.999103 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m18:27:24.001102 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:27:24.003100 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:27:24.004101 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m18:27:24.006102 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:27:24.007101 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:27:24.007101 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m18:27:24.009102 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:27:24.011102 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:27:24.012105 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m18:27:24.014102 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:27:24.015102 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:27:24.016102 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_fullmoon_reviews ...................... [RUN]
[0m18:27:24.017102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.fct_reviews, now model.learn_duckdb.mart_fullmoon_reviews)
[0m18:27:24.018101 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m18:27:24.023100 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:27:24.025101 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 18:27:24.019102 => 18:27:24.024099
[0m18:27:24.025101 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m18:27:24.042099 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:27:24.045103 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:27:24.046103 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m18:27:24.046103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:24.063102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:24.064103 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:27:24.065101 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
    );
  
  
[0m18:27:24.071099 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 18:27:24.026102 => 18:27:24.071099
[0m18:27:24.072101 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m18:27:24.076100 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m18:27:24.077102 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m18:27:24.084120 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m18:27:24.085120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d40787e-6581-4364-af00-2377eedf1a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A34A31650>]}
[0m18:27:24.087121 [error] [Thread-1 (]: 14 of 16 ERROR creating sql table model main.mart_fullmoon_reviews ............. [[31mERROR[0m in 0.07s]
[0m18:27:24.088101 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:27:24.089120 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m18:27:24.090120 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m18:27:24.091102 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m18:27:24.092104 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m18:27:24.094120 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m18:27:24.095103 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m18:27:24.098102 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:24.099101 [debug] [MainThread]: On master: BEGIN
[0m18:27:24.101101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:24.113103 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:27:24.114103 [debug] [MainThread]: On master: COMMIT
[0m18:27:24.115102 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:24.115102 [debug] [MainThread]: On master: COMMIT
[0m18:27:24.116102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:27:24.117103 [debug] [MainThread]: On master: Close
[0m18:27:24.120103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:24.121104 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m18:27:24.121104 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m18:27:24.122104 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m18:27:24.123104 [info ] [MainThread]: 
[0m18:27:24.125106 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models, 1 hook in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m18:27:24.128106 [debug] [MainThread]: Command end result
[0m18:27:24.148102 [info ] [MainThread]: 
[0m18:27:24.149116 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:27:24.151123 [info ] [MainThread]: 
[0m18:27:24.152102 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m18:27:24.153102 [info ] [MainThread]: 
[0m18:27:24.154101 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:27:24.156102 [info ] [MainThread]: 
[0m18:27:24.158102 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m18:27:24.160103 [info ] [MainThread]: 
[0m18:27:24.161107 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=10 TOTAL=16
[0m18:27:24.164107 [debug] [MainThread]: Command `dbt build` failed at 18:27:24.164107 after 3.59 seconds
[0m18:27:24.165122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A33DEABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A2D8A7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A2DAF5A50>]}
[0m18:27:24.166122 [debug] [MainThread]: Flushing usage events
[0m18:31:10.544791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340C93110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340C90A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340C93010>]}


============================== 18:31:10.550791 | 141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d ==============================
[0m18:31:10.550791 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:31:10.551791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:31:10.876791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340E65350>]}
[0m18:31:10.970791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340DFD5D0>]}
[0m18:31:10.974792 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:31:10.994789 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:31:11.216794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:11.217792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:11.225792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340D38A90>]}
[0m18:31:11.246791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340FBFD90>]}
[0m18:31:11.248793 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:31:11.253794 [info ] [MainThread]: 
[0m18:31:11.255792 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:31:11.258793 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:31:11.272790 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:31:11.273792 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:31:11.275794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:11.287792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.290792 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:31:11.298790 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:31:11.299790 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:31:11.300791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:11.311796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.313797 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:31:11.318792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m18:31:11.319812 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m18:31:11.328812 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:31:11.329812 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:31:11.330811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:11.340793 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.343793 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:31:11.344793 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m18:31:11.345792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.346793 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:31:11.346793 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m18:31:11.348793 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.349792 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:31:11.350791 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:31:11.351792 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:31:11.352796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.353792 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m18:31:11.359797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_main, now create_AIRBNB_dev)
[0m18:31:11.361796 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m18:31:11.365792 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:31:11.366792 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:31:11.367793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:11.379792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.381792 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:31:11.382792 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m18:31:11.383794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.383794 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:31:11.384792 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m18:31:11.385792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.387792 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:31:11.387792 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:31:11.388792 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:31:11.389795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.390792 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m18:31:11.396812 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m18:31:11.403812 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:31:11.404791 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m18:31:11.405791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:11.413791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.414791 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:31:11.415792 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m18:31:11.449791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.451792 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m18:31:11.453796 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m18:31:11.453796 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m18:31:11.458791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m18:31:11.461792 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:31:11.462793 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m18:31:11.462793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:11.471791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.472792 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:31:11.473792 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m18:31:11.508792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:31:11.510790 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m18:31:11.511793 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m18:31:11.511793 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:31:11.515792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340E80890>]}
[0m18:31:11.516792 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:11.517792 [debug] [MainThread]: On master: BEGIN
[0m18:31:11.518794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:11.526792 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:31:11.527792 [debug] [MainThread]: On master: COMMIT
[0m18:31:11.528793 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:11.528793 [debug] [MainThread]: On master: COMMIT
[0m18:31:11.530792 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:31:11.530792 [info ] [MainThread]: 
[0m18:31:11.531792 [info ] [MainThread]: Running 1 on-run-start hook
[0m18:31:11.553792 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m18:31:11.561792 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m18:31:11.562792 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m18:31:11.563794 [info ] [MainThread]: 
[0m18:31:11.564793 [debug] [MainThread]: On master: Close
[0m18:31:11.567794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:11.568794 [info ] [MainThread]: 
[0m18:31:11.573792 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m18:31:11.574792 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m18:31:11.576794 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m18:31:11.581792 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m18:31:11.583792 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 18:31:11.577794 => 18:31:11.583792
[0m18:31:11.585795 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m18:31:11.586792 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m18:31:11.587793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m18:31:11.588792 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m18:31:11.593793 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m18:31:11.595791 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 18:31:11.589792 => 18:31:11.595791
[0m18:31:11.597793 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m18:31:11.598793 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m18:31:11.599793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m18:31:11.600792 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m18:31:11.604792 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m18:31:11.605790 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 18:31:11.601792 => 18:31:11.605790
[0m18:31:11.607801 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m18:31:11.608792 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m18:31:11.610793 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m18:31:11.611793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m18:31:11.612792 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m18:31:11.613792 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 18:31:11.613792 => 18:31:11.613792
[0m18:31:11.614792 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m18:31:11.654790 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:31:11.655790 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m18:31:11.656793 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:11.665795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:11.666813 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:31:11.667793 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m18:31:11.668792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:11.681812 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:31:11.682812 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'c:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:31:11.692795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:11.700794 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m18:31:11.724813 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:31:11.725813 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:31:11.727795 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:31:11.732793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:11.736793 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 18:31:11.615792 => 18:31:11.735793
[0m18:31:11.737793 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m18:31:11.753793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015341325410>]}
[0m18:31:11.754792 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file main.seed_full_moon_dates .......................... [[32mINSERT 272[0m in 0.14s]
[0m18:31:11.756793 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m18:31:11.758793 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m18:31:11.759793 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m18:31:11.762797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m18:31:11.763797 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m18:31:11.771793 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 18:31:11.764794 => 18:31:11.770793
[0m18:31:11.772794 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m18:31:11.834792 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m18:31:11.836792 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:31:11.838793 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m18:31:11.839794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:11.863793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:11.864793 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:31:11.866793 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m18:31:11.906795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:11.910794 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:31:11.912795 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:31:11.914794 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:31:11.975795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:11.978793 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 18:31:11.773793 => 18:31:11.978793
[0m18:31:11.980794 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m18:31:12.088794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015341326290>]}
[0m18:31:12.090794 [info ] [Thread-1 (]: 2 of 16 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.33s]
[0m18:31:12.092793 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m18:31:12.094795 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m18:31:12.095796 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m18:31:12.099796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m18:31:12.100794 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m18:31:12.114794 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:31:12.117794 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 18:31:12.102793 => 18:31:12.116796
[0m18:31:12.119794 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m18:31:12.190794 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:31:12.193795 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:31:12.194794 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m18:31:12.196794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:12.220795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:12.222795 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:31:12.225796 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m18:31:12.228795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:12.246794 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:31:12.247794 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:31:12.249795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:12.254794 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m18:31:12.255794 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:31:12.257794 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m18:31:12.262795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:12.280794 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:31:12.282794 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."main"."dim_hosts_cleansed__dbt_backup" cascade
[0m18:31:12.284793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:12.289793 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 18:31:12.120793 => 18:31:12.288793
[0m18:31:12.290793 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m18:31:12.331793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153410A7890>]}
[0m18:31:12.333793 [info ] [Thread-1 (]: 3 of 16 OK created sql view model main.dim_hosts_cleansed ...................... [[32mOK[0m in 0.23s]
[0m18:31:12.345794 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m18:31:12.347794 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m18:31:12.349794 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m18:31:12.351794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m18:31:12.353794 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m18:31:12.384795 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:31:12.387796 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 18:31:12.354794 => 18:31:12.386795
[0m18:31:12.391795 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m18:31:12.407793 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:31:12.411796 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:31:12.413795 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m18:31:12.414795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:12.444794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:12.447309 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:31:12.448310 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(
        REPLACE(
            price_str, '$'
        ),
        DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m18:31:12.451310 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 18:31:12.394793 => 18:31:12.450311
[0m18:31:12.453310 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m18:31:12.469310 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m18:31:12.471309 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m18:31:12.484309 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:31:12.485310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015340EC7250>]}
[0m18:31:12.488310 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.13s]
[0m18:31:12.490310 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m18:31:12.492309 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m18:31:12.494309 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m18:31:12.497311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m18:31:12.499311 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m18:31:12.594310 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m18:31:12.599310 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 18:31:12.501310 => 18:31:12.597310
[0m18:31:12.605310 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m18:31:12.680310 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m18:31:12.682310 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:31:12.684311 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m18:31:12.684311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:12.694310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:31:12.695309 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:31:12.697310 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m18:31:12.701311 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 18:31:12.607311 => 18:31:12.700311
[0m18:31:12.701311 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: ROLLBACK
[0m18:31:12.708311 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.fct_reviews'
[0m18:31:12.709310 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m18:31:12.718310 [debug] [Thread-1 (]: Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m18:31:12.719311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '141530ce-4cc6-4f9d-aaa3-8f49a77fbf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153410DD1D0>]}
[0m18:31:12.721310 [error] [Thread-1 (]: 5 of 16 ERROR creating sql incremental model main.fct_reviews .................. [[31mERROR[0m in 0.22s]
[0m18:31:12.723312 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m18:31:12.725310 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:31:12.726312 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m18:31:12.728310 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:31:12.730311 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:31:12.732311 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m18:31:12.734309 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:31:12.735311 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:31:12.737311 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m18:31:12.738309 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:31:12.740312 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:31:12.742312 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m18:31:12.744311 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:31:12.746315 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:31:12.748311 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m18:31:12.750311 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:31:12.751311 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:31:12.753311 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m18:31:12.755310 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:31:12.757311 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:31:12.758311 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m18:31:12.760311 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:31:12.762311 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:31:12.763312 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m18:31:12.766312 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:31:12.767311 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:31:12.768311 [info ] [Thread-1 (]: 14 of 16 SKIP relation main.mart_fullmoon_reviews .............................. [[33mSKIP[0m]
[0m18:31:12.771310 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:31:12.773310 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m18:31:12.774310 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m18:31:12.777312 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m18:31:12.778310 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m18:31:12.779312 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m18:31:12.782320 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m18:31:12.785310 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:12.785310 [debug] [MainThread]: On master: BEGIN
[0m18:31:12.787309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:12.798312 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:31:12.799312 [debug] [MainThread]: On master: COMMIT
[0m18:31:12.800311 [debug] [MainThread]: Using duckdb connection "master"
[0m18:31:12.801312 [debug] [MainThread]: On master: COMMIT
[0m18:31:12.802310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:31:12.803311 [debug] [MainThread]: On master: Close
[0m18:31:12.807310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:12.807310 [debug] [MainThread]: Connection 'create_AIRBNB_dev' was properly closed.
[0m18:31:12.809310 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m18:31:12.810315 [debug] [MainThread]: Connection 'model.learn_duckdb.fct_reviews' was properly closed.
[0m18:31:12.811312 [info ] [MainThread]: 
[0m18:31:12.813313 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models, 1 hook in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m18:31:12.818312 [debug] [MainThread]: Command end result
[0m18:31:12.841311 [info ] [MainThread]: 
[0m18:31:12.843317 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:31:12.845311 [info ] [MainThread]: 
[0m18:31:12.847311 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:31:12.848311 [info ] [MainThread]: 
[0m18:31:12.850311 [error] [MainThread]:   Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m18:31:12.852311 [info ] [MainThread]: 
[0m18:31:12.853313 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=11 TOTAL=16
[0m18:31:12.856311 [debug] [MainThread]: Command `dbt build` failed at 18:31:12.856311 after 2.38 seconds
[0m18:31:12.857310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533A157CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001534078DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533A3A4D90>]}
[0m18:31:12.858308 [debug] [MainThread]: Flushing usage events
[0m18:32:52.336828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822CF55F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822CF63550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822CF63690>]}


============================== 18:32:52.342845 | 9c68df7c-23e5-4917-aaf4-7b6073fbd90d ==============================
[0m18:32:52.342845 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:32:52.343824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:32:52.665383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822CFAF590>]}
[0m18:32:52.759384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822D07D010>]}
[0m18:32:52.762365 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:32:52.779386 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:32:53.007363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:53.008363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:53.016362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822D346990>]}
[0m18:32:53.042364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822D243DD0>]}
[0m18:32:53.044365 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:32:53.047365 [info ] [MainThread]: 
[0m18:32:53.049369 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:32:53.051385 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:32:53.068384 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:32:53.070367 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:32:53.071384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:53.084364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.088384 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:32:53.097364 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:32:53.098384 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:32:53.099368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:53.109363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.111374 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:32:53.115385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m18:32:53.117368 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m18:32:53.125385 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:32:53.126384 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:32:53.127363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:53.136377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.139385 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:32:53.139385 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m18:32:53.141363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.141363 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:32:53.142364 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m18:32:53.143363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.145363 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:32:53.145363 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:32:53.146370 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:32:53.147384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.148385 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m18:32:53.152363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_main, now create_AIRBNB_dev)
[0m18:32:53.153364 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m18:32:53.157384 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:32:53.158386 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:32:53.159386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:53.168366 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.171383 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:32:53.171383 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m18:32:53.172364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.173364 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:32:53.174364 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m18:32:53.175364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.176385 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:32:53.177385 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:32:53.178385 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:32:53.179364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.179364 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m18:32:53.185365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m18:32:53.192384 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:32:53.193388 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m18:32:53.194363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:53.203363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.204363 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:32:53.205368 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m18:32:53.256364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.258363 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m18:32:53.259364 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m18:32:53.260364 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m18:32:53.264364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m18:32:53.268364 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:32:53.268364 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m18:32:53.269364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:53.277364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.278364 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:32:53.279364 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m18:32:53.313361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:32:53.315361 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m18:32:53.316362 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m18:32:53.317363 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:32:53.321361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822C4A4050>]}
[0m18:32:53.322361 [debug] [MainThread]: Using duckdb connection "master"
[0m18:32:53.322361 [debug] [MainThread]: On master: BEGIN
[0m18:32:53.323363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:53.332363 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:32:53.333362 [debug] [MainThread]: On master: COMMIT
[0m18:32:53.334363 [debug] [MainThread]: Using duckdb connection "master"
[0m18:32:53.334363 [debug] [MainThread]: On master: COMMIT
[0m18:32:53.335363 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:32:53.336363 [info ] [MainThread]: 
[0m18:32:53.338363 [info ] [MainThread]: Running 1 on-run-start hook
[0m18:32:53.365363 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m18:32:53.370365 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m18:32:53.372365 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m18:32:53.373363 [info ] [MainThread]: 
[0m18:32:53.375364 [debug] [MainThread]: On master: Close
[0m18:32:53.377364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:53.379365 [info ] [MainThread]: 
[0m18:32:53.385363 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m18:32:53.386362 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m18:32:53.388363 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m18:32:53.394362 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m18:32:53.397365 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 18:32:53.389363 => 18:32:53.396364
[0m18:32:53.399365 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m18:32:53.400365 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m18:32:53.402366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m18:32:53.403366 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m18:32:53.408365 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m18:32:53.410364 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 18:32:53.403366 => 18:32:53.409366
[0m18:32:53.412365 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m18:32:53.414364 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m18:32:53.415366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m18:32:53.416366 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m18:32:53.421365 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m18:32:53.423364 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 18:32:53.417366 => 18:32:53.422366
[0m18:32:53.425365 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m18:32:53.427364 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m18:32:53.428364 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m18:32:53.430365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m18:32:53.432365 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m18:32:53.434364 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 18:32:53.433365 => 18:32:53.433365
[0m18:32:53.435363 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m18:32:53.481363 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:32:53.482367 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m18:32:53.483365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:32:53.493365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:53.493365 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:32:53.495364 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m18:32:53.496365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:53.513368 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:32:53.514368 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'c:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:32:53.522977 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:53.529975 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m18:32:53.556974 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:32:53.557972 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:32:53.558972 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:32:53.562972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:53.564977 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 18:32:53.436363 => 18:32:53.564977
[0m18:32:53.565973 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m18:32:53.580973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822D58C3D0>]}
[0m18:32:53.581972 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file main.seed_full_moon_dates .......................... [[32mINSERT 272[0m in 0.15s]
[0m18:32:53.583972 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m18:32:53.585974 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m18:32:53.586974 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m18:32:53.589975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m18:32:53.591973 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m18:32:53.598977 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 18:32:53.592977 => 18:32:53.598977
[0m18:32:53.599977 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m18:32:53.672972 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m18:32:53.674972 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:32:53.676974 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m18:32:53.677979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:53.692973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:53.692973 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:32:53.694974 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m18:32:53.731976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:53.734974 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:32:53.736974 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:32:53.737978 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:32:53.794974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:53.798975 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 18:32:53.600978 => 18:32:53.797975
[0m18:32:53.799975 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m18:32:53.922974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822D1B0D10>]}
[0m18:32:53.924975 [info ] [Thread-1 (]: 2 of 16 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.33s]
[0m18:32:53.927974 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m18:32:53.928977 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m18:32:53.930976 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m18:32:53.936975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m18:32:53.938977 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m18:32:53.957974 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:32:53.960974 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 18:32:53.939975 => 18:32:53.960974
[0m18:32:53.962976 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m18:32:54.053976 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:32:54.056975 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:32:54.058975 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m18:32:54.059975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:54.081975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:54.082975 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:32:54.084975 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m18:32:54.087976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:54.102974 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:32:54.104975 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:32:54.106975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:54.111975 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m18:32:54.112975 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:32:54.114976 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m18:32:54.119976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:54.133975 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:32:54.135975 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."main"."dim_hosts_cleansed__dbt_backup" cascade
[0m18:32:54.136975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:54.139976 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 18:32:53.964975 => 18:32:54.139976
[0m18:32:54.140976 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m18:32:54.154974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822D243910>]}
[0m18:32:54.156975 [info ] [Thread-1 (]: 3 of 16 OK created sql view model main.dim_hosts_cleansed ...................... [[32mOK[0m in 0.22s]
[0m18:32:54.158974 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m18:32:54.160974 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m18:32:54.162975 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m18:32:54.164976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m18:32:54.165973 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m18:32:54.182975 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:32:54.185974 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 18:32:54.166975 => 18:32:54.184975
[0m18:32:54.187975 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m18:32:54.196974 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:32:54.199975 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:32:54.200976 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m18:32:54.201975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:54.221973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:54.223973 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:32:54.224975 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(
        REPLACE(
            price_str, '$'
        ),
        DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m18:32:54.227974 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 18:32:54.188975 => 18:32:54.227974
[0m18:32:54.230975 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m18:32:54.243974 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m18:32:54.244974 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m18:32:54.257975 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:32:54.259973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822CF9F690>]}
[0m18:32:54.261974 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.10s]
[0m18:32:54.265976 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m18:32:54.269975 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m18:32:54.271975 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m18:32:54.274975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m18:32:54.276974 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m18:32:54.328974 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m18:32:54.331973 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 18:32:54.277975 => 18:32:54.331973
[0m18:32:54.333978 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m18:32:54.400973 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m18:32:54.402973 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:32:54.404974 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m18:32:54.405974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:54.415974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:54.416974 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:32:54.418974 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m18:32:55.330623 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m18:32:55.333627 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:32:55.334623 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:32:55.335622 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:32:55.786692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:55.788687 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 18:32:54.334974 => 18:32:55.788687
[0m18:32:55.789707 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m18:32:55.823691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822D5E4350>]}
[0m18:32:55.825693 [info ] [Thread-1 (]: 5 of 16 OK created sql incremental model main.fct_reviews ...................... [[32mOK[0m in 1.55s]
[0m18:32:55.827688 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m18:32:55.829692 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:32:55.830691 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m18:32:55.832692 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:32:55.833708 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:32:55.835688 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m18:32:55.837687 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:32:55.839689 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:32:55.840688 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m18:32:55.841687 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:32:55.843687 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:32:55.845708 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m18:32:55.847692 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:32:55.848692 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:32:55.849688 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m18:32:55.851688 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:32:55.853693 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:32:55.854693 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m18:32:55.856691 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:32:55.857687 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:32:55.858692 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m18:32:55.859687 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:32:55.860692 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:32:55.861694 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m18:32:55.862689 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:32:55.863692 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:32:55.865691 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_fullmoon_reviews ...................... [RUN]
[0m18:32:55.867688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.fct_reviews, now model.learn_duckdb.mart_fullmoon_reviews)
[0m18:32:55.868708 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m18:32:55.873691 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:32:55.875691 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 18:32:55.869692 => 18:32:55.875691
[0m18:32:55.876691 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m18:32:55.893687 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:32:55.895687 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:32:55.896687 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m18:32:55.899689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:55.913691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:32:55.914692 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:32:55.915689 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
    );
  
  
[0m18:32:55.921691 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 18:32:55.877692 => 18:32:55.921691
[0m18:32:55.922691 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m18:32:55.926691 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m18:32:55.927692 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m18:32:55.934687 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m18:32:55.935687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c68df7c-23e5-4917-aaf4-7b6073fbd90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822D365B50>]}
[0m18:32:55.936687 [error] [Thread-1 (]: 14 of 16 ERROR creating sql table model main.mart_fullmoon_reviews ............. [[31mERROR[0m in 0.07s]
[0m18:32:55.937689 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:32:55.938692 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m18:32:55.939692 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m18:32:55.940689 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m18:32:55.941692 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m18:32:55.942691 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m18:32:55.945688 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m18:32:55.950691 [debug] [MainThread]: Using duckdb connection "master"
[0m18:32:55.951691 [debug] [MainThread]: On master: BEGIN
[0m18:32:55.952687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:55.960687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:32:55.961687 [debug] [MainThread]: On master: COMMIT
[0m18:32:55.962687 [debug] [MainThread]: Using duckdb connection "master"
[0m18:32:55.962687 [debug] [MainThread]: On master: COMMIT
[0m18:32:55.963687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:32:55.964686 [debug] [MainThread]: On master: Close
[0m18:32:55.967690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:55.968690 [debug] [MainThread]: Connection 'create_AIRBNB_dev' was properly closed.
[0m18:32:55.969687 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m18:32:55.970687 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m18:32:55.971689 [info ] [MainThread]: 
[0m18:32:55.972687 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models, 1 hook in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m18:32:55.975692 [debug] [MainThread]: Command end result
[0m18:32:55.996688 [info ] [MainThread]: 
[0m18:32:55.997691 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:32:55.998687 [info ] [MainThread]: 
[0m18:32:56.000690 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:32:56.002692 [info ] [MainThread]: 
[0m18:32:56.003688 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m18:32:56.005687 [info ] [MainThread]: 
[0m18:32:56.006693 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=10 TOTAL=16
[0m18:32:56.010688 [debug] [MainThread]: Command `dbt build` failed at 18:32:56.010688 after 3.75 seconds
[0m18:32:56.011690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822CF03D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018226407CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001822CF462D0>]}
[0m18:32:56.012688 [debug] [MainThread]: Flushing usage events
[0m18:34:54.032409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F04F4F5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F05ECAF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F05ECB910>]}


============================== 18:34:54.037404 | 4630855d-b1ff-4ae0-bc8c-79f90db2c99a ==============================
[0m18:34:54.037404 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:34:54.039393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:54.365410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F0602E8D0>]}
[0m18:34:54.459408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F059AE490>]}
[0m18:34:54.462388 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:34:54.480409 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:34:54.719979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:54.720979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:54.728979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F06281850>]}
[0m18:34:54.749961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F061CB690>]}
[0m18:34:54.750959 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:34:54.755964 [info ] [MainThread]: 
[0m18:34:54.756960 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:34:54.760961 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:34:54.785960 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:34:54.786961 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:34:54.787963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:54.800960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.803960 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:34:54.811959 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:34:54.812960 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:34:54.813960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:54.824963 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.826964 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:34:54.831980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m18:34:54.832980 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m18:34:54.841979 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:34:54.841979 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:34:54.842980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:54.852958 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.854980 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:34:54.855964 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m18:34:54.856959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.857964 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:34:54.857964 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m18:34:54.858964 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.860963 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:34:54.860963 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:34:54.861965 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:34:54.862965 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.863964 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m18:34:54.867980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m18:34:54.868958 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m18:34:54.872963 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:34:54.873964 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:34:54.873964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:54.884961 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.886965 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:34:54.887965 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m18:34:54.888959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.889960 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:34:54.890964 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m18:34:54.891960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.892964 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:34:54.893965 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:34:54.894964 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:34:54.895962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.896964 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m18:34:54.901964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m18:34:54.909980 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:34:54.909980 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m18:34:54.910980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:54.919979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.920979 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:34:54.921960 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m18:34:54.956979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.958979 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m18:34:54.960963 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m18:34:54.960963 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:34:54.965980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m18:34:54.968980 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:34:54.969980 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m18:34:54.970981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:54.978980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:54.979980 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:34:54.980980 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m18:34:55.016979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:34:55.018979 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m18:34:55.020959 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m18:34:55.020959 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m18:34:55.024979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F06051390>]}
[0m18:34:55.025980 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:55.026980 [debug] [MainThread]: On master: BEGIN
[0m18:34:55.027980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:55.036979 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:34:55.037980 [debug] [MainThread]: On master: COMMIT
[0m18:34:55.037980 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:55.038960 [debug] [MainThread]: On master: COMMIT
[0m18:34:55.039980 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:34:55.040960 [info ] [MainThread]: 
[0m18:34:55.041978 [info ] [MainThread]: Running 1 on-run-start hook
[0m18:34:55.068960 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m18:34:55.075960 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m18:34:55.077964 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m18:34:55.078964 [info ] [MainThread]: 
[0m18:34:55.080959 [debug] [MainThread]: On master: Close
[0m18:34:55.083980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:55.084962 [info ] [MainThread]: 
[0m18:34:55.090962 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m18:34:55.092960 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m18:34:55.093960 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m18:34:55.098961 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m18:34:55.100959 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 18:34:55.094960 => 18:34:55.099980
[0m18:34:55.101960 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m18:34:55.103961 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m18:34:55.104961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m18:34:55.105960 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m18:34:55.110980 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m18:34:55.112960 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 18:34:55.106960 => 18:34:55.112960
[0m18:34:55.114961 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m18:34:55.115965 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m18:34:55.116965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m18:34:55.117960 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m18:34:55.123961 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m18:34:55.125961 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 18:34:55.118959 => 18:34:55.125961
[0m18:34:55.127961 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m18:34:55.128961 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m18:34:55.130960 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m18:34:55.132960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m18:34:55.133960 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m18:34:55.135959 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 18:34:55.134959 => 18:34:55.134959
[0m18:34:55.136961 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m18:34:55.197959 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:34:55.198959 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m18:34:55.200960 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:55.211960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.212961 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:34:55.214961 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m18:34:55.216961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.243961 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:34:55.244961 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'c:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:34:55.259960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.272959 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m18:34:55.312961 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:34:55.314960 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:34:55.316961 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:34:55.323960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.326961 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 18:34:55.137960 => 18:34:55.325960
[0m18:34:55.328961 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m18:34:55.343960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F0642FB50>]}
[0m18:34:55.345961 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file main.seed_full_moon_dates .......................... [[32mINSERT 272[0m in 0.21s]
[0m18:34:55.347962 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m18:34:55.348963 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m18:34:55.350960 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m18:34:55.353960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m18:34:55.354960 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m18:34:55.364961 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 18:34:55.355960 => 18:34:55.363961
[0m18:34:55.365961 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m18:34:55.476960 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m18:34:55.478960 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:34:55.479960 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m18:34:55.480960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:55.495960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.496959 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:34:55.498961 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m18:34:55.525960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.528960 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:34:55.529961 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:34:55.530960 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:34:55.561962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.563961 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 18:34:55.366960 => 18:34:55.563961
[0m18:34:55.564961 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m18:34:55.646358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F063CD790>]}
[0m18:34:55.648358 [info ] [Thread-1 (]: 2 of 16 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.29s]
[0m18:34:55.651358 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m18:34:55.654358 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m18:34:55.656360 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m18:34:55.659358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m18:34:55.661358 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m18:34:55.695359 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:34:55.700360 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 18:34:55.662358 => 18:34:55.699359
[0m18:34:55.702360 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m18:34:55.851359 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:34:55.854359 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:34:55.856358 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m18:34:55.858360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:55.878359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.879358 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:34:55.881360 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m18:34:55.884359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.898359 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:34:55.900358 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:34:55.902360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.906359 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m18:34:55.908359 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:34:55.909359 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m18:34:55.914359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.925359 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:34:55.927360 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."main"."dim_hosts_cleansed__dbt_backup" cascade
[0m18:34:55.929358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:55.933358 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 18:34:55.703359 => 18:34:55.932359
[0m18:34:55.934358 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m18:34:55.951359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F06378A90>]}
[0m18:34:55.953360 [info ] [Thread-1 (]: 3 of 16 OK created sql view model main.dim_hosts_cleansed ...................... [[32mOK[0m in 0.29s]
[0m18:34:55.956359 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m18:34:55.957359 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m18:34:55.959359 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m18:34:55.962360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m18:34:55.963359 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m18:34:55.986358 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:34:55.990360 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 18:34:55.964359 => 18:34:55.988359
[0m18:34:55.992359 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m18:34:56.001360 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:34:56.003359 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:34:56.005359 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m18:34:56.007366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:56.023360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:56.024360 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:34:56.025361 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(
        REPLACE(
            price_str, '$', ''
        ),
        DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m18:34:56.027359 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 18:34:55.993362 => 18:34:56.027359
[0m18:34:56.028360 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m18:34:56.040359 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m18:34:56.041357 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m18:34:56.048360 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:34:56.049358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F05EED1D0>]}
[0m18:34:56.051358 [error] [Thread-1 (]: 4 of 16 ERROR creating sql view model main.dim_listings_cleansed ............... [[31mERROR[0m in 0.09s]
[0m18:34:56.053360 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m18:34:56.054361 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m18:34:56.056362 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m18:34:56.059362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m18:34:56.060359 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m18:34:56.128361 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m18:34:56.131359 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 18:34:56.061360 => 18:34:56.130359
[0m18:34:56.132363 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m18:34:56.201357 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m18:34:56.203359 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:34:56.205358 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m18:34:56.206358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:56.226360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:56.228360 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:34:56.230360 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m18:34:57.448913 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m18:34:57.451916 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:34:57.452915 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:34:57.453917 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:34:57.686467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:57.689466 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 18:34:56.134360 => 18:34:57.689466
[0m18:34:57.690465 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m18:34:57.731466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F06202C10>]}
[0m18:34:57.733464 [info ] [Thread-1 (]: 5 of 16 OK created sql incremental model main.fct_reviews ...................... [[32mOK[0m in 1.67s]
[0m18:34:57.735467 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m18:34:57.737466 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:34:57.739466 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m18:34:57.741468 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:34:57.742467 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:34:57.743467 [info ] [Thread-1 (]: 7 of 16 SKIP test dim_listings_minimum_nights .................................. [[33mSKIP[0m]
[0m18:34:57.744466 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:34:57.746466 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:34:57.747465 [info ] [Thread-1 (]: 8 of 16 SKIP test no_nulls_in_dim_listings ..................................... [[33mSKIP[0m]
[0m18:34:57.749468 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:34:57.750468 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:34:57.751465 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_dim_listings_cleansed_host_id ....................... [[33mSKIP[0m]
[0m18:34:57.752465 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:34:57.753466 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:34:57.755471 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m18:34:57.757470 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:34:57.759468 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:34:57.761467 [info ] [Thread-1 (]: 11 of 16 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m18:34:57.762467 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:34:57.764466 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:34:57.766467 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m18:34:57.767466 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:34:57.769467 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:34:57.771468 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m18:34:57.773467 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:34:57.774467 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:34:57.776467 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_fullmoon_reviews ...................... [RUN]
[0m18:34:57.779467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.fct_reviews, now model.learn_duckdb.mart_fullmoon_reviews)
[0m18:34:57.781467 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m18:34:57.788465 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:34:57.791468 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 18:34:57.781467 => 18:34:57.790467
[0m18:34:57.793468 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m18:34:57.824466 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:34:57.826465 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:34:57.828465 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m18:34:57.829467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:57.844465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:34:57.845464 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:34:57.846469 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
    );
  
  
[0m18:34:57.854466 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 18:34:57.794468 => 18:34:57.853467
[0m18:34:57.855466 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m18:34:57.862466 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m18:34:57.863467 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m18:34:57.873466 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m18:34:57.874464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4630855d-b1ff-4ae0-bc8c-79f90db2c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F06202C10>]}
[0m18:34:57.876465 [error] [Thread-1 (]: 14 of 16 ERROR creating sql table model main.mart_fullmoon_reviews ............. [[31mERROR[0m in 0.10s]
[0m18:34:57.878466 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:34:57.879466 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m18:34:57.881467 [info ] [Thread-1 (]: 15 of 16 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m18:34:57.883467 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m18:34:57.884467 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m18:34:57.885466 [info ] [Thread-1 (]: 16 of 16 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m18:34:57.887466 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m18:34:57.891468 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:57.892467 [debug] [MainThread]: On master: BEGIN
[0m18:34:57.893467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:57.904466 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:34:57.905465 [debug] [MainThread]: On master: COMMIT
[0m18:34:57.906468 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:57.908467 [debug] [MainThread]: On master: COMMIT
[0m18:34:57.909468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:34:57.910467 [debug] [MainThread]: On master: Close
[0m18:34:57.915467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:57.916467 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m18:34:57.917467 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m18:34:57.918466 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m18:34:57.919465 [info ] [MainThread]: 
[0m18:34:57.921466 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models, 1 hook in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m18:34:57.926466 [debug] [MainThread]: Command end result
[0m18:34:57.949466 [info ] [MainThread]: 
[0m18:34:57.950467 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:34:57.952466 [info ] [MainThread]: 
[0m18:34:57.953467 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Parser Error: syntax error at or near ","
[0m18:34:57.954467 [info ] [MainThread]: 
[0m18:34:57.955466 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 29:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
    
    ...
                   ^
[0m18:34:57.958466 [info ] [MainThread]: 
[0m18:34:57.959468 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=10 TOTAL=16
[0m18:34:57.962469 [debug] [MainThread]: Command `dbt build` failed at 18:34:57.962469 after 4.00 seconds
[0m18:34:57.963469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F05AEE710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F7F3D7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F7F6258D0>]}
[0m18:34:57.964469 [debug] [MainThread]: Flushing usage events
[0m18:58:29.664654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFED8AB190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFED6E1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEDCEB8D0>]}


============================== 18:58:29.669654 | 17b0b4f5-c818-43de-9788-2707f3399347 ==============================
[0m18:58:29.669654 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:58:29.671641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:58:30.030654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17b0b4f5-c818-43de-9788-2707f3399347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEDDF38D0>]}
[0m18:58:30.125655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17b0b4f5-c818-43de-9788-2707f3399347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEDFA1610>]}
[0m18:58:30.128641 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:58:30.144659 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:58:30.460247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:30.462244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:30.478247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b0b4f5-c818-43de-9788-2707f3399347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEDE8E090>]}
[0m18:58:30.508246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b0b4f5-c818-43de-9788-2707f3399347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEDFFFFD0>]}
[0m18:58:30.509245 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:58:30.516246 [info ] [MainThread]: 
[0m18:58:30.519246 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:58:30.523248 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:58:30.541246 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:58:30.542244 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:58:30.543245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:30.640245 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:58:30.641245 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:58:30.642246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:30.743243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:30.745245 [debug] [MainThread]: Connection 'list_AIRBNB' was properly closed.
[0m18:58:30.746245 [info ] [MainThread]: 
[0m18:58:30.748246 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:58:30.750243 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\Use\AppData\Local\Microsoft\WinGet\Packages\DuckDB.cli_Microsoft.Winget.Source_8wekyb3d8bbwe\duckdb.exe (PID 18648)
[0m18:58:30.755247 [debug] [MainThread]: Command `dbt build` failed at 18:58:30.754246 after 1.16 seconds
[0m18:58:30.756244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE71E7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEDD185D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFEDD1A850>]}
[0m18:58:30.758246 [debug] [MainThread]: Flushing usage events
[0m18:58:58.441687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B2572D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B262B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B263CD0>]}


============================== 18:58:58.447687 | 816e71f1-1b33-4e1f-833f-ded29ab3119e ==============================
[0m18:58:58.447687 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:58:58.449688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:58:58.793690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1AA50DD0>]}
[0m18:58:58.893709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B4D45D0>]}
[0m18:58:58.895688 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m18:58:58.911688 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:58:59.146267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:59.147257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:59.157256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B65D850>]}
[0m18:58:59.181255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B54FD90>]}
[0m18:58:59.182256 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m18:58:59.188255 [info ] [MainThread]: 
[0m18:58:59.190263 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:58:59.193255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m18:58:59.210259 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:58:59.212255 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:58:59.213254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:59.227256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.231254 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:58:59.240255 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m18:58:59.242257 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m18:58:59.243255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:59.253255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.255256 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:58:59.261255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m18:58:59.263255 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m18:58:59.271254 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:58:59.272254 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:58:59.273254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:59.283254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.285254 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:58:59.286258 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m18:58:59.288257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.289259 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:58:59.290255 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m18:58:59.291256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.293254 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:58:59.294259 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m18:58:59.295254 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m18:58:59.296255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.297254 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m18:58:59.302254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m18:58:59.303255 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m18:58:59.308254 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:58:59.309254 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m18:58:59.311257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:59.321255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.323254 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:58:59.324254 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m18:58:59.325255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.326255 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:58:59.327255 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m18:58:59.328255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.330256 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:58:59.331254 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m18:58:59.332255 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m18:58:59.333254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.334256 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m18:58:59.343257 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m18:58:59.350254 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:58:59.351253 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m18:58:59.352256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:59.361254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.362255 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m18:58:59.363254 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m18:58:59.401801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.404801 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m18:58:59.407801 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m18:58:59.407801 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:58:59.412806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m18:58:59.415804 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:58:59.416805 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m18:58:59.417805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:59.426804 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.427804 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m18:58:59.429804 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m18:58:59.472802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:58:59.474803 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m18:58:59.475803 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m18:58:59.476803 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m18:58:59.481803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B6413D0>]}
[0m18:58:59.482824 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:59.483809 [debug] [MainThread]: On master: BEGIN
[0m18:58:59.484802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:59.493824 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:58:59.494807 [debug] [MainThread]: On master: COMMIT
[0m18:58:59.495803 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:59.496803 [debug] [MainThread]: On master: COMMIT
[0m18:58:59.497803 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:58:59.498804 [info ] [MainThread]: 
[0m18:58:59.499804 [info ] [MainThread]: Running 1 on-run-start hook
[0m18:58:59.521823 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m18:58:59.529803 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m18:58:59.531803 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m18:58:59.533806 [info ] [MainThread]: 
[0m18:58:59.534804 [debug] [MainThread]: On master: Close
[0m18:58:59.537808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:59.539804 [info ] [MainThread]: 
[0m18:58:59.546804 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m18:58:59.548804 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m18:58:59.549804 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m18:58:59.556803 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m18:58:59.558803 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 18:58:59.550805 => 18:58:59.557803
[0m18:58:59.561807 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m18:58:59.562804 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m18:58:59.564803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m18:58:59.565807 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m18:58:59.571804 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m18:58:59.574804 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 18:58:59.566808 => 18:58:59.573804
[0m18:58:59.577809 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m18:58:59.579803 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m18:58:59.581803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m18:58:59.582804 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m18:58:59.591807 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m18:58:59.594804 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 18:58:59.583808 => 18:58:59.593805
[0m18:58:59.597804 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m18:58:59.599804 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m18:58:59.601805 [info ] [Thread-1 (]: 1 of 16 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m18:58:59.603804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m18:58:59.604804 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m18:58:59.605803 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 18:58:59.605803 => 18:58:59.605803
[0m18:58:59.606803 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m18:58:59.667803 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:58:59.668801 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m18:58:59.669803 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:58:59.685805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:58:59.687804 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:58:59.689804 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m18:58:59.691804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:58:59.716806 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:58:59.717805 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'c:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:58:59.731803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:58:59.742806 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m18:58:59.777803 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:58:59.779804 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m18:58:59.780806 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m18:58:59.787804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:58:59.789804 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 18:58:59.607804 => 18:58:59.789804
[0m18:58:59.791805 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m18:58:59.807808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B7A72D0>]}
[0m18:58:59.809805 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file main.seed_full_moon_dates .......................... [[32mINSERT 272[0m in 0.20s]
[0m18:58:59.811804 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m18:58:59.812808 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m18:58:59.813805 [info ] [Thread-1 (]: 2 of 16 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m18:58:59.816804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m18:58:59.818805 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m18:58:59.827805 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 18:58:59.819804 => 18:58:59.827805
[0m18:58:59.828805 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m18:58:59.890804 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m18:58:59.892803 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:58:59.894805 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m18:58:59.896806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:59.910805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:58:59.911805 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:58:59.912806 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m18:58:59.944805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:58:59.950806 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:58:59.951804 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m18:58:59.953806 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m18:58:59.993805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:58:59.997809 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 18:58:59.829806 => 18:58:59.996808
[0m18:58:59.999805 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m18:59:00.109804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B51B1D0>]}
[0m18:59:00.111808 [info ] [Thread-1 (]: 2 of 16 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.29s]
[0m18:59:00.115807 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m18:59:00.116806 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m18:59:00.118806 [info ] [Thread-1 (]: 3 of 16 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m18:59:00.121806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m18:59:00.123806 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m18:59:00.150804 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:59:00.166806 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 18:59:00.125806 => 18:59:00.161805
[0m18:59:00.172805 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m18:59:00.240804 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m18:59:00.243804 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:59:00.245804 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m18:59:00.246806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:00.267806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.269804 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:59:00.270804 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m18:59:00.273805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.285806 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:59:00.287805 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m18:59:00.289805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.293805 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m18:59:00.295806 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:59:00.296805 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m18:59:00.301805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.311806 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m18:59:00.312807 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."main"."dim_hosts_cleansed__dbt_backup" cascade
[0m18:59:00.314804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.318804 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 18:59:00.175804 => 18:59:00.317805
[0m18:59:00.319803 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m18:59:00.336804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B571090>]}
[0m18:59:00.338805 [info ] [Thread-1 (]: 3 of 16 OK created sql view model main.dim_hosts_cleansed ...................... [[32mOK[0m in 0.22s]
[0m18:59:00.345804 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m18:59:00.347804 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m18:59:00.349805 [info ] [Thread-1 (]: 4 of 16 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m18:59:00.352806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m18:59:00.354805 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m18:59:00.381544 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:59:00.384544 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 18:59:00.356806 => 18:59:00.384544
[0m18:59:00.386545 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m18:59:00.398546 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m18:59:00.401546 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:59:00.402544 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m18:59:00.403544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:00.426546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.427545 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:59:00.429544 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(REPLACE(price_str, '$', '') AS DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m18:59:00.432546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.440546 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:59:00.442545 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */
alter view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m18:59:00.444544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.449546 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: COMMIT
[0m18:59:00.451546 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:59:00.452546 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: COMMIT
[0m18:59:00.457546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.466544 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m18:59:00.467544 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."main"."dim_listings_cleansed__dbt_backup" cascade
[0m18:59:00.470546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.475544 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 18:59:00.387546 => 18:59:00.474546
[0m18:59:00.477545 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m18:59:00.493544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B4CC090>]}
[0m18:59:00.495545 [info ] [Thread-1 (]: 4 of 16 OK created sql view model main.dim_listings_cleansed ................... [[32mOK[0m in 0.14s]
[0m18:59:00.498544 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m18:59:00.499545 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m18:59:00.502546 [info ] [Thread-1 (]: 5 of 16 START sql incremental model main.fct_reviews ........................... [RUN]
[0m18:59:00.505545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m18:59:00.506545 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m18:59:00.562546 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m18:59:00.565545 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 18:59:00.507545 => 18:59:00.564545
[0m18:59:00.566544 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m18:59:00.688547 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m18:59:00.692546 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:59:00.695546 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m18:59:00.697546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:00.738546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:00.739545 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:59:00.740545 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m18:59:01.693544 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m18:59:01.696545 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:59:01.697545 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m18:59:01.697545 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m18:59:02.245547 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m18:59:02.250546 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 18:59:00.567545 => 18:59:02.249547
[0m18:59:02.252547 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m18:59:02.302548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B3DD150>]}
[0m18:59:02.304547 [info ] [Thread-1 (]: 5 of 16 OK created sql incremental model main.fct_reviews ...................... [[32mOK[0m in 1.80s]
[0m18:59:02.306547 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m18:59:02.308547 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:59:02.311547 [info ] [Thread-1 (]: 6 of 16 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m18:59:02.314548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.fct_reviews, now test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m18:59:02.317547 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:59:02.351546 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m18:59:02.355547 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 18:59:02.319547 => 18:59:02.353546
[0m18:59:02.357546 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:59:02.402122 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m18:59:02.406125 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m18:59:02.408121 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: BEGIN
[0m18:59:02.409121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.427122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.428123 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m18:59:02.429121 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from "AIRBNB"."main"."dim_listings_cleansed"
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m18:59:02.434122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.437122 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 18:59:02.358546 => 18:59:02.437122
[0m18:59:02.439120 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: ROLLBACK
[0m18:59:02.441122 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m18:59:02.442122 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m18:59:02.446120 [info ] [Thread-1 (]: 6 of 16 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.13s]
[0m18:59:02.448122 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m18:59:02.449120 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:59:02.450122 [info ] [Thread-1 (]: 7 of 16 START test dim_listings_minimum_nights ................................. [RUN]
[0m18:59:02.452121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.learn_duckdb.dim_listings_minimum_nights)
[0m18:59:02.453121 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.dim_listings_minimum_nights
[0m18:59:02.459120 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.dim_listings_minimum_nights"
[0m18:59:02.462125 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.dim_listings_minimum_nights (compile): 18:59:02.454119 => 18:59:02.461121
[0m18:59:02.463122 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.dim_listings_minimum_nights
[0m18:59:02.467121 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.dim_listings_minimum_nights"
[0m18:59:02.470121 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.dim_listings_minimum_nights"
[0m18:59:02.472121 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: BEGIN
[0m18:59:02.474122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.488122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.489122 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.dim_listings_minimum_nights"
[0m18:59:02.490122 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    "AIRBNB"."main"."dim_listings_cleansed"
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m18:59:02.495121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.499120 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.dim_listings_minimum_nights (execute): 18:59:02.464121 => 18:59:02.498120
[0m18:59:02.500121 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: ROLLBACK
[0m18:59:02.501122 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.dim_listings_minimum_nights'
[0m18:59:02.502122 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: Close
[0m18:59:02.506123 [info ] [Thread-1 (]: 7 of 16 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 0.06s]
[0m18:59:02.508122 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m18:59:02.509121 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:59:02.510122 [info ] [Thread-1 (]: 8 of 16 START test no_nulls_in_dim_listings .................................... [RUN]
[0m18:59:02.513121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.dim_listings_minimum_nights, now test.learn_duckdb.no_nulls_in_dim_listings)
[0m18:59:02.515121 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:59:02.538119 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m18:59:02.540118 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: BEGIN
[0m18:59:02.543121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.555122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.556121 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m18:59:02.558120 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'dim_listings_cleansed'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'AIRBNB'
      
      order by ordinal_position

  
[0m18:59:02.632119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.638120 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.no_nulls_in_dim_listings"
[0m18:59:02.641120 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.no_nulls_in_dim_listings (compile): 18:59:02.516122 => 18:59:02.640120
[0m18:59:02.642120 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:59:02.648120 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.no_nulls_in_dim_listings"
[0m18:59:02.650121 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m18:59:02.651120 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM "AIRBNB"."main"."dim_listings_cleansed" WHERE
    
    FALSE

      
    ) dbt_internal_test
[0m18:59:02.655122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.658120 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.no_nulls_in_dim_listings (execute): 18:59:02.643121 => 18:59:02.658120
[0m18:59:02.659121 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: ROLLBACK
[0m18:59:02.661121 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.no_nulls_in_dim_listings'
[0m18:59:02.662121 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: Close
[0m18:59:02.667119 [info ] [Thread-1 (]: 8 of 16 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 0.15s]
[0m18:59:02.669120 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m18:59:02.670121 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:59:02.672122 [info ] [Thread-1 (]: 9 of 16 START test not_null_dim_listings_cleansed_host_id ...................... [RUN]
[0m18:59:02.675121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.no_nulls_in_dim_listings, now test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m18:59:02.677122 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:59:02.688121 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m18:59:02.691122 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 18:59:02.678122 => 18:59:02.690121
[0m18:59:02.693121 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:59:02.700121 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m18:59:02.702120 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m18:59:02.703121 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: BEGIN
[0m18:59:02.704121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.717122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.718122 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m18:59:02.719121 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "AIRBNB"."main"."dim_listings_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m18:59:02.723124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.726120 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 18:59:02.695123 => 18:59:02.725121
[0m18:59:02.727121 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: ROLLBACK
[0m18:59:02.730122 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m18:59:02.730122 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m18:59:02.734120 [info ] [Thread-1 (]: 9 of 16 PASS not_null_dim_listings_cleansed_host_id ............................ [[32mPASS[0m in 0.06s]
[0m18:59:02.735120 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m18:59:02.737122 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:59:02.738120 [info ] [Thread-1 (]: 10 of 16 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m18:59:02.741122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m18:59:02.742121 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:59:02.751120 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m18:59:02.753121 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 18:59:02.743122 => 18:59:02.752122
[0m18:59:02.755122 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:59:02.763122 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m18:59:02.766122 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m18:59:02.767121 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: BEGIN
[0m18:59:02.768122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.779122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.781120 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m18:59:02.782122 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from "AIRBNB"."main"."dim_listings_cleansed"
where listing_id is null



      
    ) dbt_internal_test
[0m18:59:02.785120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.788120 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 18:59:02.756121 => 18:59:02.788120
[0m18:59:02.789119 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: ROLLBACK
[0m18:59:02.791121 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m18:59:02.793124 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m18:59:02.797121 [info ] [Thread-1 (]: 10 of 16 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.06s]
[0m18:59:02.799121 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m18:59:02.800121 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:59:02.800121 [info ] [Thread-1 (]: 11 of 16 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m18:59:02.802120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313)
[0m18:59:02.803120 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:59:02.813118 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m18:59:02.816120 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 18:59:02.804120 => 18:59:02.815118
[0m18:59:02.817120 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:59:02.822122 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m18:59:02.824120 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m18:59:02.826120 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: BEGIN
[0m18:59:02.827120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.838120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.839118 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m18:59:02.840119 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    "AIRBNB"."main"."dim_listings_cleansed"
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m18:59:02.843119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.846121 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 18:59:02.818122 => 18:59:02.846121
[0m18:59:02.847119 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: ROLLBACK
[0m18:59:02.848122 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m18:59:02.849120 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m18:59:02.854121 [info ] [Thread-1 (]: 11 of 16 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.05s]
[0m18:59:02.856120 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m18:59:02.858120 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:59:02.860120 [info ] [Thread-1 (]: 12 of 16 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m18:59:02.863122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313, now test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m18:59:02.864121 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:59:02.876121 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m18:59:02.879121 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 18:59:02.865122 => 18:59:02.878123
[0m18:59:02.881121 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:59:02.886120 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m18:59:02.888120 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m18:59:02.889122 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: BEGIN
[0m18:59:02.890121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.903122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.904121 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m18:59:02.905122 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from "AIRBNB"."main"."dim_listings_cleansed"
    where host_id is not null
),

parent as (
    select host_id as to_field
    from "AIRBNB"."main"."dim_hosts_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:59:02.914122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.917122 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 18:59:02.882121 => 18:59:02.917122
[0m18:59:02.919121 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: ROLLBACK
[0m18:59:02.920122 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m18:59:02.921121 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m18:59:02.925122 [info ] [Thread-1 (]: 12 of 16 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.06s]
[0m18:59:02.927122 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m18:59:02.929121 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:59:02.930120 [info ] [Thread-1 (]: 13 of 16 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m18:59:02.931120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m18:59:02.932121 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:59:02.941125 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m18:59:02.944122 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 18:59:02.933121 => 18:59:02.943120
[0m18:59:02.946122 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:59:02.954121 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m18:59:02.958122 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m18:59:02.959122 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: BEGIN
[0m18:59:02.960122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.972120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.973120 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m18:59:02.974121 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from "AIRBNB"."main"."dim_listings_cleansed"
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:59:02.981121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:02.984121 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 18:59:02.947122 => 18:59:02.983120
[0m18:59:02.985121 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: ROLLBACK
[0m18:59:02.987120 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m18:59:02.988120 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m18:59:02.992122 [info ] [Thread-1 (]: 13 of 16 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.06s]
[0m18:59:02.993121 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m18:59:02.994124 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:59:02.995124 [info ] [Thread-1 (]: 14 of 16 START sql table model main.mart_fullmoon_reviews ...................... [RUN]
[0m18:59:02.997122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e, now model.learn_duckdb.mart_fullmoon_reviews)
[0m18:59:02.998122 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m18:59:03.003120 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:59:03.005120 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 18:59:02.999122 => 18:59:03.005120
[0m18:59:03.006123 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m18:59:03.026119 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:59:03.029120 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:59:03.031121 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m18:59:03.033121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:03.042120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:03.043121 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m18:59:03.044121 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date)  strptime('02/03/1992', '%Y-%m-%d') = (fm.full_moon_date + 1))
    );
  
  
[0m18:59:03.046122 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 18:59:03.007121 => 18:59:03.045121
[0m18:59:03.047122 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m18:59:03.057118 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m18:59:03.058118 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m18:59:03.069122 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Parser Error: syntax error at or near "strptime"
[0m18:59:03.071122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B848310>]}
[0m18:59:03.073122 [error] [Thread-1 (]: 14 of 16 ERROR creating sql table model main.mart_fullmoon_reviews ............. [[31mERROR[0m in 0.08s]
[0m18:59:03.075122 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m18:59:03.077122 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m18:59:03.079127 [info ] [Thread-1 (]: 15 of 16 START test consistent_created_at ...................................... [RUN]
[0m18:59:03.082123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.mart_fullmoon_reviews, now test.learn_duckdb.consistent_created_at)
[0m18:59:03.083123 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.consistent_created_at
[0m18:59:03.094124 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.consistent_created_at"
[0m18:59:03.098122 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.consistent_created_at (compile): 18:59:03.084122 => 18:59:03.097122
[0m18:59:03.100123 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.consistent_created_at
[0m18:59:03.108123 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.consistent_created_at"
[0m18:59:03.111123 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.consistent_created_at"
[0m18:59:03.113125 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: BEGIN
[0m18:59:03.115123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:03.133124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:03.135122 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.consistent_created_at"
[0m18:59:03.137121 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM "AIRBNB"."main"."dim_listings_cleansed" l
INNER JOIN "AIRBNB"."main"."fct_reviews" f
USING (listing_id)
WHERE f.review_date <= l.created_at
LIMIT 10
      
    ) dbt_internal_test
[0m18:59:03.169122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:03.175122 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.consistent_created_at (execute): 18:59:03.101125 => 18:59:03.174122
[0m18:59:03.176123 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: ROLLBACK
[0m18:59:03.179122 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.consistent_created_at'
[0m18:59:03.180122 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: Close
[0m18:59:03.191123 [info ] [Thread-1 (]: 15 of 16 PASS consistent_created_at ............................................ [[32mPASS[0m in 0.11s]
[0m18:59:03.195122 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m18:59:03.197122 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m18:59:03.199122 [info ] [Thread-1 (]: 16 of 16 START sql table model main.dim_listings_w_hosts ....................... [RUN]
[0m18:59:03.204125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.consistent_created_at, now model.learn_duckdb.dim_listings_w_hosts)
[0m18:59:03.209123 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_w_hosts
[0m18:59:03.237122 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_w_hosts"
[0m18:59:03.243123 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_w_hosts (compile): 18:59:03.217126 => 18:59:03.242123
[0m18:59:03.245123 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_w_hosts
[0m18:59:03.332122 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_w_hosts"
[0m18:59:03.335122 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m18:59:03.337123 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: BEGIN
[0m18:59:03.338122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:03.351121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:03.352122 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m18:59:03.353122 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_w_hosts"} */

  
    
    

    create  table
      "AIRBNB"."main"."dim_listings_w_hosts__dbt_tmp"
  
    as (
      WITH 
l AS (
    SELECT 
        * 
    FROM
        "AIRBNB"."main"."dim_listings_cleansed"
),
h AS (
    SELECT
        *
    FROM
        "AIRBNB"."main"."dim_hosts_cleansed"
)

SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
    );
  
  
[0m18:59:03.387736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:03.396738 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m18:59:03.398738 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_w_hosts"} */
alter table "AIRBNB"."main"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m18:59:03.400737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:03.404737 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: COMMIT
[0m18:59:03.405736 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m18:59:03.406736 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: COMMIT
[0m18:59:03.435735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:03.441736 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m18:59:03.443735 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_w_hosts"} */
drop table if exists "AIRBNB"."main"."dim_listings_w_hosts__dbt_backup" cascade
[0m18:59:03.445736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:59:03.449736 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_w_hosts (execute): 18:59:03.247122 => 18:59:03.449736
[0m18:59:03.451735 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: Close
[0m18:59:03.505737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e71f1-1b33-4e1f-833f-ded29ab3119e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B8EA250>]}
[0m18:59:03.507737 [info ] [Thread-1 (]: 16 of 16 OK created sql table model main.dim_listings_w_hosts .................. [[32mOK[0m in 0.30s]
[0m18:59:03.509737 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m18:59:03.512736 [debug] [MainThread]: Using duckdb connection "master"
[0m18:59:03.513737 [debug] [MainThread]: On master: BEGIN
[0m18:59:03.514738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:03.532736 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:59:03.533736 [debug] [MainThread]: On master: COMMIT
[0m18:59:03.534735 [debug] [MainThread]: Using duckdb connection "master"
[0m18:59:03.535737 [debug] [MainThread]: On master: COMMIT
[0m18:59:03.536736 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:59:03.537739 [debug] [MainThread]: On master: Close
[0m18:59:03.540739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:03.541737 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m18:59:03.542738 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m18:59:03.544737 [debug] [MainThread]: Connection 'model.learn_duckdb.dim_listings_w_hosts' was properly closed.
[0m18:59:03.545737 [info ] [MainThread]: 
[0m18:59:03.547737 [info ] [MainThread]: Finished running 1 seed, 1 snapshot, 2 view models, 1 incremental model, 9 tests, 2 table models, 1 hook in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m18:59:03.552738 [debug] [MainThread]: Command end result
[0m18:59:03.575736 [info ] [MainThread]: 
[0m18:59:03.577739 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:59:03.579740 [info ] [MainThread]: 
[0m18:59:03.581736 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Parser Error: syntax error at or near "strptime"
[0m18:59:03.584740 [info ] [MainThread]: 
[0m18:59:03.587739 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m18:59:03.594736 [debug] [MainThread]: Command `dbt build` failed at 18:59:03.593737 after 5.23 seconds
[0m18:59:03.596737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1B203D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC14727CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1AE6F150>]}
[0m18:59:03.598737 [debug] [MainThread]: Flushing usage events
[0m19:00:25.003653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E703338D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6FDEDCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E70315910>]}


============================== 19:00:25.008649 | 4dc8982f-003b-477a-b820-20af73d01d85 ==============================
[0m19:00:25.008649 [info ] [MainThread]: Running with dbt=1.7.11
[0m19:00:25.010643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select mart_fullmoon_reviews', 'send_anonymous_usage_stats': 'True'}
[0m19:00:25.323654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dc8982f-003b-477a-b820-20af73d01d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E703507D0>]}
[0m19:00:25.419258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dc8982f-003b-477a-b820-20af73d01d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E70466D10>]}
[0m19:00:25.422245 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m19:00:25.438257 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m19:00:25.654252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:25.654252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:25.662253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dc8982f-003b-477a-b820-20af73d01d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E70716950>]}
[0m19:00:25.685242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dc8982f-003b-477a-b820-20af73d01d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E7060FE10>]}
[0m19:00:25.686241 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m19:00:25.689240 [info ] [MainThread]: 
[0m19:00:25.691243 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:00:25.693242 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m19:00:25.708258 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m19:00:25.709239 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m19:00:25.710259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:25.724237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.726248 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:00:25.732241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m19:00:25.734242 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m19:00:25.744241 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:00:25.744241 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m19:00:25.746241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:25.756237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.758253 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:00:25.759253 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m19:00:25.760237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.761238 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:00:25.763253 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m19:00:25.765258 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.767238 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:00:25.768258 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:00:25.769240 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:00:25.770240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.771241 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m19:00:25.778241 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m19:00:25.786241 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:00:25.787242 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m19:00:25.788242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:25.797241 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.797241 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:00:25.798242 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m19:00:25.833240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.834241 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m19:00:25.836242 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m19:00:25.837242 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m19:00:25.841238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m19:00:25.844237 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:00:25.845237 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m19:00:25.846239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:25.854239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.855238 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:00:25.856236 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m19:00:25.889238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:00:25.891242 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m19:00:25.892241 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m19:00:25.893242 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:00:25.897237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dc8982f-003b-477a-b820-20af73d01d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E70472F50>]}
[0m19:00:25.898239 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:25.899239 [debug] [MainThread]: On master: BEGIN
[0m19:00:25.900241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:25.909241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:00:25.910238 [debug] [MainThread]: On master: COMMIT
[0m19:00:25.910238 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:25.911240 [debug] [MainThread]: On master: COMMIT
[0m19:00:25.912239 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:00:25.913239 [info ] [MainThread]: 
[0m19:00:25.914239 [info ] [MainThread]: Running 1 on-run-start hook
[0m19:00:25.935237 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m19:00:25.940240 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m19:00:25.942239 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m19:00:25.944237 [info ] [MainThread]: 
[0m19:00:25.946241 [debug] [MainThread]: On master: Close
[0m19:00:25.949244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:25.950769 [info ] [MainThread]: 
[0m19:00:25.955578 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:00:25.956587 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_fullmoon_reviews ........................ [RUN]
[0m19:00:25.958588 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.mart_fullmoon_reviews'
[0m19:00:25.959592 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m19:00:25.965602 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:00:25.967604 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 19:00:25.960593 => 19:00:25.967604
[0m19:00:25.968588 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m19:00:26.008607 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:00:26.010587 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:00:26.011587 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m19:00:26.012587 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:26.021607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:00:26.021607 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:00:26.022607 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (strptime('02/03/1992', '%Y-%m-%d') = (fm.full_moon_date + 1))
    );
  
  
[0m19:00:26.028607 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 19:00:25.969588 => 19:00:26.028607
[0m19:00:26.029607 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m19:00:26.038587 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m19:00:26.039587 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m19:00:26.045607 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Invalid Input Error: Could not parse string "02/03/1992" according to format specifier "%Y-%m-%d"
  02/03/1992
     ^
  Error: Literal does not match, expected -
[0m19:00:26.046607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc8982f-003b-477a-b820-20af73d01d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E7071F610>]}
[0m19:00:26.047591 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.mart_fullmoon_reviews ............... [[31mERROR[0m in 0.09s]
[0m19:00:26.048587 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:00:26.051607 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:26.051607 [debug] [MainThread]: On master: BEGIN
[0m19:00:26.052607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:26.062588 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:00:26.063591 [debug] [MainThread]: On master: COMMIT
[0m19:00:26.064588 [debug] [MainThread]: Using duckdb connection "master"
[0m19:00:26.065587 [debug] [MainThread]: On master: COMMIT
[0m19:00:26.066587 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:00:26.066587 [debug] [MainThread]: On master: Close
[0m19:00:26.069608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:26.070607 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m19:00:26.071588 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m19:00:26.072589 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m19:00:26.073596 [info ] [MainThread]: 
[0m19:00:26.074588 [info ] [MainThread]: Finished running 1 table model, 1 hook in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:00:26.075588 [debug] [MainThread]: Command end result
[0m19:00:26.094591 [info ] [MainThread]: 
[0m19:00:26.095589 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:00:26.097589 [info ] [MainThread]: 
[0m19:00:26.098590 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Invalid Input Error: Could not parse string "02/03/1992" according to format specifier "%Y-%m-%d"
  02/03/1992
     ^
  Error: Literal does not match, expected -
[0m19:00:26.100588 [info ] [MainThread]: 
[0m19:00:26.101587 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:00:26.105590 [debug] [MainThread]: Command `dbt build` failed at 19:00:26.105590 after 1.17 seconds
[0m19:00:26.107590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E697D7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E702FE210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E702FCD10>]}
[0m19:00:26.108590 [debug] [MainThread]: Flushing usage events
[0m19:08:18.005611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3EFDF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F3D2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F3D2C90>]}


============================== 19:08:18.010612 | c37f8eb6-9d1e-4ff9-9b46-32d90e43d513 ==============================
[0m19:08:18.010612 [info ] [MainThread]: Running with dbt=1.7.11
[0m19:08:18.012591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select mart_fullmoon_reviews', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:08:18.337611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c37f8eb6-9d1e-4ff9-9b46-32d90e43d513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F555010>]}
[0m19:08:18.442611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c37f8eb6-9d1e-4ff9-9b46-32d90e43d513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F4B1010>]}
[0m19:08:18.444592 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m19:08:18.462592 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m19:08:18.684238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:08:18.685237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:08:18.694239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c37f8eb6-9d1e-4ff9-9b46-32d90e43d513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F761890>]}
[0m19:08:18.716218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c37f8eb6-9d1e-4ff9-9b46-32d90e43d513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F6AFE10>]}
[0m19:08:18.717218 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m19:08:18.720218 [info ] [MainThread]: 
[0m19:08:18.722238 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:08:18.724223 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m19:08:18.739222 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m19:08:18.740222 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m19:08:18.741221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:18.756223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.758222 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:08:18.764220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m19:08:18.765219 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m19:08:18.774222 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:08:18.775222 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m19:08:18.776222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:18.787219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.789218 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:08:18.790218 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m19:08:18.791222 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.792219 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:08:18.793218 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m19:08:18.794220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.795221 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:08:18.796220 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:08:18.797218 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:08:18.798220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.799227 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m19:08:18.804218 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m19:08:18.812219 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:08:18.813219 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m19:08:18.814220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:18.824220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.824220 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:08:18.826223 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m19:08:18.861222 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.863222 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m19:08:18.865222 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m19:08:18.866224 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:08:18.870218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m19:08:18.873218 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:08:18.874219 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m19:08:18.875220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:18.884222 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.885222 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:08:18.885222 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m19:08:18.920220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:18.922222 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m19:08:18.923222 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m19:08:18.924222 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m19:08:18.928220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c37f8eb6-9d1e-4ff9-9b46-32d90e43d513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F4A0650>]}
[0m19:08:18.929218 [debug] [MainThread]: Using duckdb connection "master"
[0m19:08:18.930217 [debug] [MainThread]: On master: BEGIN
[0m19:08:18.931220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:18.945218 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:08:18.946217 [debug] [MainThread]: On master: COMMIT
[0m19:08:18.947217 [debug] [MainThread]: Using duckdb connection "master"
[0m19:08:18.948220 [debug] [MainThread]: On master: COMMIT
[0m19:08:18.949218 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:08:18.949218 [info ] [MainThread]: 
[0m19:08:18.951217 [info ] [MainThread]: Running 1 on-run-start hook
[0m19:08:18.973218 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m19:08:18.981219 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m19:08:18.983222 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m19:08:18.984220 [info ] [MainThread]: 
[0m19:08:18.985218 [debug] [MainThread]: On master: Close
[0m19:08:18.988220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:08:18.990223 [info ] [MainThread]: 
[0m19:08:18.995219 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:08:18.996220 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_fullmoon_reviews ........................ [RUN]
[0m19:08:18.998218 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.mart_fullmoon_reviews'
[0m19:08:18.999239 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m19:08:19.004234 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:19.006221 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 19:08:18.999239 => 19:08:19.006221
[0m19:08:19.007218 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m19:08:19.047218 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:19.049219 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:19.051218 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m19:08:19.052218 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:08:19.062218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:08:19.063218 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:19.064218 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (date_trunc('day', r.review_date)  strptime('02/03/1992', '%Y-%m-%d') = (fm.full_moon_date + 1))
    );
  
  
[0m19:08:19.066218 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 19:08:19.007218 => 19:08:19.065218
[0m19:08:19.066218 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: ROLLBACK
[0m19:08:19.074217 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.mart_fullmoon_reviews'
[0m19:08:19.075216 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m19:08:19.082217 [debug] [Thread-1 (]: Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Parser Error: syntax error at or near "strptime"
[0m19:08:19.083216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c37f8eb6-9d1e-4ff9-9b46-32d90e43d513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F404410>]}
[0m19:08:19.084219 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.mart_fullmoon_reviews ............... [[31mERROR[0m in 0.08s]
[0m19:08:19.085219 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:08:19.088218 [debug] [MainThread]: Using duckdb connection "master"
[0m19:08:19.088218 [debug] [MainThread]: On master: BEGIN
[0m19:08:19.089217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:19.105239 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:08:19.107238 [debug] [MainThread]: On master: COMMIT
[0m19:08:19.108239 [debug] [MainThread]: Using duckdb connection "master"
[0m19:08:19.109218 [debug] [MainThread]: On master: COMMIT
[0m19:08:19.110217 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:08:19.111218 [debug] [MainThread]: On master: Close
[0m19:08:19.114783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:19.115785 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m19:08:19.115785 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m19:08:19.116784 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m19:08:19.117784 [info ] [MainThread]: 
[0m19:08:19.118800 [info ] [MainThread]: Finished running 1 table model, 1 hook in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:08:19.120780 [debug] [MainThread]: Command end result
[0m19:08:19.143779 [info ] [MainThread]: 
[0m19:08:19.145801 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:08:19.147781 [info ] [MainThread]: 
[0m19:08:19.148802 [error] [MainThread]:   Runtime Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  Parser Error: syntax error at or near "strptime"
[0m19:08:19.150780 [info ] [MainThread]: 
[0m19:08:19.152784 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:08:19.156783 [debug] [MainThread]: Command `dbt build` failed at 19:08:19.155784 after 1.22 seconds
[0m19:08:19.157801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F388D7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F398550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F3F4BE590>]}
[0m19:08:19.158781 [debug] [MainThread]: Flushing usage events
[0m19:08:36.017514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D62A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D622350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D6207D0>]}


============================== 19:08:36.023513 | 5c365a3d-ebcd-45b6-996b-5e7d960197e7 ==============================
[0m19:08:36.023513 [info ] [MainThread]: Running with dbt=1.7.11
[0m19:08:36.025519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select mart_fullmoon_reviews', 'send_anonymous_usage_stats': 'True'}
[0m19:08:36.359518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c365a3d-ebcd-45b6-996b-5e7d960197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D7BFD50>]}
[0m19:08:36.453499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c365a3d-ebcd-45b6-996b-5e7d960197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D10E110>]}
[0m19:08:36.455501 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m19:08:36.472501 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m19:08:36.697063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:08:36.698061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:08:36.706060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c365a3d-ebcd-45b6-996b-5e7d960197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D651ED0>]}
[0m19:08:36.728060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c365a3d-ebcd-45b6-996b-5e7d960197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D933E10>]}
[0m19:08:36.729043 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m19:08:36.733061 [info ] [MainThread]: 
[0m19:08:36.734040 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:08:36.736044 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m19:08:36.752046 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m19:08:36.753047 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m19:08:36.754045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:36.768039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.770061 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:08:36.775044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m19:08:36.776041 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m19:08:36.789061 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:08:36.790060 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m19:08:36.791040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:36.802044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.804061 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:08:36.805044 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m19:08:36.807061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.807061 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:08:36.808061 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m19:08:36.809044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.811044 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:08:36.811044 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:08:36.812043 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:08:36.813041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.814041 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m19:08:36.820041 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m19:08:36.828041 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:08:36.829041 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m19:08:36.831046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:36.839061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.840061 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:08:36.841061 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m19:08:36.888042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.890040 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m19:08:36.892041 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m19:08:36.893042 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m19:08:36.898040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m19:08:36.901039 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:08:36.902040 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m19:08:36.902040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:36.911040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.912039 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:08:36.913039 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m19:08:36.949039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:08:36.951039 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m19:08:36.952041 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m19:08:36.954043 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:08:36.959041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c365a3d-ebcd-45b6-996b-5e7d960197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D671950>]}
[0m19:08:36.960040 [debug] [MainThread]: Using duckdb connection "master"
[0m19:08:36.961040 [debug] [MainThread]: On master: BEGIN
[0m19:08:36.962041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:36.971039 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:08:36.972040 [debug] [MainThread]: On master: COMMIT
[0m19:08:36.973039 [debug] [MainThread]: Using duckdb connection "master"
[0m19:08:36.974040 [debug] [MainThread]: On master: COMMIT
[0m19:08:36.975042 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:08:36.976041 [info ] [MainThread]: 
[0m19:08:36.977040 [info ] [MainThread]: Running 1 on-run-start hook
[0m19:08:37.001057 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m19:08:37.006060 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m19:08:37.008045 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m19:08:37.009044 [info ] [MainThread]: 
[0m19:08:37.011041 [debug] [MainThread]: On master: Close
[0m19:08:37.015041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:08:37.017057 [info ] [MainThread]: 
[0m19:08:37.022040 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:08:37.023052 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_fullmoon_reviews ........................ [RUN]
[0m19:08:37.024041 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.mart_fullmoon_reviews'
[0m19:08:37.025046 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m19:08:37.032062 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:37.034040 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 19:08:37.026043 => 19:08:37.033062
[0m19:08:37.035040 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m19:08:37.077061 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:37.079040 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:37.081042 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m19:08:37.082040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:08:37.090061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:08:37.091060 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:37.092060 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (date_trunc('day', r.review_date) = (fm.full_moon_date + 1))
    );
  
  
[0m19:08:37.500050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:08:37.507044 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:37.508044 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */
alter table "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp" rename to "mart_fullmoon_reviews"
[0m19:08:37.509045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:08:37.529060 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: COMMIT
[0m19:08:37.530061 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:37.531060 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: COMMIT
[0m19:08:38.057733 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m19:08:38.065731 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m19:08:38.066736 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */
drop table if exists "AIRBNB"."main"."mart_fullmoon_reviews__dbt_backup" cascade
[0m19:08:38.067735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:08:38.070735 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 19:08:37.035040 => 19:08:38.069734
[0m19:08:38.070735 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m19:08:38.105729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c365a3d-ebcd-45b6-996b-5e7d960197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D893490>]}
[0m19:08:38.106730 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.mart_fullmoon_reviews ................... [[32mOK[0m in 1.08s]
[0m19:08:38.107729 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:08:38.111746 [debug] [MainThread]: Using duckdb connection "master"
[0m19:08:38.112746 [debug] [MainThread]: On master: BEGIN
[0m19:08:38.112746 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:38.128729 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:08:38.129729 [debug] [MainThread]: On master: COMMIT
[0m19:08:38.130731 [debug] [MainThread]: Using duckdb connection "master"
[0m19:08:38.132732 [debug] [MainThread]: On master: COMMIT
[0m19:08:38.133751 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:08:38.134750 [debug] [MainThread]: On master: Close
[0m19:08:38.137729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:38.138730 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m19:08:38.139730 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m19:08:38.139730 [debug] [MainThread]: Connection 'model.learn_duckdb.mart_fullmoon_reviews' was properly closed.
[0m19:08:38.140730 [info ] [MainThread]: 
[0m19:08:38.141731 [info ] [MainThread]: Finished running 1 table model, 1 hook in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m19:08:38.143730 [debug] [MainThread]: Command end result
[0m19:08:38.162733 [info ] [MainThread]: 
[0m19:08:38.165733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:08:38.166733 [info ] [MainThread]: 
[0m19:08:38.167730 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:08:38.170735 [debug] [MainThread]: Command `dbt build` succeeded at 19:08:38.170735 after 2.22 seconds
[0m19:08:38.171732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018076AD7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807C4DEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807D1DB010>]}
[0m19:08:38.172732 [debug] [MainThread]: Flushing usage events
[0m19:09:36.349527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF132A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF121BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF122050>]}


============================== 19:09:36.356529 | 3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553 ==============================
[0m19:09:36.356529 [info ] [MainThread]: Running with dbt=1.7.11
[0m19:09:36.358528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:09:36.677358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF18B510>]}
[0m19:09:36.771489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF3B6090>]}
[0m19:09:36.774486 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m19:09:36.791513 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m19:09:37.011489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:37.012488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:37.021474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF52F990>]}
[0m19:09:37.044495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF41FB90>]}
[0m19:09:37.046476 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 operation, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m19:09:37.048475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF327B10>]}
[0m19:09:37.053489 [info ] [MainThread]: 
[0m19:09:37.055474 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:09:37.057475 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m19:09:37.073473 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m19:09:37.074479 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m19:09:37.075475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:37.090475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.093490 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:09:37.097500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m19:09:37.098490 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m19:09:37.109477 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:09:37.110475 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m19:09:37.110475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:37.121474 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.123476 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:09:37.124476 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m19:09:37.125477 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.126476 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:09:37.126476 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m19:09:37.127476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.129477 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:09:37.130494 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:09:37.130494 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:09:37.131475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.132476 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m19:09:37.137473 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m19:09:37.145489 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:09:37.146477 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m19:09:37.146477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:37.156481 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.157472 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:09:37.158472 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m19:09:37.193488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.195487 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m19:09:37.197486 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m19:09:37.198494 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:09:37.202493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m19:09:37.205493 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:09:37.206493 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m19:09:37.207494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:37.216502 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.216502 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:09:37.217493 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m19:09:37.252488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:09:37.254488 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m19:09:37.255476 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m19:09:37.255476 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m19:09:37.260494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF27F4D0>]}
[0m19:09:37.261494 [debug] [MainThread]: Using duckdb connection "master"
[0m19:09:37.262475 [debug] [MainThread]: On master: BEGIN
[0m19:09:37.264474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:37.273477 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:09:37.274477 [debug] [MainThread]: On master: COMMIT
[0m19:09:37.275477 [debug] [MainThread]: Using duckdb connection "master"
[0m19:09:37.276478 [debug] [MainThread]: On master: COMMIT
[0m19:09:37.277478 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:09:37.278478 [info ] [MainThread]: 
[0m19:09:37.279495 [info ] [MainThread]: Running 1 on-run-start hook
[0m19:09:37.303474 [debug] [MainThread]: Writing injected SQL for node "operation.learn_duckdb.learn_duckdb-on-run-start-0"
[0m19:09:37.309472 [info ] [MainThread]: 1 of 1 START hook: learn_duckdb.on-run-start.0 ................................. [RUN]
[0m19:09:37.311478 [info ] [MainThread]: 1 of 1 OK hook: learn_duckdb.on-run-start.0 .................................... [[32mOK[0m in 0.00s]
[0m19:09:37.312478 [info ] [MainThread]: 
[0m19:09:37.313474 [debug] [MainThread]: On master: Close
[0m19:09:37.317475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:37.318475 [info ] [MainThread]: 
[0m19:09:37.323472 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m19:09:37.324476 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m19:09:37.326475 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m19:09:37.331494 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m19:09:37.333477 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 19:09:37.327478 => 19:09:37.332493
[0m19:09:37.334479 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m19:09:37.335494 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m19:09:37.336478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m19:09:37.337476 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m19:09:37.343496 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m19:09:37.345494 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 19:09:37.338477 => 19:09:37.345494
[0m19:09:37.348494 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m19:09:37.349489 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m19:09:37.351474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m19:09:37.352474 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m19:09:37.356474 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m19:09:37.358474 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 19:09:37.352474 => 19:09:37.358474
[0m19:09:37.361476 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m19:09:37.362474 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m19:09:37.363474 [info ] [Thread-1 (]: 1 of 5 START sql view model main.dim_hosts_cleansed ............................ [RUN]
[0m19:09:37.365475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now model.learn_duckdb.dim_hosts_cleansed)
[0m19:09:37.365475 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m19:09:37.374493 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m19:09:37.377475 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 19:09:37.366474 => 19:09:37.376474
[0m19:09:37.378474 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m19:09:37.417473 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m19:09:37.420474 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m19:09:37.422474 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m19:09:37.424474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:09:37.438503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:09:37.439488 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m19:09:37.441478 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
), src_hosts AS (
    SELECT
        *
    FROM
        __dbt__cte__src_hosts
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m19:09:37.442478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:09:37.452494 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m19:09:37.453494 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m19:09:37.456476 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 19:09:37.379475 => 19:09:37.455475
[0m19:09:37.457477 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m19:09:37.468472 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m19:09:37.469474 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m19:09:37.477473 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m19:09:37.477473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF66F250>]}
[0m19:09:37.479473 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.dim_hosts_cleansed ................... [[31mERROR[0m in 0.11s]
[0m19:09:37.481473 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m19:09:37.482490 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m19:09:37.483474 [info ] [Thread-1 (]: 2 of 5 START sql view model main.dim_listings_cleansed ......................... [RUN]
[0m19:09:37.486489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m19:09:37.487489 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m19:09:37.498493 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m19:09:37.499493 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 19:09:37.488472 => 19:09:37.499493
[0m19:09:37.500477 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m19:09:37.510474 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m19:09:37.513475 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m19:09:37.514475 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m19:09:37.515475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:37.528474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:09:37.529478 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m19:09:37.531478 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS (
    SELECT 
        * 
    FROM
        __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(REPLACE(price_str, '$', '') AS DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m19:09:37.533475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:09:37.540474 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m19:09:37.541474 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */
alter view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m19:09:37.543474 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 19:09:37.501494 => 19:09:37.543474
[0m19:09:37.544475 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m19:09:37.549475 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m19:09:37.550475 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m19:09:37.559484 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Catalog Error: Could not rename "dim_listings_cleansed__dbt_tmp" to "dim_listings_cleansed": another entry with this name already exists!
[0m19:09:37.560473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF123E50>]}
[0m19:09:37.561477 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model main.dim_listings_cleansed ................ [[31mERROR[0m in 0.08s]
[0m19:09:37.563475 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m19:09:37.564475 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m19:09:37.566475 [info ] [Thread-1 (]: 3 of 5 START sql incremental model main.fct_reviews ............................ [RUN]
[0m19:09:37.568479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m19:09:37.569478 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m19:09:37.604473 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m19:09:37.607474 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 19:09:37.570474 => 19:09:37.606473
[0m19:09:37.609474 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m19:09:37.663475 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m19:09:37.664475 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m19:09:37.666474 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m19:09:37.667475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:37.681473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:09:37.682474 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m19:09:37.683473 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m19:09:37.687474 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 19:09:37.610474 => 19:09:37.687474
[0m19:09:37.688473 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: ROLLBACK
[0m19:09:37.696071 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.fct_reviews'
[0m19:09:37.697071 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m19:09:37.709070 [debug] [Thread-1 (]: Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m19:09:37.711070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c2d13a3-3e34-4bd1-b813-a6a8b2fa3553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF64F610>]}
[0m19:09:37.713071 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model main.fct_reviews ................... [[31mERROR[0m in 0.14s]
[0m19:09:37.715071 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m19:09:37.716070 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m19:09:37.718073 [info ] [Thread-1 (]: 4 of 5 SKIP relation main.dim_listings_w_hosts ................................. [[33mSKIP[0m]
[0m19:09:37.720073 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m19:09:37.721074 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:09:37.724076 [info ] [Thread-1 (]: 5 of 5 SKIP relation main.mart_fullmoon_reviews ................................ [[33mSKIP[0m]
[0m19:09:37.726071 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:09:37.731071 [debug] [MainThread]: Using duckdb connection "master"
[0m19:09:37.732071 [debug] [MainThread]: On master: BEGIN
[0m19:09:37.733074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:09:37.744072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:09:37.745071 [debug] [MainThread]: On master: COMMIT
[0m19:09:37.745071 [debug] [MainThread]: Using duckdb connection "master"
[0m19:09:37.746072 [debug] [MainThread]: On master: COMMIT
[0m19:09:37.747072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:09:37.748071 [debug] [MainThread]: On master: Close
[0m19:09:37.751070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:37.752071 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m19:09:37.753070 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m19:09:37.753070 [debug] [MainThread]: Connection 'model.learn_duckdb.fct_reviews' was properly closed.
[0m19:09:37.754071 [info ] [MainThread]: 
[0m19:09:37.756071 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models, 1 hook in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m19:09:37.759071 [debug] [MainThread]: Command end result
[0m19:09:37.779070 [info ] [MainThread]: 
[0m19:09:37.780071 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:09:37.782070 [info ] [MainThread]: 
[0m19:09:37.783070 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m19:09:37.784071 [info ] [MainThread]: 
[0m19:09:37.785071 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Catalog Error: Could not rename "dim_listings_cleansed__dbt_tmp" to "dim_listings_cleansed": another entry with this name already exists!
[0m19:09:37.786073 [info ] [MainThread]: 
[0m19:09:37.787071 [error] [MainThread]:   Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m19:09:37.789072 [info ] [MainThread]: 
[0m19:09:37.790072 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m19:09:37.794072 [debug] [MainThread]: Command `dbt run` failed at 19:09:37.793073 after 1.51 seconds
[0m19:09:37.795072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108F8667CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FED3F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108FF2AD9D0>]}
[0m19:09:37.796071 [debug] [MainThread]: Flushing usage events
[0m19:20:50.138570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133BF15850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133BF3F450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133BF0D390>]}


============================== 19:20:50.144567 | 9655bc18-2797-460a-b202-0b9ba1ca7ffb ==============================
[0m19:20:50.144567 [info ] [MainThread]: Running with dbt=1.7.11
[0m19:20:50.146567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:20:50.474567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9655bc18-2797-460a-b202-0b9ba1ca7ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133C07EB10>]}
[0m19:20:50.574587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9655bc18-2797-460a-b202-0b9ba1ca7ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133BFB4990>]}
[0m19:20:50.576570 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m19:20:50.596572 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m19:20:50.818571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:50.820571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:50.829570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9655bc18-2797-460a-b202-0b9ba1ca7ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133C0E4350>]}
[0m19:20:50.855572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9655bc18-2797-460a-b202-0b9ba1ca7ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133C223E50>]}
[0m19:20:50.857569 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m19:20:50.859570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9655bc18-2797-460a-b202-0b9ba1ca7ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133BEE1F50>]}
[0m19:20:50.864568 [info ] [MainThread]: 
[0m19:20:50.867567 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:20:50.872567 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m19:20:50.886569 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:20:50.887572 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m19:20:50.888568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:50.901567 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:50.902567 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:20:50.903568 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m19:20:50.939564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:50.941567 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m19:20:50.943567 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m19:20:50.944568 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m19:20:50.949576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m19:20:50.953566 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:20:50.953566 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m19:20:50.954566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:50.963568 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:50.964565 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:20:50.965566 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m19:20:51.005564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:51.007567 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m19:20:51.008567 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m19:20:51.009568 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:20:51.013567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9655bc18-2797-460a-b202-0b9ba1ca7ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133C2D3010>]}
[0m19:20:51.014567 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:51.015566 [debug] [MainThread]: On master: BEGIN
[0m19:20:51.016569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:51.025571 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:20:51.026569 [debug] [MainThread]: On master: COMMIT
[0m19:20:51.027568 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:51.027568 [debug] [MainThread]: On master: COMMIT
[0m19:20:51.028570 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:20:51.029570 [debug] [MainThread]: On master: Close
[0m19:20:51.032570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:20:51.033571 [info ] [MainThread]: 
[0m19:20:51.038568 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m19:20:51.039569 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m19:20:51.042634 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m19:20:51.044569 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m19:20:51.073571 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m19:20:51.075572 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 19:20:51.045578 => 19:20:51.075572
[0m19:20:51.078569 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m19:20:51.105571 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m19:20:51.107577 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m19:20:51.109568 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: BEGIN
[0m19:20:51.111572 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:51.121567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.122569 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m19:20:51.124569 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from "AIRBNB"."main"."dim_listings_cleansed"
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m19:20:51.129568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.132568 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 19:20:51.079572 => 19:20:51.132568
[0m19:20:51.133567 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: ROLLBACK
[0m19:20:51.135567 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m19:20:51.136568 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m19:20:51.140569 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.10s]
[0m19:20:51.143567 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m19:20:51.145568 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m19:20:51.146567 [info ] [Thread-1 (]: 2 of 9 START test consistent_created_at ........................................ [RUN]
[0m19:20:51.149569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.learn_duckdb.consistent_created_at)
[0m19:20:51.150567 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.consistent_created_at
[0m19:20:51.159568 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.consistent_created_at"
[0m19:20:51.163570 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.consistent_created_at (compile): 19:20:51.151567 => 19:20:51.162569
[0m19:20:51.165569 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.consistent_created_at
[0m19:20:51.169568 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.consistent_created_at"
[0m19:20:51.172568 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.consistent_created_at"
[0m19:20:51.173571 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: BEGIN
[0m19:20:51.174568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:51.187568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.188567 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.consistent_created_at"
[0m19:20:51.189567 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM "AIRBNB"."main"."dim_listings_cleansed" l
INNER JOIN "AIRBNB"."main"."fct_reviews" f
USING (listing_id)
WHERE f.review_date <= l.created_at
LIMIT 10
      
    ) dbt_internal_test
[0m19:20:51.201566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.203566 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.consistent_created_at (execute): 19:20:51.166568 => 19:20:51.203566
[0m19:20:51.204566 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: ROLLBACK
[0m19:20:51.206566 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.consistent_created_at'
[0m19:20:51.206566 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: Close
[0m19:20:51.211569 [info ] [Thread-1 (]: 2 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.06s]
[0m19:20:51.213568 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m19:20:51.214568 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m19:20:51.216570 [info ] [Thread-1 (]: 3 of 9 START test dim_listings_minimum_nights .................................. [RUN]
[0m19:20:51.218568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.consistent_created_at, now test.learn_duckdb.dim_listings_minimum_nights)
[0m19:20:51.219570 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.dim_listings_minimum_nights
[0m19:20:51.226567 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.dim_listings_minimum_nights"
[0m19:20:51.229568 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.dim_listings_minimum_nights (compile): 19:20:51.220569 => 19:20:51.228569
[0m19:20:51.230568 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.dim_listings_minimum_nights
[0m19:20:51.235568 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.dim_listings_minimum_nights"
[0m19:20:51.238568 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.dim_listings_minimum_nights"
[0m19:20:51.239567 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: BEGIN
[0m19:20:51.240568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:51.256569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.258568 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.dim_listings_minimum_nights"
[0m19:20:51.259569 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    "AIRBNB"."main"."dim_listings_cleansed"
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m19:20:51.264569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.268571 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.dim_listings_minimum_nights (execute): 19:20:51.230568 => 19:20:51.267568
[0m19:20:51.270567 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: ROLLBACK
[0m19:20:51.272568 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.dim_listings_minimum_nights'
[0m19:20:51.273569 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: Close
[0m19:20:51.279569 [info ] [Thread-1 (]: 3 of 9 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.06s]
[0m19:20:51.282569 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m19:20:51.283568 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m19:20:51.285568 [info ] [Thread-1 (]: 4 of 9 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m19:20:51.288570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.dim_listings_minimum_nights, now test.learn_duckdb.no_nulls_in_dim_listings)
[0m19:20:51.289569 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.no_nulls_in_dim_listings
[0m19:20:51.354568 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m19:20:51.356569 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: BEGIN
[0m19:20:51.358571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:51.373567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.374566 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m19:20:51.375568 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'dim_listings_cleansed'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'AIRBNB'
      
      order by ordinal_position

  
[0m19:20:51.429566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.433565 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.no_nulls_in_dim_listings"
[0m19:20:51.435566 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.no_nulls_in_dim_listings (compile): 19:20:51.290568 => 19:20:51.435566
[0m19:20:51.436566 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.no_nulls_in_dim_listings
[0m19:20:51.440567 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.no_nulls_in_dim_listings"
[0m19:20:51.442567 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m19:20:51.443567 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM "AIRBNB"."main"."dim_listings_cleansed" WHERE
    
    FALSE

      
    ) dbt_internal_test
[0m19:20:51.446566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.448566 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.no_nulls_in_dim_listings (execute): 19:20:51.436566 => 19:20:51.448566
[0m19:20:51.449565 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: ROLLBACK
[0m19:20:51.450566 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.no_nulls_in_dim_listings'
[0m19:20:51.451566 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: Close
[0m19:20:51.456588 [info ] [Thread-1 (]: 4 of 9 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 0.17s]
[0m19:20:51.458567 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m19:20:51.460569 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m19:20:51.461566 [info ] [Thread-1 (]: 5 of 9 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m19:20:51.463569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.no_nulls_in_dim_listings, now test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m19:20:51.464567 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m19:20:51.484567 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m19:20:51.488568 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 19:20:51.465568 => 19:20:51.487568
[0m19:20:51.489567 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m19:20:51.497568 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m19:20:51.501569 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m19:20:51.502567 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: BEGIN
[0m19:20:51.503568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:51.519569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.520569 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m19:20:51.521568 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "AIRBNB"."main"."dim_listings_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m19:20:51.525568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.530568 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 19:20:51.491568 => 19:20:51.529569
[0m19:20:51.531568 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: ROLLBACK
[0m19:20:51.534572 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m19:20:51.535568 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m19:20:51.541568 [info ] [Thread-1 (]: 5 of 9 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.08s]
[0m19:20:51.544568 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m19:20:51.545569 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m19:20:51.546567 [info ] [Thread-1 (]: 6 of 9 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m19:20:51.549569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m19:20:51.550567 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m19:20:51.563570 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m19:20:51.567570 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 19:20:51.552568 => 19:20:51.565569
[0m19:20:51.568569 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m19:20:51.576568 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m19:20:51.579569 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m19:20:51.581569 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: BEGIN
[0m19:20:51.582568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:51.601570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.603570 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m19:20:51.604569 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from "AIRBNB"."main"."dim_listings_cleansed"
where listing_id is null



      
    ) dbt_internal_test
[0m19:20:51.608568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.612568 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 19:20:51.570568 => 19:20:51.611569
[0m19:20:51.614568 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: ROLLBACK
[0m19:20:51.615569 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m19:20:51.616568 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m19:20:51.620567 [info ] [Thread-1 (]: 6 of 9 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.07s]
[0m19:20:51.621568 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m19:20:51.623568 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m19:20:51.625569 [info ] [Thread-1 (]: 7 of 9 START test positive_value_dim_listings_cleansed_minimum_nights .......... [RUN]
[0m19:20:51.627569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313)
[0m19:20:51.629569 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m19:20:51.639567 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m19:20:51.641568 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 19:20:51.630570 => 19:20:51.640566
[0m19:20:51.643570 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m19:20:51.652571 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m19:20:51.656569 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m19:20:51.659573 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: BEGIN
[0m19:20:51.663569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:51.683570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.684568 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m19:20:51.686568 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    "AIRBNB"."main"."dim_listings_cleansed"
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m19:20:51.691569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.696570 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 19:20:51.644571 => 19:20:51.696570
[0m19:20:51.698571 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: ROLLBACK
[0m19:20:51.700569 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m19:20:51.701569 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m19:20:51.706568 [info ] [Thread-1 (]: 7 of 9 PASS positive_value_dim_listings_cleansed_minimum_nights ................ [[32mPASS[0m in 0.08s]
[0m19:20:51.708570 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m19:20:51.710570 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m19:20:51.712567 [info ] [Thread-1 (]: 8 of 9 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m19:20:51.715574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313, now test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m19:20:51.716570 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m19:20:51.738569 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m19:20:51.743570 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 19:20:51.718569 => 19:20:51.741567
[0m19:20:51.745570 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m19:20:51.754569 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m19:20:51.758568 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m19:20:51.760570 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: BEGIN
[0m19:20:51.762569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:51.778569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.779569 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m19:20:51.781569 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from "AIRBNB"."main"."dim_listings_cleansed"
    where host_id is not null
),

parent as (
    select host_id as to_field
    from "AIRBNB"."main"."dim_hosts_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:20:51.791568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.795568 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 19:20:51.746568 => 19:20:51.795568
[0m19:20:51.797569 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: ROLLBACK
[0m19:20:51.799569 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m19:20:51.800571 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m19:20:51.806569 [info ] [Thread-1 (]: 8 of 9 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.09s]
[0m19:20:51.811569 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m19:20:51.813568 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m19:20:51.815569 [info ] [Thread-1 (]: 9 of 9 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m19:20:51.818569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m19:20:51.820569 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m19:20:51.839570 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m19:20:51.842568 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 19:20:51.821569 => 19:20:51.841570
[0m19:20:51.845569 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m19:20:51.854569 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m19:20:51.856569 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m19:20:51.858569 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: BEGIN
[0m19:20:51.860569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:51.879569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.880569 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m19:20:51.883568 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from "AIRBNB"."main"."dim_listings_cleansed"
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:20:51.890568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:51.895569 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 19:20:51.846569 => 19:20:51.894568
[0m19:20:51.896569 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: ROLLBACK
[0m19:20:51.898569 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m19:20:51.899569 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m19:20:51.905569 [info ] [Thread-1 (]: 9 of 9 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.09s]
[0m19:20:51.908570 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m19:20:51.912571 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:51.913569 [debug] [MainThread]: On master: BEGIN
[0m19:20:51.914569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:51.927568 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:20:51.928570 [debug] [MainThread]: On master: COMMIT
[0m19:20:51.930569 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:51.931569 [debug] [MainThread]: On master: COMMIT
[0m19:20:51.933569 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:20:51.935570 [debug] [MainThread]: On master: Close
[0m19:20:51.941569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:51.943570 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m19:20:51.945568 [debug] [MainThread]: Connection 'test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m19:20:51.947632 [info ] [MainThread]: 
[0m19:20:51.950569 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m19:20:51.957569 [debug] [MainThread]: Command end result
[0m19:20:51.996569 [info ] [MainThread]: 
[0m19:20:51.998569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:52.000571 [info ] [MainThread]: 
[0m19:20:52.004569 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:20:52.009569 [debug] [MainThread]: Command `dbt test` succeeded at 19:20:52.009569 after 1.94 seconds
[0m19:20:52.011570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021335437CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133BF30D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021335716D50>]}
[0m19:20:52.013569 [debug] [MainThread]: Flushing usage events
[0m19:22:12.029251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F777FD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F777A9E0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F777FC2750>]}


============================== 19:22:12.034249 | acff0125-7f03-4562-b956-ade9c0f6c8a3 ==============================
[0m19:22:12.034249 [info ] [MainThread]: Running with dbt=1.7.11
[0m19:22:12.036251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:22:12.354267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7780B6E10>]}
[0m19:22:12.447267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7780B5E50>]}
[0m19:22:12.450307 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m19:22:12.467271 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m19:22:12.695267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:22:12.696252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:22:12.704267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77815E290>]}
[0m19:22:12.724253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7782A7F10>]}
[0m19:22:12.726252 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m19:22:12.727254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F778258BD0>]}
[0m19:22:12.731252 [info ] [MainThread]: 
[0m19:22:12.733252 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:22:12.736253 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m19:22:12.752271 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m19:22:12.753272 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m19:22:12.754251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:12.768259 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.770267 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:22:12.774253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m19:22:12.776252 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m19:22:12.786273 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:22:12.787272 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m19:22:12.788273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:12.799252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.801263 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:22:12.802263 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m19:22:12.803251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.804252 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:22:12.805258 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m19:22:12.806251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.807252 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:22:12.808256 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:22:12.809254 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:22:12.810254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.811257 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m19:22:12.817255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m19:22:12.824256 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:22:12.825257 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m19:22:12.826252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:12.835254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.836253 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:22:12.837252 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m19:22:12.871251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.873267 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m19:22:12.875258 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m19:22:12.875258 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m19:22:12.880252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m19:22:12.883267 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:22:12.884252 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m19:22:12.884252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:12.893267 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.894267 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:22:12.895272 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m19:22:12.930267 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:22:12.931267 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m19:22:12.933252 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m19:22:12.933252 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:22:12.938252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F778023D10>]}
[0m19:22:12.939252 [debug] [MainThread]: Using duckdb connection "master"
[0m19:22:12.939252 [debug] [MainThread]: On master: BEGIN
[0m19:22:12.940252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:12.949252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:22:12.949252 [debug] [MainThread]: On master: COMMIT
[0m19:22:12.950252 [debug] [MainThread]: Using duckdb connection "master"
[0m19:22:12.951257 [debug] [MainThread]: On master: COMMIT
[0m19:22:12.952259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:22:12.952259 [debug] [MainThread]: On master: Close
[0m19:22:12.955254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:22:12.956257 [info ] [MainThread]: 
[0m19:22:12.961254 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m19:22:12.962252 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_hosts ..................................... [RUN]
[0m19:22:12.964259 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m19:22:12.964259 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m19:22:12.975267 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m19:22:12.977253 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 19:22:12.965252 => 19:22:12.977253
[0m19:22:12.978253 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_hosts
[0m19:22:13.019256 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_hosts"
[0m19:22:13.022261 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m19:22:13.024252 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: BEGIN
[0m19:22:13.024252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:22:13.036251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.037253 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m19:22:13.038251 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */

  
  create view "AIRBNB"."main"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );

[0m19:22:13.040252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.049251 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m19:22:13.050251 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */
alter view "AIRBNB"."main"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m19:22:13.051253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.068251 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: COMMIT
[0m19:22:13.069253 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m19:22:13.070251 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: COMMIT
[0m19:22:13.074253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.082256 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m19:22:13.084253 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */
drop view if exists "AIRBNB"."main"."src_hosts__dbt_backup" cascade
[0m19:22:13.086262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.089256 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (execute): 19:22:12.979255 => 19:22:13.088257
[0m19:22:13.090255 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: Close
[0m19:22:13.109252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F777FFEA50>]}
[0m19:22:13.110252 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.src_hosts ................................ [[32mOK[0m in 0.15s]
[0m19:22:13.113254 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m19:22:13.115253 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m19:22:13.116252 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_listings .................................. [RUN]
[0m19:22:13.118253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m19:22:13.120253 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m19:22:13.126254 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m19:22:13.129253 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 19:22:13.121253 => 19:22:13.128255
[0m19:22:13.131252 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_listings
[0m19:22:13.140252 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_listings"
[0m19:22:13.142252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m19:22:13.143253 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: BEGIN
[0m19:22:13.145253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:13.160252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.163252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m19:22:13.165253 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */

  
  create view "AIRBNB"."main"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );

[0m19:22:13.167253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.176252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m19:22:13.178253 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */
alter view "AIRBNB"."main"."src_listings__dbt_tmp" rename to "src_listings"
[0m19:22:13.180255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.183254 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: COMMIT
[0m19:22:13.184252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m19:22:13.185252 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: COMMIT
[0m19:22:13.188252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.194254 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m19:22:13.196253 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */
drop view if exists "AIRBNB"."main"."src_listings__dbt_backup" cascade
[0m19:22:13.198252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.201254 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (execute): 19:22:13.131252 => 19:22:13.201254
[0m19:22:13.202253 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: Close
[0m19:22:13.225254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F778622710>]}
[0m19:22:13.227254 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main.src_listings ............................. [[32mOK[0m in 0.11s]
[0m19:22:13.229253 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m19:22:13.230253 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m19:22:13.231255 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_reviews ................................... [RUN]
[0m19:22:13.233253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m19:22:13.234253 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m19:22:13.239254 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m19:22:13.242253 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 19:22:13.235253 => 19:22:13.241253
[0m19:22:13.243254 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_reviews
[0m19:22:13.250253 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_reviews"
[0m19:22:13.252252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m19:22:13.254253 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: BEGIN
[0m19:22:13.256257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:13.272252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.273252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m19:22:13.275253 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */

  
  create view "AIRBNB"."main"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
  );

[0m19:22:13.277252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.283251 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m19:22:13.283251 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */
alter view "AIRBNB"."main"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m19:22:13.285253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.287253 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: COMMIT
[0m19:22:13.288253 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m19:22:13.289252 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: COMMIT
[0m19:22:13.292252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.297250 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m19:22:13.298253 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */
drop view if exists "AIRBNB"."main"."src_reviews__dbt_backup" cascade
[0m19:22:13.299253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.301252 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (execute): 19:22:13.244253 => 19:22:13.301252
[0m19:22:13.302252 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: Close
[0m19:22:13.317254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77831F3D0>]}
[0m19:22:13.318254 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main.src_reviews .............................. [[32mOK[0m in 0.09s]
[0m19:22:13.320252 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m19:22:13.321252 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m19:22:13.322252 [info ] [Thread-1 (]: 4 of 8 START sql view model main.dim_hosts_cleansed ............................ [RUN]
[0m19:22:13.323254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now model.learn_duckdb.dim_hosts_cleansed)
[0m19:22:13.324254 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m19:22:13.329252 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m19:22:13.331253 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 19:22:13.325252 => 19:22:13.330252
[0m19:22:13.332252 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m19:22:13.342253 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m19:22:13.345253 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m19:22:13.346253 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m19:22:13.347254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:13.362252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.363251 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m19:22:13.365254 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH src_hosts AS (
    SELECT
        *
    FROM
        "AIRBNB"."main"."src_hosts"
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m19:22:13.367254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.375256 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m19:22:13.377253 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m19:22:13.379254 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 19:22:13.333254 => 19:22:13.379254
[0m19:22:13.381253 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: ROLLBACK
[0m19:22:13.393251 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_hosts_cleansed'
[0m19:22:13.394253 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m19:22:13.402252 [debug] [Thread-1 (]: Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m19:22:13.403251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7785EECD0>]}
[0m19:22:13.405252 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model main.dim_hosts_cleansed ................... [[31mERROR[0m in 0.08s]
[0m19:22:13.407254 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m19:22:13.408253 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m19:22:13.410253 [info ] [Thread-1 (]: 5 of 8 START sql view model main.dim_listings_cleansed ......................... [RUN]
[0m19:22:13.411253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m19:22:13.412253 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m19:22:13.420254 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m19:22:13.423253 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 19:22:13.413254 => 19:22:13.422261
[0m19:22:13.425252 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m19:22:13.435251 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m19:22:13.437252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m19:22:13.439252 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m19:22:13.440251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:13.451251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.452252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m19:22:13.453253 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH src_listings AS (
    SELECT 
        * 
    FROM
        "AIRBNB"."main"."src_listings"
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(REPLACE(price_str, '$', '') AS DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m19:22:13.455252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.460253 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m19:22:13.461253 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */
alter view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m19:22:13.463253 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 19:22:13.426252 => 19:22:13.463253
[0m19:22:13.464254 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: ROLLBACK
[0m19:22:13.472252 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.dim_listings_cleansed'
[0m19:22:13.473252 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m19:22:13.483254 [debug] [Thread-1 (]: Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Catalog Error: Could not rename "dim_listings_cleansed__dbt_tmp" to "dim_listings_cleansed": another entry with this name already exists!
[0m19:22:13.484254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F778647ED0>]}
[0m19:22:13.485253 [error] [Thread-1 (]: 5 of 8 ERROR creating sql view model main.dim_listings_cleansed ................ [[31mERROR[0m in 0.07s]
[0m19:22:13.487252 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m19:22:13.488252 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m19:22:13.489252 [info ] [Thread-1 (]: 6 of 8 START sql incremental model main.fct_reviews ............................ [RUN]
[0m19:22:13.490252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m19:22:13.491252 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m19:22:13.518253 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m19:22:13.520260 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 19:22:13.492252 => 19:22:13.520260
[0m19:22:13.521253 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m19:22:13.573252 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m19:22:13.575252 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m19:22:13.576252 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m19:22:13.577252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:13.586251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:22:13.586251 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m19:22:13.587250 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH src_reviews AS (
    SELECT * FROM "AIRBNB"."main"."src_reviews"
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m19:22:13.590252 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 19:22:13.522254 => 19:22:13.590252
[0m19:22:13.591254 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: ROLLBACK
[0m19:22:13.595250 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.fct_reviews'
[0m19:22:13.596250 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m19:22:13.602253 [debug] [Thread-1 (]: Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m19:22:13.604252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acff0125-7f03-4562-b956-ade9c0f6c8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F778025F90>]}
[0m19:22:13.606254 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model main.fct_reviews ................... [[31mERROR[0m in 0.11s]
[0m19:22:13.608253 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m19:22:13.609252 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m19:22:13.610252 [info ] [Thread-1 (]: 7 of 8 SKIP relation main.dim_listings_w_hosts ................................. [[33mSKIP[0m]
[0m19:22:13.611256 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m19:22:13.612252 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:22:13.613252 [info ] [Thread-1 (]: 8 of 8 SKIP relation main.mart_fullmoon_reviews ................................ [[33mSKIP[0m]
[0m19:22:13.615253 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:22:13.618253 [debug] [MainThread]: Using duckdb connection "master"
[0m19:22:13.618253 [debug] [MainThread]: On master: BEGIN
[0m19:22:13.619253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:22:13.629253 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:22:13.630252 [debug] [MainThread]: On master: COMMIT
[0m19:22:13.630252 [debug] [MainThread]: Using duckdb connection "master"
[0m19:22:13.631252 [debug] [MainThread]: On master: COMMIT
[0m19:22:13.632254 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:22:13.633254 [debug] [MainThread]: On master: Close
[0m19:22:13.636252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:13.637252 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m19:22:13.638253 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m19:22:13.639252 [debug] [MainThread]: Connection 'model.learn_duckdb.fct_reviews' was properly closed.
[0m19:22:13.640253 [info ] [MainThread]: 
[0m19:22:13.641253 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m19:22:13.644253 [debug] [MainThread]: Command end result
[0m19:22:13.661259 [info ] [MainThread]: 
[0m19:22:13.663254 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:22:13.664255 [info ] [MainThread]: 
[0m19:22:13.666253 [error] [MainThread]:   Runtime Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  Catalog Error: Could not rename "dim_hosts_cleansed__dbt_tmp" to "dim_hosts_cleansed": another entry with this name already exists!
[0m19:22:13.667254 [info ] [MainThread]: 
[0m19:22:13.669254 [error] [MainThread]:   Runtime Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  Catalog Error: Could not rename "dim_listings_cleansed__dbt_tmp" to "dim_listings_cleansed": another entry with this name already exists!
[0m19:22:13.670254 [info ] [MainThread]: 
[0m19:22:13.672253 [error] [MainThread]:   Runtime Error in model fct_reviews (models\fct\fct_reviews.sql)
  Catalog Error: Table with name "fct_reviews" already exists!
[0m19:22:13.673253 [info ] [MainThread]: 
[0m19:22:13.675254 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=2 TOTAL=8
[0m19:22:13.677253 [debug] [MainThread]: Command `dbt run` failed at 19:22:13.677253 after 1.72 seconds
[0m19:22:13.678253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F777FC02D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7714C7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F778169550>]}
[0m19:22:13.679253 [debug] [MainThread]: Flushing usage events
[0m19:23:11.198299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAD6F25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAD74F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAD74F890>]}


============================== 19:23:11.203299 | 2e66bdb0-0f31-4d9a-adea-ef857232e27a ==============================
[0m19:23:11.203299 [info ] [MainThread]: Running with dbt=1.7.11
[0m19:23:11.205301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:11.515877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAD8266D0>]}
[0m19:23:11.609878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAD76E290>]}
[0m19:23:11.612862 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m19:23:11.628862 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m19:23:11.846863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:11.847862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:11.855860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EADAF3BD0>]}
[0m19:23:11.875863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EADA33E90>]}
[0m19:23:11.878863 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m19:23:11.880865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAD9C9190>]}
[0m19:23:11.884862 [info ] [MainThread]: 
[0m19:23:11.886864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:23:11.889863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m19:23:11.905863 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m19:23:11.906863 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m19:23:11.907864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:11.920864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:11.923863 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:23:11.928864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_main)
[0m19:23:11.929863 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m19:23:11.940862 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:23:11.941863 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m19:23:11.942866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:11.952862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:11.955863 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:23:11.957864 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m19:23:11.958864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:11.959863 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:23:11.960864 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m19:23:11.961863 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:11.963863 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:23:11.963863 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m19:23:11.964863 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m19:23:11.965873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:11.966862 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m19:23:11.972878 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_main'
[0m19:23:11.979883 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:23:11.980862 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m19:23:11.980862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:11.990864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:11.991865 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m19:23:11.992866 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m19:23:12.030862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:12.032862 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m19:23:12.033863 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m19:23:12.034863 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m19:23:12.038878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_main, now list_AIRBNB_dev)
[0m19:23:12.041877 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:23:12.042888 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m19:23:12.043863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:12.051862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:12.052863 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m19:23:12.053869 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m19:23:12.089861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:23:12.091862 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m19:23:12.092863 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m19:23:12.093871 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:23:12.097862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAD96D490>]}
[0m19:23:12.098863 [debug] [MainThread]: Using duckdb connection "master"
[0m19:23:12.098863 [debug] [MainThread]: On master: BEGIN
[0m19:23:12.099863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:12.108863 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:23:12.108863 [debug] [MainThread]: On master: COMMIT
[0m19:23:12.109863 [debug] [MainThread]: Using duckdb connection "master"
[0m19:23:12.110864 [debug] [MainThread]: On master: COMMIT
[0m19:23:12.111872 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:23:12.112863 [debug] [MainThread]: On master: Close
[0m19:23:12.114862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:12.116868 [info ] [MainThread]: 
[0m19:23:12.120862 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m19:23:12.121863 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_hosts ..................................... [RUN]
[0m19:23:12.123863 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m19:23:12.124863 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m19:23:12.133863 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m19:23:12.135862 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 19:23:12.124863 => 19:23:12.135862
[0m19:23:12.136863 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_hosts
[0m19:23:12.174863 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_hosts"
[0m19:23:12.175863 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m19:23:12.176864 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: BEGIN
[0m19:23:12.177863 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:12.186864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:23:12.187865 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m19:23:12.188863 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */

  
  create view "AIRBNB"."main"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );

[0m19:23:12.189865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:23:12.198864 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m19:23:12.199865 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */
alter view "AIRBNB"."main"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m19:23:12.201863 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (execute): 19:23:12.136863 => 19:23:12.200863
[0m19:23:12.201863 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: ROLLBACK
[0m19:23:12.212863 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_hosts'
[0m19:23:12.213863 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: Close
[0m19:23:12.220862 [debug] [Thread-1 (]: Runtime Error in model src_hosts (models\src\src_hosts.sql)
  Catalog Error: Could not rename "src_hosts__dbt_tmp" to "src_hosts": another entry with this name already exists!
[0m19:23:12.221861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EADB3D750>]}
[0m19:23:12.222862 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.src_hosts ............................ [[31mERROR[0m in 0.10s]
[0m19:23:12.223873 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m19:23:12.224865 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m19:23:12.225863 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_listings .................................. [RUN]
[0m19:23:12.227864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m19:23:12.228863 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m19:23:12.232861 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m19:23:12.234862 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 19:23:12.228863 => 19:23:12.233861
[0m19:23:12.234862 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_listings
[0m19:23:12.240861 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_listings"
[0m19:23:12.242863 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m19:23:12.243865 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: BEGIN
[0m19:23:12.244865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:12.255863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:23:12.256863 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m19:23:12.257863 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */

  
  create view "AIRBNB"."main"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );

[0m19:23:12.258863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:23:12.264865 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m19:23:12.265864 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */
alter view "AIRBNB"."main"."src_listings__dbt_tmp" rename to "src_listings"
[0m19:23:12.268863 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (execute): 19:23:12.235864 => 19:23:12.267863
[0m19:23:12.271863 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: ROLLBACK
[0m19:23:12.278864 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_listings'
[0m19:23:12.279863 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: Close
[0m19:23:12.286864 [debug] [Thread-1 (]: Runtime Error in model src_listings (models\src\src_listings.sql)
  Catalog Error: Could not rename "src_listings__dbt_tmp" to "src_listings": another entry with this name already exists!
[0m19:23:12.287863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EADA885D0>]}
[0m19:23:12.289865 [error] [Thread-1 (]: 2 of 8 ERROR creating sql view model main.src_listings ......................... [[31mERROR[0m in 0.06s]
[0m19:23:12.291863 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m19:23:12.293864 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m19:23:12.295865 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_reviews ................................... [RUN]
[0m19:23:12.297864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m19:23:12.298864 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m19:23:12.309862 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m19:23:12.312863 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 19:23:12.299864 => 19:23:12.311861
[0m19:23:12.313863 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_reviews
[0m19:23:12.322866 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_reviews"
[0m19:23:12.325865 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m19:23:12.326864 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: BEGIN
[0m19:23:12.327864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:12.341864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:23:12.342865 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m19:23:12.344865 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */

  
  create view "AIRBNB"."main"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
  );

[0m19:23:12.345864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:23:12.350864 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m19:23:12.351862 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */
alter view "AIRBNB"."main"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m19:23:12.354866 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (execute): 19:23:12.314866 => 19:23:12.353864
[0m19:23:12.356864 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: ROLLBACK
[0m19:23:12.368863 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_reviews'
[0m19:23:12.370864 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: Close
[0m19:23:12.380863 [debug] [Thread-1 (]: Runtime Error in model src_reviews (models\src\src_reviews.sql)
  Catalog Error: Could not rename "src_reviews__dbt_tmp" to "src_reviews": another entry with this name already exists!
[0m19:23:12.381862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e66bdb0-0f31-4d9a-adea-ef857232e27a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EADD3BC50>]}
[0m19:23:12.383862 [error] [Thread-1 (]: 3 of 8 ERROR creating sql view model main.src_reviews .......................... [[31mERROR[0m in 0.08s]
[0m19:23:12.384862 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m19:23:12.385863 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m19:23:12.386866 [info ] [Thread-1 (]: 4 of 8 SKIP relation main.dim_hosts_cleansed ................................... [[33mSKIP[0m]
[0m19:23:12.388865 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m19:23:12.389864 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m19:23:12.390864 [info ] [Thread-1 (]: 5 of 8 SKIP relation main.dim_listings_cleansed ................................ [[33mSKIP[0m]
[0m19:23:12.391864 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m19:23:12.392864 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m19:23:12.393863 [info ] [Thread-1 (]: 6 of 8 SKIP relation main.fct_reviews .......................................... [[33mSKIP[0m]
[0m19:23:12.394863 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m19:23:12.395863 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m19:23:12.396863 [info ] [Thread-1 (]: 7 of 8 SKIP relation main.dim_listings_w_hosts ................................. [[33mSKIP[0m]
[0m19:23:12.397864 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m19:23:12.399864 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:23:12.400864 [info ] [Thread-1 (]: 8 of 8 SKIP relation main.mart_fullmoon_reviews ................................ [[33mSKIP[0m]
[0m19:23:12.401864 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m19:23:12.404864 [debug] [MainThread]: Using duckdb connection "master"
[0m19:23:12.405863 [debug] [MainThread]: On master: BEGIN
[0m19:23:12.405863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:12.415863 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:23:12.416863 [debug] [MainThread]: On master: COMMIT
[0m19:23:12.417863 [debug] [MainThread]: Using duckdb connection "master"
[0m19:23:12.417863 [debug] [MainThread]: On master: COMMIT
[0m19:23:12.418863 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:23:12.419863 [debug] [MainThread]: On master: Close
[0m19:23:12.422862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:12.423864 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m19:23:12.424863 [debug] [MainThread]: Connection 'list_AIRBNB_dev' was properly closed.
[0m19:23:12.425864 [debug] [MainThread]: Connection 'model.learn_duckdb.src_reviews' was properly closed.
[0m19:23:12.426865 [info ] [MainThread]: 
[0m19:23:12.427866 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m19:23:12.429864 [debug] [MainThread]: Command end result
[0m19:23:12.447863 [info ] [MainThread]: 
[0m19:23:12.448863 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:23:12.449865 [info ] [MainThread]: 
[0m19:23:12.450864 [error] [MainThread]:   Runtime Error in model src_hosts (models\src\src_hosts.sql)
  Catalog Error: Could not rename "src_hosts__dbt_tmp" to "src_hosts": another entry with this name already exists!
[0m19:23:12.451863 [info ] [MainThread]: 
[0m19:23:12.453865 [error] [MainThread]:   Runtime Error in model src_listings (models\src\src_listings.sql)
  Catalog Error: Could not rename "src_listings__dbt_tmp" to "src_listings": another entry with this name already exists!
[0m19:23:12.455863 [info ] [MainThread]: 
[0m19:23:12.456865 [error] [MainThread]:   Runtime Error in model src_reviews (models\src\src_reviews.sql)
  Catalog Error: Could not rename "src_reviews__dbt_tmp" to "src_reviews": another entry with this name already exists!
[0m19:23:12.458865 [info ] [MainThread]: 
[0m19:23:12.459864 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m19:23:12.462863 [debug] [MainThread]: Command `dbt run` failed at 19:23:12.461864 after 1.33 seconds
[0m19:23:12.462863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAD6F3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA6BB7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EADDA3910>]}
[0m19:23:12.463863 [debug] [MainThread]: Flushing usage events
[0m20:32:16.908938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F6229B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F62713A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F62712990>]}


============================== 20:32:16.917938 | 91c2bf84-bfab-484d-8016-68a06bfad8d3 ==============================
[0m20:32:16.917938 [info ] [MainThread]: Running with dbt=1.7.11
[0m20:32:16.921943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:17.666939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91c2bf84-bfab-484d-8016-68a06bfad8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F627E2A50>]}
[0m20:32:17.840940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91c2bf84-bfab-484d-8016-68a06bfad8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F627D7ED0>]}
[0m20:32:17.848940 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m20:32:17.882940 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m20:32:18.244936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:32:18.245936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:32:18.254936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91c2bf84-bfab-484d-8016-68a06bfad8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F62AC04D0>]}
[0m20:32:18.289941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91c2bf84-bfab-484d-8016-68a06bfad8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F629D5D50>]}
[0m20:32:18.291939 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m20:32:18.296937 [info ] [MainThread]: 
[0m20:32:18.299940 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:32:18.302939 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m20:32:18.324939 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m20:32:18.325940 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m20:32:18.327941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:18.439521 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m20:32:18.441522 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m20:32:18.442521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:18.571520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:18.573521 [debug] [MainThread]: Connection 'list_AIRBNB' was properly closed.
[0m20:32:18.574522 [info ] [MainThread]: 
[0m20:32:18.576523 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m20:32:18.578521 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Program Files\Git\mingw64\bin\git.exe (PID 16440)
[0m20:32:18.583522 [debug] [MainThread]: Command `dbt build` failed at 20:32:18.582521 after 1.87 seconds
[0m20:32:18.584521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F626F4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5BBB7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F626DBB90>]}
[0m20:32:18.585521 [debug] [MainThread]: Flushing usage events
[0m20:41:45.595199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102AD3CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102AD3C510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102AD3E0D0>]}


============================== 20:41:45.600197 | e11d04f5-54e2-4359-883e-c7ec39183c0d ==============================
[0m20:41:45.600197 [info ] [MainThread]: Running with dbt=1.7.11
[0m20:41:45.602199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:41:45.781906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e11d04f5-54e2-4359-883e-c7ec39183c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102ADCC4D0>]}
[0m20:41:46.027886 [debug] [MainThread]: Command `dbt clean` succeeded at 20:41:46.027886 after 0.51 seconds
[0m20:41:46.028887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021024277ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021024556210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210244C5C50>]}
[0m20:41:46.029887 [debug] [MainThread]: Flushing usage events
[0m20:52:05.746048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45EBC3B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45EB8AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45EB89B10>]}


============================== 20:52:05.754049 | 8d056d6f-34a3-4372-8ec4-b7bdf85f973b ==============================
[0m20:52:05.754049 [info ] [MainThread]: Running with dbt=1.7.11
[0m20:52:05.756050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:06.077048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d056d6f-34a3-4372-8ec4-b7bdf85f973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45ED44690>]}
[0m20:52:06.171048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d056d6f-34a3-4372-8ec4-b7bdf85f973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45EE2CE10>]}
[0m20:52:06.173047 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m20:52:06.174047 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m20:52:06.177049 [debug] [MainThread]: Command `dbt build` failed at 20:52:06.177049 after 0.53 seconds
[0m20:52:06.178046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45EB63D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4580D7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D45E74AF50>]}
[0m20:52:06.180050 [debug] [MainThread]: Flushing usage events
[0m20:52:19.324102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAE566F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAE566F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAE566DD10>]}


============================== 20:52:19.329101 | dc576c59-5270-4c6d-985f-ed43f6a78c65 ==============================
[0m20:52:19.329101 [info ] [MainThread]: Running with dbt=1.7.11
[0m20:52:19.331103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:19.512118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc576c59-5270-4c6d-985f-ed43f6a78c65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAE56EB250>]}
[0m20:52:19.524123 [debug] [MainThread]: Set downloads directory='C:\Users\Use\AppData\Local\Temp\dbt-downloads-lch7unqq'
[0m20:52:19.525102 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:52:20.134018 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:52:20.137018 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:52:20.363038 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:52:20.370038 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:52:21.085019 [info ] [MainThread]: Installed from version 1.1.1
[0m20:52:21.087020 [info ] [MainThread]: Up to date!
[0m20:52:21.088020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dc576c59-5270-4c6d-985f-ed43f6a78c65', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAE56CCBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAE568B010>]}
[0m20:52:21.093021 [debug] [MainThread]: Command `dbt deps` succeeded at 20:52:21.092021 after 1.84 seconds
[0m20:52:21.094020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADEB27ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADEE06210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADED74F90>]}
[0m20:52:21.094020 [debug] [MainThread]: Flushing usage events
[0m20:52:28.571611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F288F43B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28895ACD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F288F43590>]}


============================== 20:52:28.576615 | b294fa70-c840-495e-8997-751b0d43b2e5 ==============================
[0m20:52:28.576615 [info ] [MainThread]: Running with dbt=1.7.11
[0m20:52:28.577615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:28.955614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F288F89990>]}
[0m20:52:29.057615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2890234D0>]}
[0m20:52:29.061616 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m20:52:29.084613 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m20:52:29.087612 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:52:29.089614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F289141C10>]}
[0m20:52:31.601659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2896D8C90>]}
[0m20:52:31.624657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28A97FF10>]}
[0m20:52:31.626658 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m20:52:31.629657 [info ] [MainThread]: 
[0m20:52:31.631659 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:52:31.633661 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m20:52:31.649657 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m20:52:31.651659 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m20:52:31.652658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:31.672659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.674658 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:52:31.684658 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m20:52:31.685658 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m20:52:31.686658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:31.698658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.701658 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:52:31.706657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m20:52:31.707656 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m20:52:31.720656 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:52:31.722655 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m20:52:31.723657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:31.733657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.735655 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:52:31.736657 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m20:52:31.737658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.738657 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:52:31.738657 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m20:52:31.739657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.741657 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m20:52:31.741657 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:52:31.742659 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m20:52:31.746658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.747659 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m20:52:31.760656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m20:52:31.761655 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m20:52:31.764658 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:52:31.765658 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m20:52:31.766656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:31.781658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.783656 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:52:31.783656 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m20:52:31.785658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.786657 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:52:31.787657 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m20:52:31.788657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.789658 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m20:52:31.790657 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:52:31.791657 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m20:52:31.792657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.792657 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m20:52:31.797657 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m20:52:31.804657 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m20:52:31.805657 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m20:52:31.806657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:31.814665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.814665 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m20:52:31.815656 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m20:52:31.853660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.855661 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m20:52:31.857659 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m20:52:31.857659 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m20:52:31.862659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m20:52:31.865659 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m20:52:31.866659 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m20:52:31.867660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:31.879658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.880658 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m20:52:31.881658 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m20:52:31.919658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:31.921660 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m20:52:31.922658 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m20:52:31.924658 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m20:52:31.929659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28A937850>]}
[0m20:52:31.930662 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:31.932660 [debug] [MainThread]: On master: BEGIN
[0m20:52:31.933661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:31.941661 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:52:31.942660 [debug] [MainThread]: On master: COMMIT
[0m20:52:31.943659 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:31.944659 [debug] [MainThread]: On master: COMMIT
[0m20:52:31.945657 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:52:31.946659 [debug] [MainThread]: On master: Close
[0m20:52:31.949660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:31.951660 [info ] [MainThread]: 
[0m20:52:31.955660 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m20:52:31.957661 [info ] [Thread-1 (]: 1 of 19 START sql view model main.src_hosts .................................... [RUN]
[0m20:52:31.959659 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m20:52:31.960659 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m20:52:31.974659 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m20:52:31.979659 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 20:52:31.960659 => 20:52:31.978660
[0m20:52:31.981659 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_hosts
[0m20:52:32.033657 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_hosts"
[0m20:52:32.038659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:52:32.039658 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: BEGIN
[0m20:52:32.040659 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:52:32.052658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.052658 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:52:32.053657 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */

  
  create view "AIRBNB"."main"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );

[0m20:52:32.055658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.066655 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:52:32.067657 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */
alter view "AIRBNB"."main"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m20:52:32.068656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.088659 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: COMMIT
[0m20:52:32.089659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:52:32.090659 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: COMMIT
[0m20:52:32.097656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.106662 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:52:32.107659 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */
drop view if exists "AIRBNB"."main"."src_hosts__dbt_backup" cascade
[0m20:52:32.108662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.111662 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (execute): 20:52:31.982659 => 20:52:32.110662
[0m20:52:32.112663 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: Close
[0m20:52:32.124659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28A9BA950>]}
[0m20:52:32.125658 [info ] [Thread-1 (]: 1 of 19 OK created sql view model main.src_hosts ............................... [[32mOK[0m in 0.17s]
[0m20:52:32.127657 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m20:52:32.129660 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m20:52:32.131664 [info ] [Thread-1 (]: 2 of 19 START sql view model main.src_listings ................................. [RUN]
[0m20:52:32.134662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m20:52:32.136660 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m20:52:32.143659 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m20:52:32.146659 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 20:52:32.137658 => 20:52:32.145659
[0m20:52:32.148658 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_listings
[0m20:52:32.156661 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_listings"
[0m20:52:32.159659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:52:32.161660 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: BEGIN
[0m20:52:32.162659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:32.179657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.181658 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:52:32.182658 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */

  
  create view "AIRBNB"."main"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );

[0m20:52:32.185660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.194657 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:52:32.196658 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */
alter view "AIRBNB"."main"."src_listings__dbt_tmp" rename to "src_listings"
[0m20:52:32.197658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.200659 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: COMMIT
[0m20:52:32.201662 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:52:32.203659 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: COMMIT
[0m20:52:32.207659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.217658 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:52:32.219659 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */
drop view if exists "AIRBNB"."main"."src_listings__dbt_backup" cascade
[0m20:52:32.220658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.223658 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (execute): 20:52:32.150662 => 20:52:32.223658
[0m20:52:32.224657 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: Close
[0m20:52:32.235660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28A81D3D0>]}
[0m20:52:32.237658 [info ] [Thread-1 (]: 2 of 19 OK created sql view model main.src_listings ............................ [[32mOK[0m in 0.10s]
[0m20:52:32.239659 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m20:52:32.241658 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m20:52:32.243659 [info ] [Thread-1 (]: 3 of 19 START sql view model main.src_reviews .................................. [RUN]
[0m20:52:32.246662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m20:52:32.247661 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m20:52:32.255657 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m20:52:32.258657 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 20:52:32.248659 => 20:52:32.257657
[0m20:52:32.260660 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_reviews
[0m20:52:32.273659 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_reviews"
[0m20:52:32.276659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:52:32.278659 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: BEGIN
[0m20:52:32.279659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:32.297659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.298659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:52:32.299659 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */

  
  create view "AIRBNB"."main"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
  );

[0m20:52:32.301659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.308659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:52:32.310659 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */
alter view "AIRBNB"."main"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m20:52:32.312659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.317659 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: COMMIT
[0m20:52:32.318658 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:52:32.319657 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: COMMIT
[0m20:52:32.323657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.328656 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:52:32.329658 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */
drop view if exists "AIRBNB"."main"."src_reviews__dbt_backup" cascade
[0m20:52:32.330658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.333660 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (execute): 20:52:32.261660 => 20:52:32.333660
[0m20:52:32.334660 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: Close
[0m20:52:32.344659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28A9E6690>]}
[0m20:52:32.345660 [info ] [Thread-1 (]: 3 of 19 OK created sql view model main.src_reviews ............................. [[32mOK[0m in 0.10s]
[0m20:52:32.347658 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m20:52:32.349658 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m20:52:32.350658 [info ] [Thread-1 (]: 4 of 19 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m20:52:32.352658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m20:52:32.354658 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m20:52:32.355659 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 20:52:32.355659 => 20:52:32.355659
[0m20:52:32.357659 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m20:52:32.460658 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m20:52:32.461658 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m20:52:32.463658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:32.481657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.482658 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m20:52:32.483658 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m20:52:32.484658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.500658 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m20:52:32.501660 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: 
          COPY "AIRBNB"."main"."seed_full_moon_dates" FROM 'C:\Users\Use\OneDrive\Development\dbt-course\learn_duckdb\seeds\seed_full_moon_dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:52:32.513660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.521660 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.learn_duckdb.seed_full_moon_dates"
[0m20:52:32.530659 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m20:52:32.531660 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m20:52:32.532657 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: COMMIT
[0m20:52:32.535658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.537661 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 20:52:32.358658 => 20:52:32.537661
[0m20:52:32.538659 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m20:52:32.548670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28AA56550>]}
[0m20:52:32.549661 [info ] [Thread-1 (]: 4 of 19 OK loaded seed file main.seed_full_moon_dates .......................... [[32mINSERT 272[0m in 0.20s]
[0m20:52:32.551659 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m20:52:32.552658 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m20:52:32.553663 [info ] [Thread-1 (]: 5 of 19 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m20:52:32.554658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m20:52:32.555658 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m20:52:32.560658 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 20:52:32.556658 => 20:52:32.560658
[0m20:52:32.561657 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m20:52:32.629657 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m20:52:32.632657 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m20:52:32.633658 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m20:52:32.634658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:32.650657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.651659 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m20:52:32.652658 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m20:52:32.684656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.687656 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m20:52:32.687656 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m20:52:32.688664 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: COMMIT
[0m20:52:32.722659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.725659 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 20:52:32.562659 => 20:52:32.724658
[0m20:52:32.726659 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m20:52:32.793661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28A9B8810>]}
[0m20:52:32.795658 [info ] [Thread-1 (]: 5 of 19 OK snapshotted dev.scd_raw_listings .................................... [[32mOK[0m in 0.24s]
[0m20:52:32.797659 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m20:52:32.799659 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m20:52:32.801659 [info ] [Thread-1 (]: 6 of 19 START sql view model main.dim_hosts_cleansed ........................... [RUN]
[0m20:52:32.803658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.learn_duckdb.scd_raw_listings, now model.learn_duckdb.dim_hosts_cleansed)
[0m20:52:32.805659 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_hosts_cleansed
[0m20:52:32.813659 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_hosts_cleansed"
[0m20:52:32.816659 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (compile): 20:52:32.806659 => 20:52:32.815660
[0m20:52:32.817658 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_hosts_cleansed
[0m20:52:32.828657 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_hosts_cleansed"
[0m20:52:32.831659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m20:52:32.833660 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: BEGIN
[0m20:52:32.834660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:32.850658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.851658 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m20:52:32.853658 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */

  
  create view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" as (
    

WITH src_hosts AS (
    SELECT
        *
    FROM
        "AIRBNB"."main"."src_hosts"
)

SELECT
    host_id,
    coalesce(
        host_name,
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    src_hosts
  );

[0m20:52:32.855658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.863659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m20:52:32.865660 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
alter view "AIRBNB"."main"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m20:52:32.866657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.870656 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m20:52:32.871657 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m20:52:32.872657 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: COMMIT
[0m20:52:32.875658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.881659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_hosts_cleansed"
[0m20:52:32.882662 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."main"."dim_hosts_cleansed__dbt_backup" cascade
[0m20:52:32.884660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.887658 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_hosts_cleansed (execute): 20:52:32.818659 => 20:52:32.886659
[0m20:52:32.888659 [debug] [Thread-1 (]: On model.learn_duckdb.dim_hosts_cleansed: Close
[0m20:52:32.899658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28A8DEED0>]}
[0m20:52:32.900658 [info ] [Thread-1 (]: 6 of 19 OK created sql view model main.dim_hosts_cleansed ...................... [[32mOK[0m in 0.10s]
[0m20:52:32.902659 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m20:52:32.903658 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m20:52:32.904659 [info ] [Thread-1 (]: 7 of 19 START sql view model main.dim_listings_cleansed ........................ [RUN]
[0m20:52:32.906658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_hosts_cleansed, now model.learn_duckdb.dim_listings_cleansed)
[0m20:52:32.906658 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_cleansed
[0m20:52:32.912656 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_cleansed"
[0m20:52:32.914658 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (compile): 20:52:32.907660 => 20:52:32.914658
[0m20:52:32.915658 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_cleansed
[0m20:52:32.923656 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_cleansed"
[0m20:52:32.926657 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m20:52:32.927658 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: BEGIN
[0m20:52:32.928659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:32.944658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.945657 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m20:52:32.946659 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */

  
  create view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" as (
    

WITH src_listings AS (
    SELECT 
        * 
    FROM
        "AIRBNB"."main"."src_listings"
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    CAST(REPLACE(price_str, '$', '') AS DECIMAL(10,2)) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );

[0m20:52:32.948660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.954658 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m20:52:32.955659 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */
alter view "AIRBNB"."main"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m20:52:32.956659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.958659 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: COMMIT
[0m20:52:32.960660 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m20:52:32.961659 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: COMMIT
[0m20:52:32.965658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.970659 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_cleansed"
[0m20:52:32.972659 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."main"."dim_listings_cleansed__dbt_backup" cascade
[0m20:52:32.974659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:32.979662 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_cleansed (execute): 20:52:32.916658 => 20:52:32.978659
[0m20:52:32.980660 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_cleansed: Close
[0m20:52:32.993659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28A976850>]}
[0m20:52:32.995660 [info ] [Thread-1 (]: 7 of 19 OK created sql view model main.dim_listings_cleansed ................... [[32mOK[0m in 0.09s]
[0m20:52:32.998659 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m20:52:32.999659 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m20:52:33.002660 [info ] [Thread-1 (]: 8 of 19 START sql incremental model main.fct_reviews ........................... [RUN]
[0m20:52:33.004659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.dim_listings_cleansed, now model.learn_duckdb.fct_reviews)
[0m20:52:33.006660 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.fct_reviews
[0m20:52:33.018659 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.fct_reviews"
[0m20:52:33.022662 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (compile): 20:52:33.006660 => 20:52:33.021660
[0m20:52:33.023660 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.fct_reviews
[0m20:52:33.076657 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.fct_reviews"
[0m20:52:33.079658 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m20:52:33.081657 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: BEGIN
[0m20:52:33.081657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:33.096658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:33.097658 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m20:52:33.098658 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.fct_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."fct_reviews"
  
    as (
      
WITH src_reviews AS (
    SELECT * FROM "AIRBNB"."main"."src_reviews"
)
SELECT
    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
    * 
FROM src_reviews
WHERE review_text IS NOT NULL

    );
  
  
  
[0m20:52:33.809661 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:52:33.812661 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m20:52:33.813662 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.fct_reviews"
[0m20:52:33.814657 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: COMMIT
[0m20:52:34.339174 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:52:34.341173 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.fct_reviews (execute): 20:52:33.024660 => 20:52:34.340173
[0m20:52:34.342174 [debug] [Thread-1 (]: On model.learn_duckdb.fct_reviews: Close
[0m20:52:34.374174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F289795A50>]}
[0m20:52:34.375174 [info ] [Thread-1 (]: 8 of 19 OK created sql incremental model main.fct_reviews ...................... [[32mOK[0m in 1.37s]
[0m20:52:34.377175 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m20:52:34.379174 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:52:34.380174 [info ] [Thread-1 (]: 9 of 19 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m20:52:34.382175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.fct_reviews, now test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m20:52:34.383175 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:52:34.391174 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m20:52:34.394176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 20:52:34.384176 => 20:52:34.393176
[0m20:52:34.396177 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:52:34.420175 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m20:52:34.423176 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m20:52:34.425175 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: BEGIN
[0m20:52:34.426174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.441176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.442175 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m20:52:34.443176 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from "AIRBNB"."main"."dim_listings_cleansed"
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m20:52:34.447177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.450176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 20:52:34.397176 => 20:52:34.450176
[0m20:52:34.451175 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: ROLLBACK
[0m20:52:34.452177 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m20:52:34.453177 [debug] [Thread-1 (]: On test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m20:52:34.456177 [info ] [Thread-1 (]: 9 of 19 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.08s]
[0m20:52:34.458176 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:52:34.459176 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m20:52:34.459176 [info ] [Thread-1 (]: 10 of 19 START test dim_listings_minimum_nights ................................ [RUN]
[0m20:52:34.461176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.learn_duckdb.dim_listings_minimum_nights)
[0m20:52:34.462176 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.dim_listings_minimum_nights
[0m20:52:34.468178 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.dim_listings_minimum_nights"
[0m20:52:34.471175 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.dim_listings_minimum_nights (compile): 20:52:34.463180 => 20:52:34.470177
[0m20:52:34.472175 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.dim_listings_minimum_nights
[0m20:52:34.476177 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.dim_listings_minimum_nights"
[0m20:52:34.479178 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.dim_listings_minimum_nights"
[0m20:52:34.480175 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: BEGIN
[0m20:52:34.481174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.491179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.492180 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.dim_listings_minimum_nights"
[0m20:52:34.493182 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM
    "AIRBNB"."main"."dim_listings_cleansed"
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m20:52:34.497175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.500295 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.dim_listings_minimum_nights (execute): 20:52:34.473175 => 20:52:34.499176
[0m20:52:34.501177 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: ROLLBACK
[0m20:52:34.503182 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.dim_listings_minimum_nights'
[0m20:52:34.503182 [debug] [Thread-1 (]: On test.learn_duckdb.dim_listings_minimum_nights: Close
[0m20:52:34.506178 [info ] [Thread-1 (]: 10 of 19 PASS dim_listings_minimum_nights ...................................... [[32mPASS[0m in 0.05s]
[0m20:52:34.508177 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m20:52:34.509176 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m20:52:34.510176 [info ] [Thread-1 (]: 11 of 19 START test no_nulls_in_dim_listings ................................... [RUN]
[0m20:52:34.512180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.dim_listings_minimum_nights, now test.learn_duckdb.no_nulls_in_dim_listings)
[0m20:52:34.513178 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.no_nulls_in_dim_listings
[0m20:52:34.538180 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m20:52:34.539180 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: BEGIN
[0m20:52:34.540180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.549176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.550177 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m20:52:34.551176 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.no_nulls_in_dim_listings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'dim_listings_cleansed'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'AIRBNB'
      
      order by ordinal_position

  
[0m20:52:34.597177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.602179 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.no_nulls_in_dim_listings"
[0m20:52:34.604180 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.no_nulls_in_dim_listings (compile): 20:52:34.514178 => 20:52:34.604180
[0m20:52:34.605179 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.no_nulls_in_dim_listings
[0m20:52:34.610179 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.no_nulls_in_dim_listings"
[0m20:52:34.612186 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.no_nulls_in_dim_listings"
[0m20:52:34.614177 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM "AIRBNB"."main"."dim_listings_cleansed" WHERE
    
    FALSE

      
    ) dbt_internal_test
[0m20:52:34.617176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.619176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.no_nulls_in_dim_listings (execute): 20:52:34.606180 => 20:52:34.618176
[0m20:52:34.620175 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: ROLLBACK
[0m20:52:34.621175 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.no_nulls_in_dim_listings'
[0m20:52:34.621175 [debug] [Thread-1 (]: On test.learn_duckdb.no_nulls_in_dim_listings: Close
[0m20:52:34.625177 [info ] [Thread-1 (]: 11 of 19 PASS no_nulls_in_dim_listings ......................................... [[32mPASS[0m in 0.11s]
[0m20:52:34.627176 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m20:52:34.628174 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:52:34.629177 [info ] [Thread-1 (]: 12 of 19 START test not_null_dim_listings_cleansed_host_id ..................... [RUN]
[0m20:52:34.630179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.no_nulls_in_dim_listings, now test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m20:52:34.631180 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:52:34.641179 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:52:34.644176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 20:52:34.632180 => 20:52:34.643181
[0m20:52:34.645178 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:52:34.652178 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:52:34.654178 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:52:34.656176 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: BEGIN
[0m20:52:34.657181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.667176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.669176 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m20:52:34.670179 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from "AIRBNB"."main"."dim_listings_cleansed"
where host_id is null



      
    ) dbt_internal_test
[0m20:52:34.672180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.674180 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 20:52:34.646178 => 20:52:34.674180
[0m20:52:34.675179 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: ROLLBACK
[0m20:52:34.677180 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m20:52:34.678176 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m20:52:34.682179 [info ] [Thread-1 (]: 12 of 19 PASS not_null_dim_listings_cleansed_host_id ........................... [[32mPASS[0m in 0.05s]
[0m20:52:34.683175 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:52:34.684177 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:52:34.685175 [info ] [Thread-1 (]: 13 of 19 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m20:52:34.687176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be, now test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m20:52:34.687176 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:52:34.695179 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:52:34.698176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 20:52:34.688176 => 20:52:34.697175
[0m20:52:34.700178 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:52:34.704176 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:52:34.706174 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:52:34.707180 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: BEGIN
[0m20:52:34.708180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.717177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.718176 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m20:52:34.720176 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from "AIRBNB"."main"."dim_listings_cleansed"
where listing_id is null



      
    ) dbt_internal_test
[0m20:52:34.723175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.726175 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 20:52:34.701177 => 20:52:34.725175
[0m20:52:34.727175 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: ROLLBACK
[0m20:52:34.729178 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m20:52:34.730179 [debug] [Thread-1 (]: On test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m20:52:34.734177 [info ] [Thread-1 (]: 13 of 19 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.05s]
[0m20:52:34.736181 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:52:34.737179 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:52:34.738177 [info ] [Thread-1 (]: 14 of 19 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m20:52:34.740178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313)
[0m20:52:34.741184 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:52:34.748180 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m20:52:34.751176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 20:52:34.742176 => 20:52:34.750177
[0m20:52:34.754178 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:52:34.767180 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m20:52:34.770176 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m20:52:34.771178 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: BEGIN
[0m20:52:34.772177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.781178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.782178 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m20:52:34.783179 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    "AIRBNB"."main"."dim_listings_cleansed"
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m20:52:34.786177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.788176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 20:52:34.756178 => 20:52:34.788176
[0m20:52:34.789175 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: ROLLBACK
[0m20:52:34.790178 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m20:52:34.791180 [debug] [Thread-1 (]: On test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m20:52:34.794179 [info ] [Thread-1 (]: 14 of 19 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.05s]
[0m20:52:34.796176 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:52:34.797188 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:52:34.798177 [info ] [Thread-1 (]: 15 of 19 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m20:52:34.800178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313, now test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m20:52:34.801179 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:52:34.808175 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:52:34.810178 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 20:52:34.801179 => 20:52:34.809180
[0m20:52:34.812176 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:52:34.819176 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:52:34.821176 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:52:34.822180 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: BEGIN
[0m20:52:34.824180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.834176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.835176 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m20:52:34.835176 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from "AIRBNB"."main"."dim_listings_cleansed"
    where host_id is not null
),

parent as (
    select host_id as to_field
    from "AIRBNB"."main"."dim_hosts_cleansed"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:52:34.841183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.848176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 20:52:34.812176 => 20:52:34.847175
[0m20:52:34.849177 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: ROLLBACK
[0m20:52:34.851177 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m20:52:34.852176 [debug] [Thread-1 (]: On test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m20:52:34.855175 [info ] [Thread-1 (]: 15 of 19 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.06s]
[0m20:52:34.857174 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:52:34.858176 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:52:34.859175 [info ] [Thread-1 (]: 16 of 19 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m20:52:34.862178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m20:52:34.863178 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:52:34.874175 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:52:34.876177 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 20:52:34.864180 => 20:52:34.875176
[0m20:52:34.878177 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:52:34.883176 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:52:34.885176 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:52:34.886176 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: BEGIN
[0m20:52:34.887174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.896175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.897174 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m20:52:34.899177 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from "AIRBNB"."main"."dim_listings_cleansed"
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:52:34.905176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.907175 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 20:52:34.879177 => 20:52:34.907175
[0m20:52:34.909176 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: ROLLBACK
[0m20:52:34.911176 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m20:52:34.912177 [debug] [Thread-1 (]: On test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m20:52:34.916181 [info ] [Thread-1 (]: 16 of 19 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.06s]
[0m20:52:34.918179 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:52:34.920177 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m20:52:34.921176 [info ] [Thread-1 (]: 17 of 19 START sql table model main.mart_fullmoon_reviews ...................... [RUN]
[0m20:52:34.923178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e, now model.learn_duckdb.mart_fullmoon_reviews)
[0m20:52:34.923178 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.mart_fullmoon_reviews
[0m20:52:34.932176 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m20:52:34.935176 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (compile): 20:52:34.924178 => 20:52:34.935176
[0m20:52:34.936176 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.mart_fullmoon_reviews
[0m20:52:34.956173 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.mart_fullmoon_reviews"
[0m20:52:34.959177 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m20:52:34.960176 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: BEGIN
[0m20:52:34.961175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:34.975175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:34.976176 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m20:52:34.977176 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */

  
    
    

    create  table
      "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp"
  
    as (
      

WITH fct_reviews AS (
    SELECT * FROM "AIRBNB"."main"."fct_reviews"
),
full_moon_dates AS (
    SELECT * FROM "AIRBNB"."main"."seed_full_moon_dates"
)

SELECT 
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full_moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (date_trunc('day', r.review_date) = (fm.full_moon_date + 1))
    );
  
  
[0m20:52:35.360176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:35.367175 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m20:52:35.368175 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */
alter table "AIRBNB"."main"."mart_fullmoon_reviews__dbt_tmp" rename to "mart_fullmoon_reviews"
[0m20:52:35.369178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:35.373175 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: COMMIT
[0m20:52:35.374176 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m20:52:35.375175 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: COMMIT
[0m20:52:35.985177 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m20:52:35.989176 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.mart_fullmoon_reviews"
[0m20:52:35.990178 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.mart_fullmoon_reviews"} */
drop table if exists "AIRBNB"."main"."mart_fullmoon_reviews__dbt_backup" cascade
[0m20:52:35.992176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:35.994176 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.mart_fullmoon_reviews (execute): 20:52:34.937175 => 20:52:35.994176
[0m20:52:35.995176 [debug] [Thread-1 (]: On model.learn_duckdb.mart_fullmoon_reviews: Close
[0m20:52:36.041180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2890E9010>]}
[0m20:52:36.042179 [info ] [Thread-1 (]: 17 of 19 OK created sql table model main.mart_fullmoon_reviews ................. [[32mOK[0m in 1.12s]
[0m20:52:36.044176 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m20:52:36.045182 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m20:52:36.047182 [info ] [Thread-1 (]: 18 of 19 START test consistent_created_at ...................................... [RUN]
[0m20:52:36.049179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.mart_fullmoon_reviews, now test.learn_duckdb.consistent_created_at)
[0m20:52:36.050181 [debug] [Thread-1 (]: Began compiling node test.learn_duckdb.consistent_created_at
[0m20:52:36.055179 [debug] [Thread-1 (]: Writing injected SQL for node "test.learn_duckdb.consistent_created_at"
[0m20:52:36.057179 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.consistent_created_at (compile): 20:52:36.051176 => 20:52:36.057179
[0m20:52:36.058179 [debug] [Thread-1 (]: Began executing node test.learn_duckdb.consistent_created_at
[0m20:52:36.063197 [debug] [Thread-1 (]: Writing runtime sql for node "test.learn_duckdb.consistent_created_at"
[0m20:52:36.066179 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.consistent_created_at"
[0m20:52:36.067184 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: BEGIN
[0m20:52:36.068180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:36.083180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:36.084181 [debug] [Thread-1 (]: Using duckdb connection "test.learn_duckdb.consistent_created_at"
[0m20:52:36.086177 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "test.learn_duckdb.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
FROM "AIRBNB"."main"."dim_listings_cleansed" l
INNER JOIN "AIRBNB"."main"."fct_reviews" f
USING (listing_id)
WHERE f.review_date <= l.created_at
LIMIT 10
      
    ) dbt_internal_test
[0m20:52:36.095174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:36.099176 [debug] [Thread-1 (]: Timing info for test.learn_duckdb.consistent_created_at (execute): 20:52:36.059178 => 20:52:36.098176
[0m20:52:36.100179 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: ROLLBACK
[0m20:52:36.101178 [debug] [Thread-1 (]: Failed to rollback 'test.learn_duckdb.consistent_created_at'
[0m20:52:36.102180 [debug] [Thread-1 (]: On test.learn_duckdb.consistent_created_at: Close
[0m20:52:36.106177 [info ] [Thread-1 (]: 18 of 19 PASS consistent_created_at ............................................ [[32mPASS[0m in 0.06s]
[0m20:52:36.107179 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m20:52:36.108180 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m20:52:36.109180 [info ] [Thread-1 (]: 19 of 19 START sql view model main.dim_listings_w_hosts ........................ [RUN]
[0m20:52:36.111181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.learn_duckdb.consistent_created_at, now model.learn_duckdb.dim_listings_w_hosts)
[0m20:52:36.112180 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.dim_listings_w_hosts
[0m20:52:36.121177 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.dim_listings_w_hosts"
[0m20:52:36.124180 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_w_hosts (compile): 20:52:36.113179 => 20:52:36.124180
[0m20:52:36.126177 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.dim_listings_w_hosts
[0m20:52:36.133176 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.dim_listings_w_hosts"
[0m20:52:36.135180 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m20:52:36.136178 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: BEGIN
[0m20:52:36.136178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:36.145175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:36.147182 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m20:52:36.148176 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_w_hosts"} */

  
  create view "AIRBNB"."main"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT 
        * 
    FROM
        "AIRBNB"."main"."dim_listings_cleansed"
),
h AS (
    SELECT
        *
    FROM
        "AIRBNB"."main"."dim_hosts_cleansed"
)

SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );

[0m20:52:36.151180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:36.161180 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m20:52:36.161180 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_w_hosts"} */
alter view "AIRBNB"."main"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m20:52:36.164177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:36.166177 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: COMMIT
[0m20:52:36.167175 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m20:52:36.168176 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: COMMIT
[0m20:52:36.172176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:36.176175 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.dim_listings_w_hosts"
[0m20:52:36.177174 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.dim_listings_w_hosts"} */
drop view if exists "AIRBNB"."main"."dim_listings_w_hosts__dbt_backup" cascade
[0m20:52:36.179176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:36.182180 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.dim_listings_w_hosts (execute): 20:52:36.127175 => 20:52:36.182180
[0m20:52:36.183179 [debug] [Thread-1 (]: On model.learn_duckdb.dim_listings_w_hosts: Close
[0m20:52:36.200176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b294fa70-c840-495e-8997-751b0d43b2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F28BB36550>]}
[0m20:52:36.201175 [info ] [Thread-1 (]: 19 of 19 OK created sql view model main.dim_listings_w_hosts ................... [[32mOK[0m in 0.09s]
[0m20:52:36.202176 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m20:52:36.205178 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:36.206179 [debug] [MainThread]: On master: BEGIN
[0m20:52:36.207175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:36.221175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:52:36.222175 [debug] [MainThread]: On master: COMMIT
[0m20:52:36.223175 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:36.224176 [debug] [MainThread]: On master: COMMIT
[0m20:52:36.225177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:52:36.226177 [debug] [MainThread]: On master: Close
[0m20:52:36.229178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:36.230178 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m20:52:36.231176 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m20:52:36.232175 [debug] [MainThread]: Connection 'model.learn_duckdb.dim_listings_w_hosts' was properly closed.
[0m20:52:36.233177 [info ] [MainThread]: 
[0m20:52:36.235176 [info ] [MainThread]: Finished running 6 view models, 1 seed, 1 snapshot, 1 incremental model, 9 tests, 1 table model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m20:52:36.240180 [debug] [MainThread]: Command end result
[0m20:52:36.258181 [info ] [MainThread]: 
[0m20:52:36.260177 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:36.262175 [info ] [MainThread]: 
[0m20:52:36.263177 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m20:52:36.266176 [debug] [MainThread]: Command `dbt build` succeeded at 20:52:36.266176 after 7.77 seconds
[0m20:52:36.267174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2823A7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F288F1B690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2889EE690>]}
[0m20:52:36.268175 [debug] [MainThread]: Flushing usage events
[0m20:52:44.726986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A6D2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F896FBF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A6D3250>]}


============================== 20:52:44.732986 | 3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab ==============================
[0m20:52:44.732986 [info ] [MainThread]: Running with dbt=1.7.11
[0m20:52:44.733987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:45.073987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A8E5810>]}
[0m20:52:45.176008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A801B90>]}
[0m20:52:45.179007 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m20:52:45.195007 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m20:52:45.431987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:45.432986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:45.446985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A834050>]}
[0m20:52:45.469988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8AA13E10>]}
[0m20:52:45.470988 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m20:52:45.475986 [info ] [MainThread]: 
[0m20:52:45.477988 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:52:45.480988 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m20:52:45.496987 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m20:52:45.497987 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m20:52:45.497987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:45.511988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.514987 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:52:45.522988 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m20:52:45.523988 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m20:52:45.524988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:45.535987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.537985 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:52:45.543988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m20:52:45.544985 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m20:52:45.554988 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:52:45.555988 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m20:52:45.556993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:45.566987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.569984 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:52:45.570985 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m20:52:45.572988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.572988 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:52:45.573990 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m20:52:45.575986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.576988 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m20:52:45.577989 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:52:45.578988 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m20:52:45.579987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.580986 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m20:52:45.584987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m20:52:45.586989 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m20:52:45.591987 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:52:45.592985 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m20:52:45.593989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:45.603987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.605986 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:52:45.605986 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m20:52:45.606987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.607988 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:52:45.608987 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m20:52:45.609987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.610987 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m20:52:45.611987 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:52:45.612987 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m20:52:45.612987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.613987 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m20:52:45.619987 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m20:52:45.626985 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m20:52:45.627986 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m20:52:45.627986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:45.637988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.638987 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m20:52:45.639988 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m20:52:45.677987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.679986 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m20:52:45.680987 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m20:52:45.681987 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m20:52:45.686986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m20:52:45.689987 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m20:52:45.690988 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m20:52:45.691989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:45.700987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.701986 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m20:52:45.702987 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m20:52:45.740008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:52:45.742007 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m20:52:45.743988 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m20:52:45.743988 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m20:52:45.749007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A9119D0>]}
[0m20:52:45.750007 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:45.750007 [debug] [MainThread]: On master: BEGIN
[0m20:52:45.750987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:45.759986 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:52:45.760987 [debug] [MainThread]: On master: COMMIT
[0m20:52:45.761987 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:45.762989 [debug] [MainThread]: On master: COMMIT
[0m20:52:45.763991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:52:45.764991 [debug] [MainThread]: On master: Close
[0m20:52:45.767987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:45.768991 [info ] [MainThread]: 
[0m20:52:45.773986 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m20:52:45.775008 [info ] [Thread-1 (]: 1 of 19 START sql view model main.src_hosts .................................... [RUN]
[0m20:52:45.776989 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m20:52:45.777992 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m20:52:45.787002 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m20:52:45.789989 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 20:52:45.778991 => 20:52:45.788985
[0m20:52:45.790989 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_hosts
[0m20:52:45.837987 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_hosts"
[0m20:52:45.839987 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:52:45.840988 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: BEGIN
[0m20:52:45.842987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:52:45.854987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:45.856988 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:52:45.857987 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */

  
  create view "AIRBNB"."main"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );

[0m20:52:45.858987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:45.866987 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:52:45.867986 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */
alter view "AIRBNB"."main"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m20:52:45.870988 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (execute): 20:52:45.791988 => 20:52:45.869988
[0m20:52:45.871989 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: ROLLBACK
[0m20:52:45.886985 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_hosts'
[0m20:52:45.887985 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: Close
[0m20:52:45.898987 [debug] [Thread-1 (]: Runtime Error in model src_hosts (models\src\src_hosts.sql)
  Catalog Error: Could not rename "src_hosts__dbt_tmp" to "src_hosts": another entry with this name already exists!
[0m20:52:45.899986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8AA63910>]}
[0m20:52:45.901987 [error] [Thread-1 (]: 1 of 19 ERROR creating sql view model main.src_hosts ........................... [[31mERROR[0m in 0.12s]
[0m20:52:45.903986 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m20:52:45.904987 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m20:52:45.905988 [info ] [Thread-1 (]: 2 of 19 START sql view model main.src_listings ................................. [RUN]
[0m20:52:45.907992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m20:52:45.909987 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m20:52:45.917988 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m20:52:45.920987 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 20:52:45.910990 => 20:52:45.919988
[0m20:52:45.921988 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_listings
[0m20:52:45.934988 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_listings"
[0m20:52:45.937987 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:52:45.938987 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: BEGIN
[0m20:52:45.939987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:45.950986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:45.951987 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:52:45.952986 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */

  
  create view "AIRBNB"."main"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );

[0m20:52:45.954987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:45.963987 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:52:45.965988 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */
alter view "AIRBNB"."main"."src_listings__dbt_tmp" rename to "src_listings"
[0m20:52:45.968988 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (execute): 20:52:45.922987 => 20:52:45.967987
[0m20:52:45.969988 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: ROLLBACK
[0m20:52:45.979989 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_listings'
[0m20:52:45.980989 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: Close
[0m20:52:45.992987 [debug] [Thread-1 (]: Runtime Error in model src_listings (models\src\src_listings.sql)
  Catalog Error: Could not rename "src_listings__dbt_tmp" to "src_listings": another entry with this name already exists!
[0m20:52:45.993987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8BDB9710>]}
[0m20:52:45.995987 [error] [Thread-1 (]: 2 of 19 ERROR creating sql view model main.src_listings ........................ [[31mERROR[0m in 0.09s]
[0m20:52:45.997987 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m20:52:45.999987 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m20:52:46.001987 [info ] [Thread-1 (]: 3 of 19 START sql view model main.src_reviews .................................. [RUN]
[0m20:52:46.003988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m20:52:46.004987 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m20:52:46.014987 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m20:52:46.017988 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 20:52:46.006988 => 20:52:46.016988
[0m20:52:46.018989 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_reviews
[0m20:52:46.027988 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_reviews"
[0m20:52:46.030988 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:52:46.031987 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: BEGIN
[0m20:52:46.032988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:46.043986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:46.044986 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:52:46.045987 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */

  
  create view "AIRBNB"."main"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
  );

[0m20:52:46.047986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:46.052986 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:52:46.054988 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */
alter view "AIRBNB"."main"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m20:52:46.055988 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (execute): 20:52:46.019988 => 20:52:46.055988
[0m20:52:46.057989 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: ROLLBACK
[0m20:52:46.063986 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_reviews'
[0m20:52:46.064986 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: Close
[0m20:52:46.072986 [debug] [Thread-1 (]: Runtime Error in model src_reviews (models\src\src_reviews.sql)
  Catalog Error: Could not rename "src_reviews__dbt_tmp" to "src_reviews": another entry with this name already exists!
[0m20:52:46.073988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A9F6110>]}
[0m20:52:46.074986 [error] [Thread-1 (]: 3 of 19 ERROR creating sql view model main.src_reviews ......................... [[31mERROR[0m in 0.07s]
[0m20:52:46.076987 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m20:52:46.077986 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m20:52:46.078986 [info ] [Thread-1 (]: 4 of 19 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m20:52:46.079987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m20:52:46.080986 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m20:52:46.081986 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 20:52:46.081986 => 20:52:46.081986
[0m20:52:46.082987 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m20:52:46.126988 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m20:52:46.127988 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m20:52:46.128987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:46.142987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:46.144988 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m20:52:46.145987 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m20:52:46.148988 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 20:52:46.082987 => 20:52:46.148988
[0m20:52:46.150989 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: ROLLBACK
[0m20:52:46.158988 [debug] [Thread-1 (]: Failed to rollback 'seed.learn_duckdb.seed_full_moon_dates'
[0m20:52:46.158988 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m20:52:46.168988 [debug] [Thread-1 (]: Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m20:52:46.169988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A930590>]}
[0m20:52:46.171987 [error] [Thread-1 (]: 4 of 19 ERROR loading seed file main.seed_full_moon_dates ...................... [[31mERROR[0m in 0.09s]
[0m20:52:46.173987 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m20:52:46.175987 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m20:52:46.176988 [info ] [Thread-1 (]: 5 of 19 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m20:52:46.178988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m20:52:46.180990 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m20:52:46.188987 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 20:52:46.181987 => 20:52:46.187987
[0m20:52:46.189986 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m20:52:46.265985 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m20:52:46.267987 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m20:52:46.268990 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m20:52:46.269990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:46.281988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:52:46.282988 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m20:52:46.283987 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m20:52:46.289986 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 20:52:46.190988 => 20:52:46.289986
[0m20:52:46.290986 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: ROLLBACK
[0m20:52:46.294987 [debug] [Thread-1 (]: Failed to rollback 'snapshot.learn_duckdb.scd_raw_listings'
[0m20:52:46.295985 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m20:52:46.301985 [debug] [Thread-1 (]: Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m20:52:46.302984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4315b2-79d6-4bd0-9e6f-33af3c0cc7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8AACD290>]}
[0m20:52:46.303986 [error] [Thread-1 (]: 5 of 19 ERROR snapshotting dev.scd_raw_listings ................................ [[31mERROR[0m in 0.12s]
[0m20:52:46.305989 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m20:52:46.306987 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m20:52:46.307987 [info ] [Thread-1 (]: 6 of 19 SKIP relation main.dim_hosts_cleansed .................................. [[33mSKIP[0m]
[0m20:52:46.309987 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m20:52:46.311987 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m20:52:46.312987 [info ] [Thread-1 (]: 7 of 19 SKIP relation main.dim_listings_cleansed ............................... [[33mSKIP[0m]
[0m20:52:46.313988 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m20:52:46.314991 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m20:52:46.315987 [info ] [Thread-1 (]: 8 of 19 SKIP relation main.fct_reviews ......................................... [[33mSKIP[0m]
[0m20:52:46.317987 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m20:52:46.317987 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:52:46.319989 [info ] [Thread-1 (]: 9 of 19 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m20:52:46.321990 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:52:46.323989 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m20:52:46.325988 [info ] [Thread-1 (]: 10 of 19 SKIP test dim_listings_minimum_nights ................................. [[33mSKIP[0m]
[0m20:52:46.329989 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m20:52:46.331988 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m20:52:46.358989 [info ] [Thread-1 (]: 11 of 19 SKIP test no_nulls_in_dim_listings .................................... [[33mSKIP[0m]
[0m20:52:46.361988 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m20:52:46.362988 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:52:46.364988 [info ] [Thread-1 (]: 12 of 19 SKIP test not_null_dim_listings_cleansed_host_id ...................... [[33mSKIP[0m]
[0m20:52:46.367990 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:52:46.369989 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:52:46.373989 [info ] [Thread-1 (]: 13 of 19 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m20:52:46.376988 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:52:46.378987 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:52:46.382988 [info ] [Thread-1 (]: 14 of 19 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m20:52:46.388988 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:52:46.389988 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:52:46.391987 [info ] [Thread-1 (]: 15 of 19 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m20:52:46.392987 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:52:46.394988 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:52:46.396988 [info ] [Thread-1 (]: 16 of 19 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m20:52:46.397988 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:52:46.402988 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m20:52:46.405989 [info ] [Thread-1 (]: 17 of 19 SKIP relation main.mart_fullmoon_reviews .............................. [[33mSKIP[0m]
[0m20:52:46.409989 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m20:52:46.412989 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m20:52:46.414988 [info ] [Thread-1 (]: 18 of 19 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m20:52:46.417987 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m20:52:46.419989 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m20:52:46.421989 [info ] [Thread-1 (]: 19 of 19 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m20:52:46.423988 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m20:52:46.426987 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:46.427989 [debug] [MainThread]: On master: BEGIN
[0m20:52:46.428989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:46.437987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:52:46.438988 [debug] [MainThread]: On master: COMMIT
[0m20:52:46.440988 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:46.441988 [debug] [MainThread]: On master: COMMIT
[0m20:52:46.442988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:52:46.443987 [debug] [MainThread]: On master: Close
[0m20:52:46.447989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:46.447989 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m20:52:46.448987 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m20:52:46.449988 [debug] [MainThread]: Connection 'snapshot.learn_duckdb.scd_raw_listings' was properly closed.
[0m20:52:46.450986 [info ] [MainThread]: 
[0m20:52:46.451989 [info ] [MainThread]: Finished running 6 view models, 1 seed, 1 snapshot, 1 incremental model, 9 tests, 1 table model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m20:52:46.454987 [debug] [MainThread]: Command end result
[0m20:52:46.482988 [info ] [MainThread]: 
[0m20:52:46.484988 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:52:46.485989 [info ] [MainThread]: 
[0m20:52:46.486988 [error] [MainThread]:   Runtime Error in model src_hosts (models\src\src_hosts.sql)
  Catalog Error: Could not rename "src_hosts__dbt_tmp" to "src_hosts": another entry with this name already exists!
[0m20:52:46.487987 [info ] [MainThread]: 
[0m20:52:46.488990 [error] [MainThread]:   Runtime Error in model src_listings (models\src\src_listings.sql)
  Catalog Error: Could not rename "src_listings__dbt_tmp" to "src_listings": another entry with this name already exists!
[0m20:52:46.491989 [info ] [MainThread]: 
[0m20:52:46.493989 [error] [MainThread]:   Runtime Error in model src_reviews (models\src\src_reviews.sql)
  Catalog Error: Could not rename "src_reviews__dbt_tmp" to "src_reviews": another entry with this name already exists!
[0m20:52:46.495991 [info ] [MainThread]: 
[0m20:52:46.498988 [error] [MainThread]:   Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m20:52:46.500988 [info ] [MainThread]: 
[0m20:52:46.501988 [error] [MainThread]:   Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m20:52:46.503989 [info ] [MainThread]: 
[0m20:52:46.504989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=14 TOTAL=19
[0m20:52:46.510995 [debug] [MainThread]: Command `dbt build` failed at 20:52:46.509989 after 1.86 seconds
[0m20:52:46.512989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F83C07ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8A31AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F83E55C50>]}
[0m20:52:46.513989 [debug] [MainThread]: Flushing usage events
[0m20:52:59.524732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0AD2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0AB57D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0AB5610>]}


============================== 20:52:59.529732 | ed79466c-4d0f-4789-8b86-baaaef1d9d13 ==============================
[0m20:52:59.529732 [info ] [MainThread]: Running with dbt=1.7.11
[0m20:52:59.531716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Use\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Use\\OneDrive\\Development\\dbt-course\\learn_duckdb\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:52:59.855721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0AF0E50>]}
[0m20:52:59.957722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0BA0E10>]}
[0m20:52:59.959721 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m20:52:59.985722 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m20:53:00.224718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:53:00.225716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:53:00.235732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0C53A10>]}
[0m20:53:00.258723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0DAFD90>]}
[0m20:53:00.259733 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 507 macros, 0 groups, 0 semantic models
[0m20:53:00.263721 [info ] [MainThread]: 
[0m20:53:00.265732 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:53:00.267722 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB'
[0m20:53:00.284737 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m20:53:00.286737 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m20:53:00.287718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:00.301721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.303721 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:53:00.313737 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB"
[0m20:53:00.313737 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"AIRBNB"'
    
  
  
[0m20:53:00.314737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:00.327717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.330732 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:53:00.335716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_dev)
[0m20:53:00.337719 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "dev"
"
[0m20:53:00.347718 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:53:00.348718 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m20:53:00.349719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:00.359718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.362719 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:53:00.363717 [debug] [ThreadPool]: On create_AIRBNB_dev: BEGIN
[0m20:53:00.364717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.365721 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:53:00.366717 [debug] [ThreadPool]: On create_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_dev"} */

    
    
        create schema if not exists "AIRBNB"."dev"
    
[0m20:53:00.367721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.369716 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m20:53:00.370717 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_dev"
[0m20:53:00.371718 [debug] [ThreadPool]: On create_AIRBNB_dev: COMMIT
[0m20:53:00.372721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.373721 [debug] [ThreadPool]: On create_AIRBNB_dev: Close
[0m20:53:00.379737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_dev, now create_AIRBNB_main)
[0m20:53:00.380738 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "main"
"
[0m20:53:00.386721 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:53:00.387719 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
        select type from duckdb_databases()
        where database_name='AIRBNB'
        and type='sqlite'
    
  
[0m20:53:00.388721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:00.398722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.400716 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:53:00.401716 [debug] [ThreadPool]: On create_AIRBNB_main: BEGIN
[0m20:53:00.403716 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.403716 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:53:00.404716 [debug] [ThreadPool]: On create_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "create_AIRBNB_main"} */

    
    
        create schema if not exists "AIRBNB"."main"
    
[0m20:53:00.405716 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.406716 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m20:53:00.407715 [debug] [ThreadPool]: Using duckdb connection "create_AIRBNB_main"
[0m20:53:00.408721 [debug] [ThreadPool]: On create_AIRBNB_main: COMMIT
[0m20:53:00.409719 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.410720 [debug] [ThreadPool]: On create_AIRBNB_main: Close
[0m20:53:00.416718 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_AIRBNB_dev'
[0m20:53:00.423718 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m20:53:00.424718 [debug] [ThreadPool]: On list_AIRBNB_dev: BEGIN
[0m20:53:00.425718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:00.434718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.435718 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_dev"
[0m20:53:00.436718 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev'
    and table_catalog = 'AIRBNB'
  
[0m20:53:00.474718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.476717 [debug] [ThreadPool]: On list_AIRBNB_dev: ROLLBACK
[0m20:53:00.478719 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_dev'
[0m20:53:00.478719 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m20:53:00.483721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_main)
[0m20:53:00.486722 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m20:53:00.487721 [debug] [ThreadPool]: On list_AIRBNB_main: BEGIN
[0m20:53:00.488717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:00.497717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.498717 [debug] [ThreadPool]: Using duckdb connection "list_AIRBNB_main"
[0m20:53:00.499718 [debug] [ThreadPool]: On list_AIRBNB_main: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "connection_name": "list_AIRBNB_main"} */
select
      'AIRBNB' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'AIRBNB'
  
[0m20:53:00.536720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:53:00.538717 [debug] [ThreadPool]: On list_AIRBNB_main: ROLLBACK
[0m20:53:00.540718 [debug] [ThreadPool]: Failed to rollback 'list_AIRBNB_main'
[0m20:53:00.540718 [debug] [ThreadPool]: On list_AIRBNB_main: Close
[0m20:53:00.545732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D00284D0>]}
[0m20:53:00.546732 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:00.546732 [debug] [MainThread]: On master: BEGIN
[0m20:53:00.547719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:00.557726 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:53:00.558733 [debug] [MainThread]: On master: COMMIT
[0m20:53:00.559727 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:00.560719 [debug] [MainThread]: On master: COMMIT
[0m20:53:00.562717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:53:00.563717 [debug] [MainThread]: On master: Close
[0m20:53:00.566732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:00.567721 [info ] [MainThread]: 
[0m20:53:00.572747 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_hosts
[0m20:53:00.573732 [info ] [Thread-1 (]: 1 of 19 START sql view model main.src_hosts .................................... [RUN]
[0m20:53:00.575732 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.learn_duckdb.src_hosts'
[0m20:53:00.576732 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_hosts
[0m20:53:00.588718 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_hosts"
[0m20:53:00.591718 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (compile): 20:53:00.577732 => 20:53:00.590717
[0m20:53:00.593720 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_hosts
[0m20:53:00.633718 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_hosts"
[0m20:53:00.635718 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:53:00.636718 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: BEGIN
[0m20:53:00.637718 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:53:00.649716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:53:00.650716 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:53:00.651716 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */

  
  create view "AIRBNB"."main"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT * FROM "AIRBNB"."raw"."raw_hosts"
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );

[0m20:53:00.652717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:53:00.661717 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_hosts"
[0m20:53:00.662716 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_hosts"} */
alter view "AIRBNB"."main"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m20:53:00.664716 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_hosts (execute): 20:53:00.594719 => 20:53:00.664716
[0m20:53:00.665716 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: ROLLBACK
[0m20:53:00.676716 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_hosts'
[0m20:53:00.677718 [debug] [Thread-1 (]: On model.learn_duckdb.src_hosts: Close
[0m20:53:00.685717 [debug] [Thread-1 (]: Runtime Error in model src_hosts (models\src\src_hosts.sql)
  Catalog Error: Could not rename "src_hosts__dbt_tmp" to "src_hosts": another entry with this name already exists!
[0m20:53:00.686717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0B03150>]}
[0m20:53:00.687720 [error] [Thread-1 (]: 1 of 19 ERROR creating sql view model main.src_hosts ........................... [[31mERROR[0m in 0.11s]
[0m20:53:00.689721 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_hosts
[0m20:53:00.690729 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_listings
[0m20:53:00.691717 [info ] [Thread-1 (]: 2 of 19 START sql view model main.src_listings ................................. [RUN]
[0m20:53:00.693721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_hosts, now model.learn_duckdb.src_listings)
[0m20:53:00.695719 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_listings
[0m20:53:00.700721 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_listings"
[0m20:53:00.703721 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (compile): 20:53:00.696721 => 20:53:00.702722
[0m20:53:00.704721 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_listings
[0m20:53:00.714732 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_listings"
[0m20:53:00.716720 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:53:00.717721 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: BEGIN
[0m20:53:00.718737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:00.727718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:53:00.728732 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:53:00.729732 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */

  
  create view "AIRBNB"."main"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT * FROM "AIRBNB"."raw"."raw_listings"
)

SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );

[0m20:53:00.731721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:53:00.735732 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_listings"
[0m20:53:00.736732 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_listings"} */
alter view "AIRBNB"."main"."src_listings__dbt_tmp" rename to "src_listings"
[0m20:53:00.738719 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_listings (execute): 20:53:00.705738 => 20:53:00.738719
[0m20:53:00.739726 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: ROLLBACK
[0m20:53:00.747720 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_listings'
[0m20:53:00.748721 [debug] [Thread-1 (]: On model.learn_duckdb.src_listings: Close
[0m20:53:00.757717 [debug] [Thread-1 (]: Runtime Error in model src_listings (models\src\src_listings.sql)
  Catalog Error: Could not rename "src_listings__dbt_tmp" to "src_listings": another entry with this name already exists!
[0m20:53:00.760718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D115AA50>]}
[0m20:53:00.762730 [error] [Thread-1 (]: 2 of 19 ERROR creating sql view model main.src_listings ........................ [[31mERROR[0m in 0.07s]
[0m20:53:00.764720 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_listings
[0m20:53:00.765719 [debug] [Thread-1 (]: Began running node model.learn_duckdb.src_reviews
[0m20:53:00.767719 [info ] [Thread-1 (]: 3 of 19 START sql view model main.src_reviews .................................. [RUN]
[0m20:53:00.769718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_listings, now model.learn_duckdb.src_reviews)
[0m20:53:00.771727 [debug] [Thread-1 (]: Began compiling node model.learn_duckdb.src_reviews
[0m20:53:00.778721 [debug] [Thread-1 (]: Writing injected SQL for node "model.learn_duckdb.src_reviews"
[0m20:53:00.780718 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (compile): 20:53:00.772719 => 20:53:00.779721
[0m20:53:00.781720 [debug] [Thread-1 (]: Began executing node model.learn_duckdb.src_reviews
[0m20:53:00.790717 [debug] [Thread-1 (]: Writing runtime sql for node "model.learn_duckdb.src_reviews"
[0m20:53:00.792717 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:53:00.794719 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: BEGIN
[0m20:53:00.795717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:00.809717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:53:00.810717 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:53:00.812718 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */

  
  create view "AIRBNB"."main"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT * FROM "AIRBNB"."raw"."raw_reviews"
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS reviewer_sentiment
FROM
    raw_reviews
  );

[0m20:53:00.813718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:53:00.820717 [debug] [Thread-1 (]: Using duckdb connection "model.learn_duckdb.src_reviews"
[0m20:53:00.822719 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "model.learn_duckdb.src_reviews"} */
alter view "AIRBNB"."main"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m20:53:00.826718 [debug] [Thread-1 (]: Timing info for model.learn_duckdb.src_reviews (execute): 20:53:00.782718 => 20:53:00.825718
[0m20:53:00.827718 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: ROLLBACK
[0m20:53:00.837719 [debug] [Thread-1 (]: Failed to rollback 'model.learn_duckdb.src_reviews'
[0m20:53:00.839718 [debug] [Thread-1 (]: On model.learn_duckdb.src_reviews: Close
[0m20:53:00.853718 [debug] [Thread-1 (]: Runtime Error in model src_reviews (models\src\src_reviews.sql)
  Catalog Error: Could not rename "src_reviews__dbt_tmp" to "src_reviews": another entry with this name already exists!
[0m20:53:00.855721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0CEA490>]}
[0m20:53:00.857719 [error] [Thread-1 (]: 3 of 19 ERROR creating sql view model main.src_reviews ......................... [[31mERROR[0m in 0.09s]
[0m20:53:00.860719 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.src_reviews
[0m20:53:00.861717 [debug] [Thread-1 (]: Began running node seed.learn_duckdb.seed_full_moon_dates
[0m20:53:00.862718 [info ] [Thread-1 (]: 4 of 19 START seed file main.seed_full_moon_dates .............................. [RUN]
[0m20:53:00.865719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.learn_duckdb.src_reviews, now seed.learn_duckdb.seed_full_moon_dates)
[0m20:53:00.867717 [debug] [Thread-1 (]: Began compiling node seed.learn_duckdb.seed_full_moon_dates
[0m20:53:00.868717 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (compile): 20:53:00.868717 => 20:53:00.868717
[0m20:53:00.869717 [debug] [Thread-1 (]: Began executing node seed.learn_duckdb.seed_full_moon_dates
[0m20:53:00.919716 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m20:53:00.920716 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: BEGIN
[0m20:53:00.921718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:00.932718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:53:00.934717 [debug] [Thread-1 (]: Using duckdb connection "seed.learn_duckdb.seed_full_moon_dates"
[0m20:53:00.935718 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "seed.learn_duckdb.seed_full_moon_dates"} */

    create table "AIRBNB"."main"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m20:53:00.937718 [debug] [Thread-1 (]: Timing info for seed.learn_duckdb.seed_full_moon_dates (execute): 20:53:00.870717 => 20:53:00.937718
[0m20:53:00.938718 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: ROLLBACK
[0m20:53:00.946717 [debug] [Thread-1 (]: Failed to rollback 'seed.learn_duckdb.seed_full_moon_dates'
[0m20:53:00.947717 [debug] [Thread-1 (]: On seed.learn_duckdb.seed_full_moon_dates: Close
[0m20:53:00.954717 [debug] [Thread-1 (]: Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m20:53:00.955716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0AF2BD0>]}
[0m20:53:00.956715 [error] [Thread-1 (]: 4 of 19 ERROR loading seed file main.seed_full_moon_dates ...................... [[31mERROR[0m in 0.09s]
[0m20:53:00.959718 [debug] [Thread-1 (]: Finished running node seed.learn_duckdb.seed_full_moon_dates
[0m20:53:00.960718 [debug] [Thread-1 (]: Began running node snapshot.learn_duckdb.scd_raw_listings
[0m20:53:00.961717 [info ] [Thread-1 (]: 5 of 19 START snapshot dev.scd_raw_listings .................................... [RUN]
[0m20:53:00.963718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.learn_duckdb.seed_full_moon_dates, now snapshot.learn_duckdb.scd_raw_listings)
[0m20:53:00.964720 [debug] [Thread-1 (]: Began compiling node snapshot.learn_duckdb.scd_raw_listings
[0m20:53:00.973716 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (compile): 20:53:00.964720 => 20:53:00.972721
[0m20:53:00.975720 [debug] [Thread-1 (]: Began executing node snapshot.learn_duckdb.scd_raw_listings
[0m20:53:01.043719 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.learn_duckdb.scd_raw_listings"
[0m20:53:01.045718 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m20:53:01.046718 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: BEGIN
[0m20:53:01.047717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:01.058716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:53:01.059716 [debug] [Thread-1 (]: Using duckdb connection "snapshot.learn_duckdb.scd_raw_listings"
[0m20:53:01.060717 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "learn_duckdb", "target_name": "dev", "node_id": "snapshot.learn_duckdb.scd_raw_listings"} */

      
  
    
    

    create  table
      "AIRBNB"."dev"."scd_raw_listings"
  
    as (
      

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM "AIRBNB"."raw"."raw_listings"

    ) sbq



    );
  
  
  
[0m20:53:01.065715 [debug] [Thread-1 (]: Timing info for snapshot.learn_duckdb.scd_raw_listings (execute): 20:53:00.976718 => 20:53:01.064716
[0m20:53:01.066715 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: ROLLBACK
[0m20:53:01.071718 [debug] [Thread-1 (]: Failed to rollback 'snapshot.learn_duckdb.scd_raw_listings'
[0m20:53:01.071718 [debug] [Thread-1 (]: On snapshot.learn_duckdb.scd_raw_listings: Close
[0m20:53:01.078718 [debug] [Thread-1 (]: Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m20:53:01.080719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed79466c-4d0f-4789-8b86-baaaef1d9d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0DFA550>]}
[0m20:53:01.081720 [error] [Thread-1 (]: 5 of 19 ERROR snapshotting dev.scd_raw_listings ................................ [[31mERROR[0m in 0.12s]
[0m20:53:01.083718 [debug] [Thread-1 (]: Finished running node snapshot.learn_duckdb.scd_raw_listings
[0m20:53:01.084724 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_hosts_cleansed
[0m20:53:01.086718 [info ] [Thread-1 (]: 6 of 19 SKIP relation main.dim_hosts_cleansed .................................. [[33mSKIP[0m]
[0m20:53:01.087717 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_hosts_cleansed
[0m20:53:01.088717 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_cleansed
[0m20:53:01.089717 [info ] [Thread-1 (]: 7 of 19 SKIP relation main.dim_listings_cleansed ............................... [[33mSKIP[0m]
[0m20:53:01.090719 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_cleansed
[0m20:53:01.091716 [debug] [Thread-1 (]: Began running node model.learn_duckdb.fct_reviews
[0m20:53:01.092718 [info ] [Thread-1 (]: 8 of 19 SKIP relation main.fct_reviews ......................................... [[33mSKIP[0m]
[0m20:53:01.094721 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.fct_reviews
[0m20:53:01.096717 [debug] [Thread-1 (]: Began running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:53:01.097717 [info ] [Thread-1 (]: 9 of 19 SKIP test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[33mSKIP[0m]
[0m20:53:01.098718 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m20:53:01.100720 [debug] [Thread-1 (]: Began running node test.learn_duckdb.dim_listings_minimum_nights
[0m20:53:01.102718 [info ] [Thread-1 (]: 10 of 19 SKIP test dim_listings_minimum_nights ................................. [[33mSKIP[0m]
[0m20:53:01.104720 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.dim_listings_minimum_nights
[0m20:53:01.105722 [debug] [Thread-1 (]: Began running node test.learn_duckdb.no_nulls_in_dim_listings
[0m20:53:01.106719 [info ] [Thread-1 (]: 11 of 19 SKIP test no_nulls_in_dim_listings .................................... [[33mSKIP[0m]
[0m20:53:01.108718 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.no_nulls_in_dim_listings
[0m20:53:01.110718 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:53:01.112738 [info ] [Thread-1 (]: 12 of 19 SKIP test not_null_dim_listings_cleansed_host_id ...................... [[33mSKIP[0m]
[0m20:53:01.114724 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_host_id.084e4105be
[0m20:53:01.115721 [debug] [Thread-1 (]: Began running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:53:01.116718 [info ] [Thread-1 (]: 13 of 19 SKIP test not_null_dim_listings_cleansed_listing_id ................... [[33mSKIP[0m]
[0m20:53:01.118717 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m20:53:01.119717 [debug] [Thread-1 (]: Began running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:53:01.120717 [info ] [Thread-1 (]: 14 of 19 SKIP test positive_value_dim_listings_cleansed_minimum_nights ......... [[33mSKIP[0m]
[0m20:53:01.122718 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m20:53:01.123717 [debug] [Thread-1 (]: Began running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:53:01.125738 [info ] [Thread-1 (]: 15 of 19 SKIP test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[33mSKIP[0m]
[0m20:53:01.127722 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m20:53:01.129718 [debug] [Thread-1 (]: Began running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:53:01.131722 [info ] [Thread-1 (]: 16 of 19 SKIP test unique_dim_listings_cleansed_listing_id ..................... [[33mSKIP[0m]
[0m20:53:01.133717 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m20:53:01.134720 [debug] [Thread-1 (]: Began running node model.learn_duckdb.mart_fullmoon_reviews
[0m20:53:01.135738 [info ] [Thread-1 (]: 17 of 19 SKIP relation main.mart_fullmoon_reviews .............................. [[33mSKIP[0m]
[0m20:53:01.137729 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.mart_fullmoon_reviews
[0m20:53:01.138738 [debug] [Thread-1 (]: Began running node test.learn_duckdb.consistent_created_at
[0m20:53:01.140722 [info ] [Thread-1 (]: 18 of 19 SKIP test consistent_created_at ....................................... [[33mSKIP[0m]
[0m20:53:01.142718 [debug] [Thread-1 (]: Finished running node test.learn_duckdb.consistent_created_at
[0m20:53:01.144718 [debug] [Thread-1 (]: Began running node model.learn_duckdb.dim_listings_w_hosts
[0m20:53:01.145718 [info ] [Thread-1 (]: 19 of 19 SKIP relation main.dim_listings_w_hosts ............................... [[33mSKIP[0m]
[0m20:53:01.148718 [debug] [Thread-1 (]: Finished running node model.learn_duckdb.dim_listings_w_hosts
[0m20:53:01.151719 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:01.151719 [debug] [MainThread]: On master: BEGIN
[0m20:53:01.152718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:01.165734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:53:01.166733 [debug] [MainThread]: On master: COMMIT
[0m20:53:01.167721 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:01.167721 [debug] [MainThread]: On master: COMMIT
[0m20:53:01.168721 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:53:01.169739 [debug] [MainThread]: On master: Close
[0m20:53:01.172716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:01.173718 [debug] [MainThread]: Connection 'create_AIRBNB_main' was properly closed.
[0m20:53:01.174718 [debug] [MainThread]: Connection 'list_AIRBNB_main' was properly closed.
[0m20:53:01.175717 [debug] [MainThread]: Connection 'snapshot.learn_duckdb.scd_raw_listings' was properly closed.
[0m20:53:01.176721 [info ] [MainThread]: 
[0m20:53:01.177718 [info ] [MainThread]: Finished running 6 view models, 1 seed, 1 snapshot, 1 incremental model, 9 tests, 1 table model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m20:53:01.180721 [debug] [MainThread]: Command end result
[0m20:53:01.202717 [info ] [MainThread]: 
[0m20:53:01.205720 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:53:01.207719 [info ] [MainThread]: 
[0m20:53:01.209719 [error] [MainThread]:   Runtime Error in model src_hosts (models\src\src_hosts.sql)
  Catalog Error: Could not rename "src_hosts__dbt_tmp" to "src_hosts": another entry with this name already exists!
[0m20:53:01.211718 [info ] [MainThread]: 
[0m20:53:01.213719 [error] [MainThread]:   Runtime Error in model src_listings (models\src\src_listings.sql)
  Catalog Error: Could not rename "src_listings__dbt_tmp" to "src_listings": another entry with this name already exists!
[0m20:53:01.216719 [info ] [MainThread]: 
[0m20:53:01.217718 [error] [MainThread]:   Runtime Error in model src_reviews (models\src\src_reviews.sql)
  Catalog Error: Could not rename "src_reviews__dbt_tmp" to "src_reviews": another entry with this name already exists!
[0m20:53:01.219738 [info ] [MainThread]: 
[0m20:53:01.220717 [error] [MainThread]:   Runtime Error in seed seed_full_moon_dates (seeds\seed_full_moon_dates.csv)
  Catalog Error: Table with name "seed_full_moon_dates" already exists!
[0m20:53:01.223718 [info ] [MainThread]: 
[0m20:53:01.224718 [error] [MainThread]:   Runtime Error in snapshot scd_raw_listings (snapshots\scd_raw_listings.sql)
  Catalog Error: Table with name "scd_raw_listings" already exists!
[0m20:53:01.227718 [info ] [MainThread]: 
[0m20:53:01.228718 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=14 TOTAL=19
[0m20:53:01.233738 [debug] [MainThread]: Command `dbt build` failed at 20:53:01.232739 after 1.78 seconds
[0m20:53:01.233738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C9FA7E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D04FAB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6CA1F4F10>]}
[0m20:53:01.235718 [debug] [MainThread]: Flushing usage events
